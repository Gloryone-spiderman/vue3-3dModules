{"remainingRequest":"D:\\zhou\\Documents\\github\\threeMachineRoom\\node_modules\\babel-loader\\lib\\index.js!D:\\zhou\\Documents\\github\\threeMachineRoom\\src\\views\\ThreeMap.js","dependencies":[{"path":"D:\\zhou\\Documents\\github\\threeMachineRoom\\src\\views\\ThreeMap.js","mtime":1676877535137},{"path":"D:\\zhou\\Documents\\github\\threeMachineRoom\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1625723463414},{"path":"D:\\zhou\\Documents\\github\\threeMachineRoom\\node_modules\\babel-loader\\lib\\index.js","mtime":1619073890059}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.fontsize\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.string.repeat\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _classCallCheck from \"D:/zhou/Documents/github/threeMachineRoom/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:/zhou/Documents/github/threeMachineRoom/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"D:/zhou/Documents/github/threeMachineRoom/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\n/*\r\n作者:Mr.Xie\r\n创建时间:2020年05月29日\r\n功能描述:3D机房封装\r\n\r\n使用方式\r\nlet props={domID:\"three-dom\"}\r\nthis.map = new ThreeMap(props[,dataJson]);\r\nthis.map.init();\r\n*/\nimport * as THREE from 'three';\nimport 'imports-loader?THREE=three!threebsp';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { GLTFExporter } from 'three/examples/jsm/exporters/GLTFExporter';\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader';\nimport { OBJLoader2 } from 'three/examples/jsm/loaders/OBJLoader2';\nimport { OBJExporter } from 'three/examples/jsm/exporters/OBJExporter';\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader';\nimport TWEEN from '@tweenjs/tween.js';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js'; //r100及以上\n// var OrbitControls = require('three-orbit-controls')(THREE)  //r100 以下\n\nvar ThreeMap = /*#__PURE__*/function () {\n  function ThreeMap(props, dataJson) {\n    _classCallCheck(this, ThreeMap);\n\n    _defineProperty(this, \"onProgress\", function (xhr) {\n      if (xhr.lengthComputable) {\n        var percentComplete = xhr.loaded / xhr.total * 100; // console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\n      }\n    });\n\n    _defineProperty(this, \"onError\", function (xhr) {});\n\n    _defineProperty(this, \"commonFunc\", {\n      _this: this,\n      //判断对象\n      hasObj: function hasObj(obj) {\n        if (obj != null && typeof obj != 'undefined') {\n          return true;\n        } else {\n          return false;\n        }\n      },\n      //查找对象\n      findObject: function findObject(objname) {\n        var findedobj = null;\n        this.objects.forEach(function (obj, index) {\n          if (obj.name != null && obj.name != '' && obj.name == objname) {\n            findedobj = obj;\n            return findedobj;\n          }\n        });\n        return findedobj;\n      },\n      //获取路径\n      getPath: function getPath(file) {\n        return this._this.BASE_PATH + file;\n      },\n      //生成GUID\n      guid: function guid() {\n        return this.guidRandom() + this.guidRandom() + \"-\" + this.guidRandom() + \"-\" + this.guidRandom() + \"-\" + this.guidRandom() + \"-\" + this.guidRandom() + this.guidRandom() + this.guidRandom();\n      },\n      guidRandom: function guidRandom() {\n        return ((1 + Math.random()) * 0x10000 | 0).toString(16).substring(1);\n      }\n    });\n\n    this.props = props;\n    this.ThreeData = dataJson;\n    this.dataJson = dataJson;\n    this.objList = dataJson.objects || []; //对象列表\n\n    this.eventList = dataJson.events || {}; //事件对象列表\n\n    this.btnList = dataJson.btns || []; //按钮列表\n\n    this.alarmColor = Object.assign({\n      level1: \"#00c5ff\",\n      level2: \"#b0f604\",\n      level3: \"#fcff00\",\n      level4: \"#ff8d00\",\n      level5: \"#ff0000\"\n    }, dataJson.alarmColor);\n    this.renderer = null;\n    this.scene = null; //场景\n\n    this.camera = null;\n    this.objects = []; //存放对象\n\n    this.equipment = []; //存放设备\n\n    this.sprite = []; //存放告警精灵图标\n\n    this.cabinet = []; //存放柜子\n\n    this.dom = document.getElementById(this.props.domID);\n    this.dbclick = 0;\n    this.mouseClick = new THREE.Vector2();\n    this.raycaster = new THREE.Raycaster();\n    this.lastElement = null; //存放最后一个设备\n\n    this.tipTimer = null; //显示提示用的timer\n\n    this.tooltip = null;\n    this.lastEvent = null;\n    this.tooltipBG = '#ACDEFE';\n    this.progressSuccess = 0;\n    this.loadtimer = null;\n    this.BASE_PATH = \"./images/\";\n  }\n\n  _createClass(ThreeMap, [{\n    key: \"init\",\n    value: function init() {\n      this.initRenderer();\n      this.initScene();\n      this.initCamera();\n      this.initLight();\n      this.render(); // this.setHelper();\n\n      this.setControl(); // this.add();\n\n      this.InitData(); //添加3D对象、事件等\n\n      this.renderer.domElement.addEventListener('mousedown', this.onDocumentMouseDown.bind(this), false);\n      this.renderer.domElement.addEventListener('mousemove', this.onDocumentMouseMove.bind(this), false);\n    } //初始化渲染场景\n\n  }, {\n    key: \"initRenderer\",\n    value: function initRenderer() {\n      this.renderer = new THREE.WebGLRenderer({\n        antialias: true\n      });\n      this.renderer.setSize(this.dom.offsetWidth, this.dom.offsetHeight);\n      this.dom.appendChild(this.renderer.domElement);\n    } //初始化相机\n\n  }, {\n    key: \"initCamera\",\n    value: function initCamera() {\n      this.camera = new THREE.PerspectiveCamera(45, this.dom.offsetWidth / this.dom.offsetHeight, 1, 100000);\n      this.camera.name = 'mainCamera';\n      this.camera.position.set(0, 1000, 1800); //默认就是以Y轴为上方的\n      // this.camera.up.x = 0;\n      // this.camera.up.y =1;\n      // this.camera.up.z =0;\n\n      this.camera.lookAt({\n        x: 0,\n        y: 0,\n        z: 0\n      });\n      this.scene.add(this.camera);\n    } //初始化场景\n\n  }, {\n    key: \"initScene\",\n    value: function initScene() {\n      this.scene = new THREE.Scene();\n      this.scene.background = new THREE.Color(0x225F93);\n    } //初始化灯光\n\n  }, {\n    key: \"initLight\",\n    value: function initLight() {\n      var light = new THREE.AmbientLight(0xcccccc);\n      light.position.set(0, 0, 0);\n      this.scene.add(light);\n      var light2 = new THREE.PointLight(0x555555);\n      light2.shadow.camera.near = 1;\n      light2.shadow.camera.far = 5000;\n      light2.position.set(0, 350, 0);\n      light2.castShadow = true; //表示这个光是可以产生阴影的\n\n      this.scene.add(light2);\n    } //渲染\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      this.animate();\n    }\n  }, {\n    key: \"animate\",\n    value: function animate() {\n      requestAnimationFrame(this.render.bind(this));\n      this.renderer.render(this.scene, this.camera);\n    }\n  }, {\n    key: \"setHelper\",\n    value: function setHelper() {\n      //红色x,绿色y,蓝色z\n      var axesHelper = new THREE.AxisHelper(5);\n      this.scene.add(axesHelper);\n    } //鼠标拖拽控制\n\n  }, {\n    key: \"setControl\",\n    value: function setControl() {\n      this.controls = new OrbitControls(this.camera, this.dom);\n      this.controls.update();\n    }\n  }, {\n    key: \"InitData\",\n    value: function InitData() {\n      // this.Loading();\n      if (this.objList.length > 0) {\n        for (var i = 0; i < this.objList.length; i++) {\n          this.InitAddObject(this.objList[i]);\n        }\n      } // if(this.btnList.length>0){\n      //     this.InitBtn();\n      // }\n\n\n      this.createText(this.objList[0].width, this.objList[0].depth);\n      this.InitTooltip(); // this.LoadSuccess();\n    } //刷新视图\n\n  }, {\n    key: \"resetView\",\n    value: function resetView() {\n      this.dom.removeChild(this.renderer.domElement);\n      var map = new ThreeMap(this.props, this.ThreeData);\n      map.init();\n    }\n  }, {\n    key: \"Loading\",\n    value: function Loading() {\n      var div = document.createElement('div');\n      div.setAttribute('id', 'loading');\n      div.style.display = 'block';\n      div.style.position = 'absolute';\n      div.style.left = '0';\n      div.style.top = '0';\n      div.style.width = '100%';\n      div.style.height = '100%';\n      div.style.fontSize = \"30px\";\n      div.style.zIndex = \"999\";\n      div.style.background = 'rgba(0,0,0,0.65)';\n      var loading = document.createElement('div');\n      loading.innerHTML = \"模型加载中...\";\n      loading.style.top = \"40%\";\n      loading.style.position = \"absolute\";\n      loading.style.width = \"100%\";\n      loading.style.textAlign = \"center\";\n      div.appendChild(loading);\n      this.dom.appendChild(div);\n    }\n  }, {\n    key: \"LoadSuccess\",\n    value: function LoadSuccess() {\n      var _this = this;\n\n      if (this.progressSuccess == 3) {\n        var load = this.dom.querySelector(\"#loading\");\n        load.style.display = \"none\";\n        clearTimeout(this.loadtimer);\n      } else {\n        this.loadtimer = setTimeout(function () {\n          _this.LoadSuccess();\n        }, 1000);\n      }\n    } //添加提示框\n\n  }, {\n    key: \"InitTooltip\",\n    value: function InitTooltip() {\n      this.tooltip = document.createElement('div');\n      this.tooltip.setAttribute('id', 'tooltip');\n      this.tooltip.style.display = 'none';\n      this.tooltip.style.position = 'absolute';\n      this.tooltip.style.color = \"#000\";\n      this.tooltip.style.maxWidth = \"200px\";\n      this.tooltip.style.width = '32px';\n      this.tooltip.style.height = 'auto';\n      this.tooltip.style.lineHeight = \"22px\";\n      this.tooltip.style.textAlign = \"center\";\n      this.tooltip.style.padding = \"10px\";\n      this.tooltip.style.background = this.tooltipBG;\n      this.tooltip.style.opacity = 0.8;\n      this.tooltip.style['border-radius'] = '5px';\n      var tipdiv = document.createElement('div');\n      tipdiv.setAttribute(\"id\", \"tipdiv\");\n      var tipspan = document.createElement('span');\n      tipspan.style.marginLeft = \"50%\";\n      tipspan.style.bottom = \"-10px\";\n      tipspan.style.left = \"-10px\";\n      tipspan.style.position = \"absolute\";\n      tipspan.style.borderTop = \"10px solid \" + this.tooltipBG;\n      tipspan.style.borderLeft = \"10px solid transparent\";\n      tipspan.style.borderRight = \"10px solid transparent\";\n      this.tooltip.appendChild(tipspan);\n      this.tooltip.appendChild(tipdiv);\n      this.dom.appendChild(this.tooltip);\n    } //添加按钮\n\n  }, {\n    key: \"InitBtn\",\n    value: function InitBtn() {\n      var _this = this;\n\n      var count = this.btnList.length;\n      var step = 24;\n      var div = document.createElement('div');\n      div.setAttribute('id', 'toolbar');\n      div.style.display = 'block';\n      div.style.position = 'absolute';\n      div.style.left = '10px';\n      div.style.top = '75px';\n      div.style.width = '32px';\n      div.style.height = count * step + step + 'px';\n      div.style.background = 'rgba(255,255,255,0.75)';\n      div.style['border-radius'] = '5px';\n      this.dom.appendChild(div);\n\n      for (var i = 0; i < count; i++) {\n        var button = this.btnList[i];\n        var btnimg = button.btnimg;\n        var img = document.createElement('img');\n        img.style.position = 'absolute';\n        img.style.left = '4px';\n        img.style.top = step / 2 + i * step + 'px';\n        img.style['pointer-events'] = 'auto';\n        img.style['cursor'] = 'pointer';\n        img.setAttribute('src', this.commonFunc.getPath(btnimg));\n        img.style.width = '24px';\n        img.style.height = '24px';\n        img.setAttribute('title', button.btnTitle);\n\n        img.onclick = function () {\n          button.clickFunction(_this);\n        };\n\n        div.appendChild(img);\n      }\n    } //添加3D对象\n\n  }, {\n    key: \"InitAddObject\",\n    value: function InitAddObject(obj) {\n      if (obj.show == null || typeof obj.show == 'undefined' || obj.show) {\n        var tempObj = null;\n\n        switch (obj.objType) {\n          case 'cube':\n            tempObj = this.createCube(obj);\n            this.addObject(tempObj, \"scene\");\n            break;\n\n          case 'desk':\n            this.createObjDesk(obj);\n            break;\n\n          case 'wall':\n            this.CreateWall(obj);\n            break;\n\n          case 'emptyCabinet':\n            tempObj = this.createEmptyCabinet(obj);\n            this.addObject(tempObj, \"scene\");\n            break;\n\n          case 'sprite':\n            this.createSprite(obj);\n            break;\n          // case 'cylinderPlant':  //自定义花\n          //     tempObj = this.createCylinderPlant(obj)\n          //     this.addObject(tempObj,\"scene\");\n          //     break;\n\n          case 'objPlant':\n            //模型花\n            this.createObjPlant(obj);\n            break;\n\n          case 'chair':\n            //模型花\n            this.createObjChair(obj);\n            break;\n\n          case 'objAnnihilator':\n            //模型灭火器\n            this.createObjAnnihilator(obj);\n            break;\n\n          case 'objCamera':\n            //模型摄像头\n            this.createObjCamera(obj);\n            break;\n        }\n      }\n    } //创建墙\n\n  }, {\n    key: \"CreateWall\",\n    value: function CreateWall(obj) {\n      var _this = this;\n\n      var commonDepth = obj.depth || 40; //墙体厚度\n\n      var commonHeight = obj.height || 100; //墙体高度\n\n      var commonWidth = obj.width || 300; //墙体宽度\n\n      var commonSkin = obj.style.skinColor || 0x98750f; //建立墙面\n\n      obj.wallData.forEach(function (wallobj, index) {\n        var wallWidth = commonWidth;\n        var wallDepth = wallobj.depth || commonDepth;\n        var positionX = ((wallobj.startDot.x || 0) + (wallobj.endDot.x || 0)) / 2;\n        var positionY = ((wallobj.startDot.y || 0) + (wallobj.endDot.y || 0)) / 2;\n        var positionZ = ((wallobj.startDot.z || 0) + (wallobj.endDot.z || 0)) / 2; //z相同 表示x方向为长度\n\n        if (wallobj.startDot.z == wallobj.endDot.z) {\n          wallWidth = Math.abs(wallobj.startDot.x - wallobj.endDot.x);\n          wallDepth = wallobj.depth || commonDepth;\n        } else if (wallobj.startDot.x == wallobj.endDot.x) {\n          wallWidth = wallobj.depth || commonDepth;\n          wallDepth = Math.abs(wallobj.startDot.z - wallobj.endDot.z);\n        }\n\n        var cubeobj = {\n          width: wallWidth,\n          height: wallobj.height || commonHeight,\n          depth: wallDepth,\n          rotation: wallobj.rotation,\n          x: positionX,\n          y: positionY,\n          z: positionZ,\n          uuid: wallobj.uuid,\n          name: wallobj.name,\n          style: {\n            skinColor: commonSkin,\n            skin: wallobj.skin\n          }\n        };\n\n        var cube = _this.createCube(cubeobj);\n\n        if (_this.commonFunc.hasObj(wallobj.childrens) && wallobj.childrens.length > 0) {\n          wallobj.childrens.forEach(function (walchildobj, index) {\n            var newobj = _this.CreateHole(walchildobj);\n\n            cube = _this.mergeModel(walchildobj.op, cube, newobj, commonSkin);\n          });\n        }\n\n        _this.addObject(cube, \"scene\");\n      });\n    } //模型合并 使用ThreeBSP插件mergeOP计算方式 -表示减去 +表示加上\n\n  }, {\n    key: \"mergeModel\",\n    value: function mergeModel(mergeOP, fobj, sobj, commonSkin) {\n      var fobjBSP = new ThreeBSP(fobj);\n      var sobjBSP = new ThreeBSP(sobj);\n      var resultBSP = null;\n\n      if (mergeOP == '-') {\n        resultBSP = fobjBSP.subtract(sobjBSP);\n      } else if (mergeOP == '+') {\n        var subMesh = new THREE.Mesh(sobj);\n        sobj.updateMatrix();\n        fobj.geometry.merge(sobj.geometry, sobj.matrix);\n        return fobj; //    resultBSP = fobjBSP.union(sobjBSP);\n      } else if (mergeOP == '&') {\n        //交集\n        resultBSP = fobjBSP.intersect(sobjBSP);\n      } else {\n        this.addObject(sobj, \"scene\");\n        return fobj;\n      }\n\n      var cubeMaterialArray = [];\n      cubeMaterialArray.push(new THREE.MeshLambertMaterial({\n        vertexColors: THREE.FaceColors\n      }));\n      var result = resultBSP.toMesh(cubeMaterialArray);\n      result.material.shading = THREE.FlatShading;\n      result.geometry.computeFaceNormals();\n      result.geometry.computeVertexNormals();\n      result.uuid = fobj.uuid + mergeOP + sobj.uuid;\n      result.name = fobj.name + mergeOP + sobj.name;\n      result.material.needsUpdate = true;\n      result.geometry.buffersNeedUpdate = true;\n      result.geometry.uvsNeedUpdate = true;\n      result.material = fobj.material;\n\n      for (var i = 0; i < result.geometry.faces.length; i++) {\n        var faceset = false;\n\n        for (var j = 0; j < fobj.geometry.faces; j++) {\n          if (result.geometry.faces[i].vertexNormals[0].x === fobj.geometry.faces[j].vertexNormals[0].x && result.geometry.faces[i].vertexNormals[0].y === fobj.geometry.faces[j].vertexNormals[0].y && result.geometry.faces[i].vertexNormals[0].z === fobj.geometry.faces[j].vertexNormals[0].z && result.geometry.faces[i].vertexNormals[1].x === fobj.geometry.faces[j].vertexNormals[1].x && result.geometry.faces[i].vertexNormals[1].y === fobj.geometry.faces[j].vertexNormals[1].y && result.geometry.faces[i].vertexNormals[1].z === fobj.geometry.faces[j].vertexNormals[1].z && result.geometry.faces[i].vertexNormals[2].x === fobj.geometry.faces[j].vertexNormals[2].x && result.geometry.faces[i].vertexNormals[2].y === fobj.geometry.faces[j].vertexNormals[2].y && result.geometry.faces[i].vertexNormals[2].z === fobj.geometry.faces[j].vertexNormals[2].z) {\n            result.geometry.faces[i].color.setHex(commonSkin);\n            result.geometry.faces[i].materialIndex = fobj.geometry.faces[j].materialIndex;\n            faceset == true;\n          }\n        }\n\n        if (faceset == false) {\n          for (var j = 0; j < sobj.geometry.faces.length; j++) {\n            if (result.geometry.faces[i].vertexNormals[0].x === sobj.geometry.faces[j].vertexNormals[0].x && result.geometry.faces[i].vertexNormals[0].y === sobj.geometry.faces[j].vertexNormals[0].y && result.geometry.faces[i].vertexNormals[0].z === sobj.geometry.faces[j].vertexNormals[0].z && result.geometry.faces[i].vertexNormals[1].x === sobj.geometry.faces[j].vertexNormals[1].x && result.geometry.faces[i].vertexNormals[1].y === sobj.geometry.faces[j].vertexNormals[1].y && result.geometry.faces[i].vertexNormals[1].z === sobj.geometry.faces[j].vertexNormals[1].z && result.geometry.faces[i].vertexNormals[2].x === sobj.geometry.faces[j].vertexNormals[2].x && result.geometry.faces[i].vertexNormals[2].y === sobj.geometry.faces[j].vertexNormals[2].y && result.geometry.faces[i].vertexNormals[2].z === sobj.geometry.faces[j].vertexNormals[2].z) {\n              result.geometry.faces[i].color.setHex(commonSkin);\n              result.geometry.faces[i].materialIndex = sobj.geometry.faces[j].materialIndex;\n              faceset = true;\n            }\n          }\n        }\n\n        if (faceset == false) {\n          //最后剩余的一点点给颜色\n          result.geometry.faces[i].color.setHex(commonSkin);\n        }\n      }\n\n      result.castShadow = true;\n      result.receiveShadow = true;\n      return result;\n    } //挖洞、玻璃、挂东西\n\n  }, {\n    key: \"CreateHole\",\n    value: function CreateHole(obj) {\n      var commonDepth = 40; //厚度\n\n      var commonHeight = 100; //高度\n\n      var commonWidth = 300; //强体高度\n\n      var commonSkin = 0x98750f; //建立墙面\n\n      var wallWidth = commonWidth;\n      var wallDepth = obj.depth || commonDepth;\n      var positionX = ((obj.startDot.x || 0) + (obj.endDot.x || 0)) / 2;\n      var positionY = ((obj.startDot.y || 0) + (obj.endDot.y || 0)) / 2;\n      var positionZ = ((obj.startDot.z || 0) + (obj.endDot.z || 0)) / 2; //z相同 表示x方向为长度\n\n      if (obj.startDot.z == obj.endDot.z) {\n        wallWidth = Math.abs(obj.startDot.x - obj.endDot.x);\n        wallDepth = obj.depth || commonDepth;\n      } else if (obj.startDot.x == obj.endDot.x) {\n        wallWidth = obj.depth || commonDepth;\n        wallDepth = Math.abs(obj.startDot.z - obj.endDot.z);\n      }\n\n      var cubeobj = {\n        width: wallWidth,\n        height: obj.height || commonHeight,\n        depth: wallDepth,\n        rotation: obj.rotation,\n        uuid: obj.uuid,\n        name: obj.name,\n        objType: obj.objType,\n        x: positionX,\n        y: positionY,\n        z: positionZ,\n        style: {\n          skinColor: obj.skinColor || commonSkin,\n          skin: obj.skin\n        }\n      };\n      var cube = this.createCube(cubeobj);\n      return cube;\n    } //创建盒子体\n\n  }, {\n    key: \"createCube\",\n    value: function createCube(obj) {\n      var width = obj.width || 1000; //x轴\n\n      var height = obj.height || 10; //y轴\n\n      var depth = obj.depth || width; //z轴\n\n      var x = obj.x || 0,\n          y = obj.y || 0,\n          z = obj.z || 0;\n      var skinColor = obj.style.hasOwnProperty('skinColor') ? obj.style.skinColor : \"\"; //width：是x方向上的长度；height：是y方向上的长度；depth：是z方向上的长度；\n\n      var cubeGeometry = new THREE.CubeGeometry(width, height, depth, 0, 0, 1); //六面颜色\n\n      for (var i = 0; i < cubeGeometry.faces.length; i += 2) {\n        cubeGeometry.faces[i].color.setHex(skinColor);\n        cubeGeometry.faces[i + 1].color.setHex(skinColor);\n      } //六面纹理\n\n\n      var skin_up_obj = {\n        vertexColors: THREE.FaceColors\n      };\n      var skin_down_obj = skin_up_obj,\n          skin_fore_obj = skin_up_obj,\n          skin_behind_obj = skin_up_obj,\n          skin_left_obj = skin_up_obj,\n          skin_right_obj = skin_up_obj;\n      var skin_opacity = 1;\n\n      if (obj.style != null && typeof obj.style != 'undefined' && obj.style.skin != null && typeof obj.style.skin != 'undefined') {\n        //透明度\n        if (obj.style.skin.opacity != null && typeof obj.style.skin.opacity != 'undefined') {\n          skin_opacity = obj.style.skin.opacity;\n        }\n\n        var skin_right = obj.style.skin.hasOwnProperty(\"skin_right\") && obj.style.skin.skin_right.hasOwnProperty('skinColor') ? obj.style.skin.skin_right.skinColor : obj.style.skin.hasOwnProperty(\"skinColor\") ? obj.style.skin.skinColor : \"\";\n        var skin_left = obj.style.skin.hasOwnProperty(\"skin_left\") && obj.style.skin.skin_left.hasOwnProperty('skinColor') ? obj.style.skin.skin_left.skinColor : obj.style.skin.hasOwnProperty(\"skinColor\") ? obj.style.skin.skinColor : \"\";\n        var skin_up = obj.style.skin.hasOwnProperty(\"skin_up\") && obj.style.skin.skin_up.hasOwnProperty('skinColor') ? obj.style.skin.skin_up.skinColor : obj.style.skin.hasOwnProperty(\"skinColor\") ? obj.style.skin.skinColor : \"\";\n        var skin_down = obj.style.skin.hasOwnProperty(\"skin_down\") && obj.style.skin.skin_down.hasOwnProperty('skinColor') ? obj.style.skin.skin_down.skinColor : obj.style.skin.hasOwnProperty(\"skinColor\") ? obj.style.skin.skinColor : \"\";\n        var skin_fore = obj.style.skin.hasOwnProperty(\"skin_fore\") && obj.style.skin.skin_fore.hasOwnProperty('skinColor') ? obj.style.skin.skin_fore.skinColor : obj.style.skin.hasOwnProperty(\"skinColor\") ? obj.style.skin.skinColor : \"\";\n        var skin_behind = obj.style.skin.hasOwnProperty(\"skin_behind\") && obj.style.skin.skin_behind.hasOwnProperty('skinColor') ? obj.style.skin.skin_behind.skinColor : obj.style.skin.hasOwnProperty(\"skinColor\") ? obj.style.skin.skinColor : \"\"; //右\n\n        skin_right_obj = this.createSkinOption(depth, height, obj.style.skin.skin_right, cubeGeometry, skin_right, 0); //左\n\n        skin_left_obj = this.createSkinOption(depth, height, obj.style.skin.skin_left, cubeGeometry, skin_left, 2); //上\n\n        skin_up_obj = this.createSkinOption(width, depth, obj.style.skin.skin_up, cubeGeometry, skin_up, 4); //下\n\n        skin_down_obj = this.createSkinOption(width, depth, obj.style.skin.skin_down, cubeGeometry, skin_down, 6); //前\n\n        skin_fore_obj = this.createSkinOption(width, height, obj.style.skin.skin_fore, cubeGeometry, skin_fore, 8); //后\n\n        skin_behind_obj = this.createSkinOption(width, height, obj.style.skin.skin_behind, cubeGeometry, skin_behind, 10);\n      }\n\n      var cubeMaterialArray = []; //右，左，上，下，前，后\n      //右：134、364；左：570、720；上：451、501；下：762、632；前：021、231；后：465、675；\n      //正面：上左上右下左下右(0123)；后面正对看：上左上右下左下右(4567)\n\n      cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_right_obj));\n      cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_left_obj));\n      cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_up_obj));\n      cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_down_obj));\n      cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_fore_obj));\n      cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_behind_obj));\n      var cube = new THREE.Mesh(cubeGeometry, cubeMaterialArray);\n      cube.castShadow = true;\n      cube.receiveShadow = true;\n      cube.uuid = obj.uuid;\n      cube.name = obj.name;\n      cube.position.set(x, y, z);\n\n      if (obj.rotation != null && typeof obj.rotation != 'undefined' && obj.rotation.length > 0) {\n        obj.rotation.forEach(function (rotation_obj, index) {\n          // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\n          switch (rotation_obj.direction) {\n            case 'x':\n              cube.rotateX(rotation_obj.degree);\n              break;\n\n            case 'y':\n              cube.rotateY(rotation_obj.degree);\n              break;\n\n            case 'z':\n              cube.rotateZ(rotation_obj.degree);\n              break;\n\n            case 'arb':\n              //{ direction: 'arb', degree: [x,y,z,angle] }  x,y,z是向量0,1,0 表示y轴旋转\n              cube.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\n              break;\n          }\n        });\n      }\n\n      return cube;\n    } // 创建桌子\n\n  }, {\n    key: \"CreateTable\",\n    value: function CreateTable(obj) {\n      //初始以下为基点(中心点以机柜的中心为中心点)\n      var Cabinet,\n          floorHeight = 10,\n          uuid = obj.uuid || this.commonFunc.guid(); //上\n\n      var upobj = {\n        show: true,\n        uuid: \"\",\n        name: \"cubetop\",\n        objType: 'cube',\n        width: obj.size.width,\n        height: obj.size.thick,\n        depth: obj.size.depth,\n        x: 0,\n        y: obj.size.height - obj.size.thick,\n        z: 0,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var upcube = this.createCube(upobj); //左\n\n      var leftobj = {\n        show: true,\n        uuid: \"\",\n        name: \"cubeleft\",\n        objType: 'cube',\n        width: obj.size.thick,\n        height: obj.size.height - 2 * obj.size.thick,\n        depth: obj.size.depth,\n        x: -(obj.size.width / 2 + obj.size.thick / 2) * 0.9,\n        y: -obj.size.height / 2 + obj.size.thick / 2,\n        z: 0,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var leftcube = this.createCube(leftobj);\n      Cabinet = this.mergeModel('+', upcube, leftcube); //右\n\n      var rightobj = {\n        show: true,\n        uuid: \"\",\n        name: \"cuberight\",\n        objType: 'cube',\n        width: obj.size.thick,\n        height: obj.size.height - 2 * obj.size.thick,\n        depth: obj.size.depth,\n        x: (obj.size.width / 2 - obj.size.thick / 2) * 0.9,\n        y: -obj.size.height / 2 + obj.size.thick / 2,\n        z: 0,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var rightcube = this.createCube(rightobj);\n      Cabinet = this.mergeModel('+', Cabinet, rightcube);\n      this.addObject(Cabinet, \"object\"); //这里也得给添加到对象，不然hour的时候设备的提示信息有问题，没拉出设备放机柜顶上也提示了\n\n      var tempobj = new THREE.Object3D();\n      tempobj.add(Cabinet);\n      tempobj.name = obj.name;\n      tempobj.uuid = uuid;\n      tempobj.data = obj.data || {\n        name: obj.name,\n        alarmInfo: []\n      };\n      tempobj.position.set(obj.x || 0, (obj.y || 0) + floorHeight, obj.z || 0);\n      this.addObject(tempobj, \"object\");\n\n      if (obj.rotation != null && typeof obj.rotation != 'undefined' && obj.rotation.length > 0) {\n        obj.rotation.forEach(function (rotation_obj, index) {\n          // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\n          switch (rotation_obj.direction) {\n            case 'x':\n              tempobj.rotateX(rotation_obj.degree);\n              break;\n\n            case 'y':\n              tempobj.rotateY(rotation_obj.degree);\n              break;\n\n            case 'z':\n              tempobj.rotateZ(rotation_obj.degree);\n              break;\n\n            case 'arb':\n              //{ direction: 'arb', degree: [x,y,z,angle] }\n              tempobj.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\n              break;\n          }\n        });\n      }\n\n      return tempobj;\n    } //创建柜子\n\n  }, {\n    key: \"createEmptyCabinet\",\n    value: function createEmptyCabinet(obj) {\n      //初始以下为基点(中心点以机柜的中心为中心点)\n      var Cabinet,\n          floorHeight = 10,\n          _this = this,\n          uuid = obj.uuid || this.commonFunc.guid(); //下\n\n\n      var downobj = {\n        show: true,\n        name: \"cubedown\",\n        uuid: \"\",\n        objType: 'cube',\n        width: obj.size.width,\n        height: obj.size.thick,\n        depth: obj.size.depth,\n        x: 0,\n        y: -obj.size.height / 2 + obj.size.thick / 2,\n        z: 0,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var downcube = this.createCube(downobj); //上\n\n      var upobj = {\n        show: true,\n        uuid: \"\",\n        name: \"cubetop\",\n        objType: 'cube',\n        width: obj.size.width,\n        height: obj.size.thick,\n        depth: obj.size.depth,\n        x: 0,\n        y: obj.size.height - obj.size.thick,\n        z: 0,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var upcube = this.createCube(upobj);\n      Cabinet = this.mergeModel('+', downcube, upcube); //左\n\n      var leftobj = {\n        show: true,\n        uuid: \"\",\n        name: \"cubeleft\",\n        objType: 'cube',\n        width: obj.size.thick,\n        height: obj.size.height - 2 * obj.size.thick,\n        depth: obj.size.depth,\n        x: -obj.size.width / 2 + obj.size.thick / 2,\n        y: obj.size.height / 2 - obj.size.thick / 2,\n        z: 0,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var leftcube = this.createCube(leftobj);\n      Cabinet = this.mergeModel('+', Cabinet, leftcube); //右\n\n      var rightobj = {\n        show: true,\n        uuid: \"\",\n        name: \"cuberight\",\n        objType: 'cube',\n        width: obj.size.thick,\n        height: obj.size.height - 2 * obj.size.thick,\n        depth: obj.size.depth,\n        x: obj.size.width / 2 - obj.size.thick / 2,\n        y: obj.size.height / 2 - obj.size.thick / 2,\n        z: 0,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var rightcube = this.createCube(rightobj);\n      Cabinet = this.mergeModel('+', Cabinet, rightcube); //后\n\n      var behindobj = {\n        show: true,\n        uuid: \"\",\n        name: '',\n        objType: 'cube',\n        width: obj.size.width,\n        height: obj.size.height - 2 * obj.size.thick,\n        depth: obj.size.thick,\n        x: 0,\n        y: obj.size.height / 2 - obj.size.thick / 2,\n        z: -obj.size.depth / 2 + obj.size.thick / 2,\n        style: {\n          skinColor: obj.style.skinColor,\n          skin: obj.style.skin\n        }\n      };\n      var behindcube = this.createCube(behindobj);\n      Cabinet = this.mergeModel('+', Cabinet, behindcube);\n      this.addObject(Cabinet, \"object\"); //这里也得给添加到对象，不然hour的时候设备的提示信息有问题，没拉出设备放机柜顶上也提示了\n\n      var tempobj = new THREE.Object3D();\n      tempobj.add(Cabinet);\n      tempobj.name = obj.name;\n      tempobj.uuid = uuid;\n      tempobj.data = obj.data || {\n        name: obj.name,\n        alarmInfo: []\n      };\n      tempobj.position.set(obj.x || 0, (obj.y || 0) + floorHeight, obj.z || 0);\n      this.addObject(tempobj, \"object\");\n      this.cabinet.push(tempobj); //门\n\n      if (obj.doors != null && typeof obj.doors != 'undefined') {\n        if (obj.doors.skins.length == 1 && obj.doors.doorname.length == 1) {\n          var doorobj = {\n            show: true,\n            uuid: \"\",\n            name: obj.doors.doorname[0],\n            objType: 'cube',\n            depth: obj.size.thick,\n            width: obj.size.width,\n            height: obj.size.height - 2 * obj.size.thick,\n            x: 0,\n            y: 0,\n            z: obj.size.depth / 2 - obj.size.thick / 2 + 1,\n            rotation: obj.doors.rotation || null,\n            style: {\n              skinColor: obj.doors.skins[0].skinColor,\n              skin: obj.doors.skins[0]\n            }\n          };\n          var doorcube = this.createCube(doorobj);\n\n          if (obj.doors.rotation) {\n            doorcube.position.set(obj.size.width / 2, 0, obj.size.depth / 2 - obj.size.thick / 2 + 1 + obj.size.width / 2);\n          }\n\n          doorcube.tipInfo = obj.doors.tipInfo;\n          tempobj.add(doorcube);\n          this.addObject(doorcube, \"object\");\n        } else if (obj.doors.skins.length == 2 && obj.doors.doorname.length == 2) {\n          for (var i = 0; i < obj.doors.skins.length; i++) {\n            var x = i === 0 ? -obj.size.width / 4 : obj.size.width / 4;\n            var doorobj = {\n              show: true,\n              uuid: \"\",\n              name: obj.doors.doorname[i],\n              objType: 'cube',\n              depth: obj.size.thick,\n              width: obj.size.width / 2,\n              height: obj.size.height,\n              x: x,\n              y: 0,\n              z: obj.size.depth / 2 - obj.size.thick / 2 + 1,\n              style: {\n                skinColor: obj.doors.skins[i].skinColor,\n                skin: obj.doors.skins[i]\n              }\n            };\n            var doorcube = this.createCube(doorobj);\n            tempobj.add(doorcube);\n            this.addObject(doorcube, \"object\");\n          }\n        }\n      } //机柜告警信息\n\n\n      if (this.commonFunc.hasObj(obj.data)) {\n        //文本信息\n        var width = obj.size.width || 70;\n        var height = obj.size.height || 70;\n        var canvas = document.createElement('canvas');\n        canvas['width'] = width;\n        canvas['height'] = height;\n        var context = canvas.getContext('2d');\n        context.beginPath();\n        context.rect(0, 0, width, height);\n        context.fillStyle = 'rgba(255, 255, 255, 0)'; //canvas设置为透明\n\n        context.fill();\n\n        var marker = function marker(context, x, y, text) {\n          var color = '#ffffff';\n          context.font = 12 + 'px \"Microsoft Yahei\" ';\n          context.fillStyle = color;\n          context.textAlign = 'center';\n          context.textBaseline = 'middle';\n          context.strokeStyle = color;\n          context.fillText(text, x, y);\n        };\n\n        marker(context, width / 2, height / 2, obj.data.name);\n        var alarmobj = {\n          width: width,\n          height: height,\n          imgurl: canvas,\n          y: obj.size.height / 2 + 1,\n          transparent: true,\n          opacity: 0.8,\n          rotation: [{\n            direction: 'x',\n            degree: -0.5 * Math.PI\n          }]\n        };\n        var text = this.createPlaneGeometry(alarmobj);\n        tempobj.add(text); //告警信息\n      }\n\n      if (this.commonFunc.hasObj(obj.childrens) && obj.childrens.length > 0) {\n        var equipmentUUID = [];\n        obj.childrens.forEach(function (service, index) {\n          var serviceuuid = service.uuid || _this.commonFunc.guid();\n\n          service.x = obj.x;\n          service.z = obj.z;\n          service.y = service.y + floorHeight + (obj.y - (obj.size.height - 2 * obj.size.thick) / 2);\n          service.rotation = obj.rotation || null;\n\n          var newobj = _this.createCube(service);\n\n          newobj.data = service.data;\n          newobj.data[\"cabinetUUID\"] = uuid;\n          newobj.uuid = serviceuuid;\n          equipmentUUID.push(serviceuuid);\n\n          _this.addObject(newobj);\n\n          _this.equipment.push(newobj);\n        });\n        tempobj.data[\"equipmentUUID\"] = equipmentUUID;\n      }\n\n      if (obj.rotation != null && typeof obj.rotation != 'undefined' && obj.rotation.length > 0) {\n        obj.rotation.forEach(function (rotation_obj, index) {\n          // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\n          switch (rotation_obj.direction) {\n            case 'x':\n              tempobj.rotateX(rotation_obj.degree);\n              break;\n\n            case 'y':\n              tempobj.rotateY(rotation_obj.degree);\n              break;\n\n            case 'z':\n              tempobj.rotateZ(rotation_obj.degree);\n              break;\n\n            case 'arb':\n              //{ direction: 'arb', degree: [x,y,z,angle] }\n              tempobj.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\n              break;\n          }\n        });\n      }\n\n      return tempobj;\n    } //创建圆柱体\n\n  }, {\n    key: \"createCylinderPlant\",\n    value: function createCylinderPlant(obj) {\n      var _this = this;\n\n      var radiusTop = obj.radiusTop || 20; //顶面的半径\n\n      var radiusBottom = obj.radiusBottom || 20; //底面的半径\n\n      var height = obj.height || 100; //高度\n\n      var radiusSegments = obj.radiusSegments || 8;\n      var heightSegments = obj.heightSegments || 1;\n      var openEnded = obj.openEnded || false;\n      var x = obj.x || 0,\n          y = obj.y || 0,\n          z = obj.z || 0;\n      var skinColor = obj.style.skinColor || 0x98750f; //创建圆柱体\n\n      var cylinderGeo = new THREE.CylinderGeometry(radiusTop, radiusBottom, height, radiusSegments, heightSegments, openEnded); // console.log(cylinderGeo)\n\n      var cylinderMat = new THREE.MeshLambertMaterial({\n        //创建材料\n        color: skinColor,\n        wireframe: false\n      }); //创建圆柱体网格模型\n\n      var cylinder = new THREE.Mesh(cylinderGeo, cylinderMat);\n      cylinder.position.set(x, y, z); //设置圆柱坐标\n\n      if (this.commonFunc.hasObj(obj.childrens) && obj.childrens.length > 0) {\n        obj.childrens.forEach(function (childobj, index) {\n          var newobj;\n\n          if (childobj.objType == \"plane\") {\n            newobj = _this.createPlaneGeometry(childobj);\n          } else {\n            newobj = _this.createCylinderPlant(childobj);\n          }\n\n          _this.addObject(newobj, \"scene\"); // cylinder = _this.mergeModel('+', cylinder, newobj,skinColor);\n\n        });\n      }\n\n      return cylinder;\n    } //创建平面\n\n  }, {\n    key: \"createPlaneGeometry\",\n    value: function createPlaneGeometry(obj) {\n      var texture;\n      var transparent = obj.transparent;\n\n      if (obj.transparent !== false) {\n        transparent = true;\n      }\n\n      if (typeof obj.imgurl == \"string\") {\n        //传入的材质是图片路径，使用 textureloader加载图片作为材质\n        var loader = new THREE.TextureLoader(); // loader.setCrossOrigin(this.crossOrigin);\n\n        var imgurl = obj.imgurl;\n\n        if (obj.imgurl.indexOf(\"data:image/\") == -1) {\n          imgurl = this.commonFunc.getPath(obj.imgurl);\n        }\n\n        texture = loader.load(imgurl, function () {}, undefined, function () {});\n      } else {\n        texture = new THREE.CanvasTexture(obj.imgurl);\n      }\n\n      var MaterParam = {\n        //材质的参数\n        map: texture,\n        side: obj.side || THREE.DoubleSide,\n        // side:THREE.FrontSide,\n        transparent: transparent,\n        opacity: obj.opacity || 1\n      };\n\n      if (obj.blending) {\n        MaterParam.blending = THREE.AdditiveBlending; //使用饱和度叠加渲染\n      }\n\n      var plane = new THREE.Mesh(new THREE.PlaneGeometry(obj.width, obj.height, 1, 1), new THREE.MeshBasicMaterial(MaterParam));\n      plane.position.x = obj.x || 0;\n      plane.position.y = obj.y || 0;\n      plane.position.z = obj.z || 0;\n\n      if (obj.rotation != null && typeof obj.rotation != 'undefined' && obj.rotation.length > 0) {\n        obj.rotation.forEach(function (rotation_obj, index) {\n          // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\n          switch (rotation_obj.direction) {\n            case 'x':\n              plane.rotateX(rotation_obj.degree);\n              break;\n\n            case 'y':\n              plane.rotateY(rotation_obj.degree);\n              break;\n\n            case 'z':\n              plane.rotateZ(rotation_obj.degree);\n              break;\n\n            case 'arb':\n              //{ direction: 'arb', degree: [x,y,z,angle] }  x,y,z是向量0,1,0 表示y轴旋转\n              plane.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\n              break;\n          }\n        });\n      }\n\n      return plane;\n    } //模型植物加载\n\n  }, {\n    key: \"createObjPlant\",\n    value: function createObjPlant(obj) {\n      var _this = this;\n\n      var mtlLoader = new MTLLoader();\n      mtlLoader.load(_this.commonFunc.getPath('plant/plant.mtl'), function (materials) {\n        materials.preload();\n        var objLoader = new OBJLoader();\n        console.log(materials);\n        objLoader.setMaterials(materials);\n        objLoader.load(_this.commonFunc.getPath('plant/plant.obj'), function (object) {\n          obj.childrens.forEach(function (childobj) {\n            var newobj = object.clone();\n\n            if (!newobj.objHandle) {\n              if (childobj.objHandle) {\n                newobj.objHandle = childobj.objHandle;\n              } else if (obj.objHandle) {\n                newobj.objHandle = obj.objHandle;\n              }\n            }\n\n            newobj = _this.handleObj(newobj);\n            newobj.position.set(childobj.x || 0, childobj.y || 0, childobj.z || 0);\n\n            _this.scene.add(newobj);\n          });\n          _this.progressSuccess += 1;\n        }, _this.onProgress, _this.onError);\n      });\n    } // 创建椅子\n\n  }, {\n    key: \"createObjChair\",\n    value: function createObjChair(obj) {\n      var _this = this;\n\n      var mtlLoader = new MTLLoader();\n      mtlLoader.load(_this.commonFunc.getPath('chair/chair.mtl'), function (materials) {\n        materials.preload();\n        var objLoader = new OBJLoader();\n        objLoader.setMaterials(materials);\n        objLoader.load(_this.commonFunc.getPath('chair/chair.obj'), function (object) {\n          obj.childrens.forEach(function (childobj) {\n            var newobj = object.clone();\n\n            if (!newobj.objHandle) {\n              if (childobj.objHandle) {\n                newobj.objHandle = childobj.objHandle;\n              } else if (obj.objHandle) {\n                newobj.objHandle = obj.objHandle;\n              }\n            }\n\n            newobj = _this.handleObj(newobj);\n            newobj.position.set(childobj.x || 0, childobj.y || 0, childobj.z || 0);\n\n            _this.scene.add(newobj);\n          });\n          _this.progressSuccess += 1;\n        }, _this.onProgress, _this.onError);\n      });\n    } // 创建桌子\n\n  }, {\n    key: \"createObjDesk\",\n    value: function createObjDesk(obj) {\n      var _this = this;\n\n      var mtlLoader = new MTLLoader();\n      mtlLoader.load(_this.commonFunc.getPath('desk/desk.mtl'), function (materials) {\n        // materials['materialsInfo']['Bamboo_Wood']['map_kd'] = _this.BASE_PATH + 'desk/bamboo-wood-semigloss-albedo.png'\n        // materials['materialsInfo']['Bamboo_Wood']['map_ns'] = _this.BASE_PATH + 'bamboo-wood-semigloss-roughness.png'\n        // materials['materialsInfo']['Bamboo_Wood']['refl'] = _this.BASE_PATH + 'bamboo-wood-semigloss-metal.png'\n        materials.preload();\n        var objLoader = new OBJLoader();\n        objLoader.setMaterials(materials);\n        objLoader.load(_this.commonFunc.getPath('desk/desk.obj'), function (object) {\n          obj.childrens.forEach(function (childobj) {\n            var newobj = object.clone();\n\n            if (!newobj.objHandle) {\n              if (childobj.objHandle) {\n                newobj.objHandle = childobj.objHandle;\n              } else if (obj.objHandle) {\n                newobj.objHandle = obj.objHandle;\n              }\n            }\n\n            newobj = _this.handleObj(newobj);\n            newobj.position.set(childobj.x || 0, childobj.y || 0, childobj.z || 0);\n\n            _this.scene.add(newobj);\n          });\n          _this.progressSuccess += 1;\n        }, _this.onProgress, _this.onError);\n      });\n    } //模型灭火器\n\n  }, {\n    key: \"createObjAnnihilator\",\n    value: function createObjAnnihilator(obj) {\n      var _this = this;\n\n      var mtlLoader = new MTLLoader();\n      mtlLoader.load(_this.commonFunc.getPath('annihilator/annihilator.mtl'), function (materials) {\n        materials.preload();\n        var objLoader = new OBJLoader();\n        objLoader.setMaterials(materials);\n        objLoader.load(_this.commonFunc.getPath('annihilator/annihilator.obj'), function (object) {\n          obj.childrens.forEach(function (childobj) {\n            var newobj = object.clone();\n\n            if (!newobj.objHandle) {\n              if (childobj.objHandle) {\n                newobj.objHandle = childobj.objHandle;\n              } else if (obj.objHandle) {\n                newobj.objHandle = obj.objHandle;\n              }\n            }\n\n            newobj = _this.handleObj(newobj);\n            newobj.position.set(childobj.x || 0, childobj.y || 0, childobj.z || 0);\n\n            _this.scene.add(newobj);\n          });\n          _this.progressSuccess += 1;\n        }, _this.onProgress, _this.onError);\n      });\n    } //摄像头\n\n  }, {\n    key: \"createObjCamera\",\n    value: function createObjCamera(obj) {\n      var _this = this;\n\n      var mtlLoader = new MTLLoader();\n      mtlLoader.load(_this.commonFunc.getPath('camera/camera.mtl'), function (materials) {\n        materials.preload();\n        var objLoader = new OBJLoader();\n        objLoader.setMaterials(materials);\n        objLoader.load(_this.commonFunc.getPath('camera/camera.obj'), function (object) {\n          obj.childrens.forEach(function (childobj) {\n            var newobj = object.clone();\n\n            if (!newobj.objHandle) {\n              if (childobj.objHandle) {\n                newobj.objHandle = childobj.objHandle;\n              } else if (obj.objHandle) {\n                newobj.objHandle = obj.objHandle;\n              }\n            }\n\n            newobj = _this.handleObj(newobj);\n            newobj.position.set(childobj.x || 0, childobj.y || 0, childobj.z || 0);\n\n            _this.scene.add(newobj);\n          });\n          _this.progressSuccess += 1;\n        }, _this.onProgress, _this.onError);\n      });\n    }\n  }, {\n    key: \"handleObj\",\n    value: function handleObj(obj) {\n      if (obj.objHandle != null && typeof obj.objHandle != 'undefined' && obj.objHandle.length > 0) {\n        obj.objHandle.forEach(function (childobj) {\n          // objHandle: [{ direction: 'x', ratio: 0.5 ,degree:0.5*Math.PI}],\n          switch (childobj.direction) {\n            case 'x':\n              if (childobj.ratio) {\n                obj.scale.x = childobj.ratio;\n              }\n\n              if (childobj.degree) {\n                obj.rotateX(childobj.degree);\n              }\n\n              break;\n\n            case 'y':\n              if (childobj.ratio) {\n                obj.scale.y = childobj.ratio;\n              }\n\n              if (childobj.degree) {\n                obj.rotateY(childobj.degree);\n              }\n\n              break;\n\n            case 'z':\n              if (childobj.ratio) {\n                obj.scale.z = childobj.ratio;\n              }\n\n              if (childobj.degree) {\n                obj.rotateZ(childobj.degree);\n              }\n\n              break;\n\n            case 'arb':\n              //{ direction: 'arb', handleScale: [0.01,0.01,0.01], handleRotale: [0,1,0,0.5*Math.PI]}\n              if (childobj.handleScale && childobj.handleScale.length == 3) {\n                obj.scale.set(childobj.handleScale[0], childobj.handleScale[1], childobj.handleScale[2]);\n              }\n\n              if (childobj.handleRotale && childobj.handleRotale.length == 4) {\n                obj.rotateOnAxis(new THREE.Vector3(childobj.handleRotale[0], childobj.handleRotale[1], childobj.handleRotale[2]), childobj.handleRotale[3]);\n              }\n\n              break;\n          }\n        });\n      }\n\n      return obj;\n    } //进度通知\n\n  }, {\n    key: \"changePivot\",\n    value: //设置旋转中心\n    function changePivot(obj, x, y, z) {\n      var tempobj = new THREE.Object3D();\n      tempobj.position.set(obj.position.x + x, obj.position.y + y, obj.position.z + z);\n      obj.position.set(-x, -y, -z);\n      tempobj.add(obj);\n      return tempobj;\n    } //添加对象\n\n  }, {\n    key: \"addObject\",\n    value: function addObject(obj, info) {\n      if (info) {\n        if (info == \"object\") {\n          this.objects.push(obj);\n        }\n\n        if (info == \"scene\") {\n          this.scene.add(obj);\n        }\n      } else {\n        this.objects.push(obj);\n        this.scene.add(obj);\n      }\n    } //创建皮肤材质操作\n\n  }, {\n    key: \"createSkinOption\",\n    value: function createSkinOption(width, height, obj, cube, cubeColor, cubefacenub) {\n      if (this.commonFunc.hasObj(obj)) {\n        if (this.commonFunc.hasObj(obj.imgUrl)) {\n          var MaterParam = {\n            color: cubeColor,\n            map: this.createSkin(width, height, obj),\n            opacity: obj.opacity || 1\n          };\n\n          if (obj.transparent) {\n            MaterParam.transparent = obj.transparent;\n          }\n\n          if (obj.blending) {\n            MaterParam.blending = THREE.AdditiveBlending; //使用饱和度叠加渲染\n          }\n\n          return MaterParam;\n        } else {\n          if (this.commonFunc.hasObj(obj.skinColor)) {\n            cube.faces[cubefacenub].color.setHex(obj.skinColor);\n            cube.faces[cubefacenub + 1].color.setHex(obj.skinColor);\n          }\n\n          return {\n            vertexColors: THREE.FaceColors\n          };\n        }\n      } else {\n        return {\n          vertexColors: THREE.FaceColors\n        };\n      }\n    } //使用材质图片\n\n  }, {\n    key: \"createSkin\",\n    value: function createSkin(width, height, obj) {\n      var imgwidth = 128,\n          imgheight = 128;\n\n      if (obj.width != null && typeof obj.width != 'undefined') {\n        imgwidth = obj.width;\n      }\n\n      if (obj.height != null && typeof obj.height != 'undefined') {\n        imgheight = obj.height;\n      }\n\n      var texture = new THREE.TextureLoader().load(this.commonFunc.getPath(obj.imgUrl));\n      var repeat = false;\n\n      if (obj.repeatx != null && typeof obj.repeatx != 'undefined' && obj.repeatx == true) {\n        texture.wrapS = THREE.RepeatWrapping;\n        repeat = true;\n      }\n\n      if (obj.repeaty != null && typeof obj.repeaty != 'undefined' && obj.repeaty == true) {\n        texture.wrapT = THREE.RepeatWrapping;\n        repeat = true;\n      }\n\n      if (repeat) {\n        texture.repeat.set(width / imgwidth, height / imgheight);\n      }\n\n      return texture;\n    } //创建文字\n\n  }, {\n    key: \"createText\",\n    value: function createText(floorWidth, floorHeight) {\n      var canvas = document.createElement('canvas');\n      canvas['width'] = 1024;\n      canvas['height'] = 1024;\n      var context = canvas.getContext('2d');\n      context.beginPath();\n      context.rect(0, 0, 1024, 1024);\n      context.fillStyle = 'rgba(255, 255, 255, 0)'; //canvas设置为透明\n\n      context.fill();\n\n      var marker = function marker(context, text, text2, x, y) {\n        var color = '#0B2F3A'; //'#0B2F3A';//'#FE642E';\n\n        context.font = 30 + 'px \"Microsoft Yahei\" ';\n        context.fillStyle = color;\n        context.textAlign = 'center';\n        context.textBaseline = 'middle'; //context.shadowBlur = 30;\n\n        context.strokeStyle = color;\n        context.lineWidth = 3;\n        context.strokeText(text, x, y);\n        if (!text2) return;\n        y += 30;\n        color = '#FE642E';\n        context.font = 16 + 'px \"Microsoft Yahei\" ';\n        context.fillStyle = color;\n        context.textAlign = 'center';\n        context.textBaseline = 'middle';\n        context.fillText(text2, x, y);\n      };\n\n      marker(context, '阿里巴巴', 'ip待分配', 500, 380);\n      marker(context, '腾讯', '192.168.1.150', 500, 495);\n      marker(context, '依米康·龙控', '192.168.1.100', 500, 610);\n      var obj = {\n        width: floorHeight,\n        height: floorWidth,\n        imgurl: canvas,\n        y: 6,\n        transparent: true,\n        opacity: 0.8,\n        rotation: [{\n          direction: 'x',\n          degree: -0.5 * Math.PI\n        }, {\n          direction: 'z',\n          degree: 0.5 * Math.PI\n        }]\n      };\n      var text = this.createPlaneGeometry(obj);\n      this.scene.add(text);\n    } //更新告警状态\n\n  }, {\n    key: \"updateAlarmStatus\",\n    value: function updateAlarmStatus(arr) {\n      for (var i = 0; i < this.equipment.length; i++) {\n        for (var j = 0; j < arr.length; j++) {\n          if (arr[j].devid == this.equipment[i].data.devid && arr[j].pointid == this.equipment[i].data.pointid) {\n            for (var m = 0; m < this.sprite.length; m++) {\n              if (this.sprite[m].data.cabinetUUID == this.equipment[i].data.cabinetUUID) {\n                this.changeCabinetAlarmObj(arr[j], m, i);\n              }\n            }\n          }\n        }\n      }\n    } //更新机柜的告警对象\n\n  }, {\n    key: \"changeCabinetAlarmObj\",\n    value: function changeCabinetAlarmObj(obj, spriteIndex, equipmentIndex) {\n      var arr = this.sprite[spriteIndex].data.alarmInfo;\n      this.sprite[spriteIndex].material.map;\n\n      if (obj.isalarm) {\n        if (Number(this.sprite[spriteIndex].data.level) < Number(obj.level)) {\n          this.sprite[spriteIndex].data.level = obj.level;\n          this.sprite[spriteIndex].material.color.set(this.alarmColor[\"level\" + obj.level]);\n        }\n\n        var flag = true; //默认是新的告警\n\n        for (var i = 0; i < arr.length; i++) {\n          if (arr[i].devid == obj.devid && arr[i].pointid == obj.pointid) {\n            //已经存在的告警再次告警\n            arr.splice(i, 1, obj);\n            flag = false;\n          }\n        }\n\n        if (flag) {\n          arr.push(obj);\n        }\n\n        if (this.equipment[equipmentIndex].material.length > 0) {\n          for (var _i = 0; _i < this.equipment[equipmentIndex].material.length; _i++) {\n            this.equipment[equipmentIndex].material[_i].color.set(this.alarmColor[\"level\" + obj.level]);\n          }\n        }\n\n        this.equipment[equipmentIndex].data.isalarm = true;\n        this.sprite[spriteIndex].visible = obj.isalarm;\n        var info = obj.name + obj.alarmInfo;\n        this.alarmPlay(info);\n      } else {\n        if (arr.length > 0) {\n          for (var _i2 = 0; _i2 < arr.length; _i2++) {\n            if (arr[_i2].devid == obj.devid && arr[_i2].pointid == obj.pointid) {\n              arr.splice(_i2, 1);\n            }\n          }\n\n          if (arr.length > 0) {\n            var levelArr = [];\n\n            for (var _i3 = 0; _i3 < arr.length; _i3++) {\n              levelArr.push(arr[_i3].level);\n            }\n\n            var max = Math.max.apply(Math, levelArr);\n            this.sprite[spriteIndex].data.level = max;\n            this.sprite[spriteIndex].material.color.set(this.alarmColor[\"level\" + max]);\n          } else {\n            this.sprite[spriteIndex].data.level = \"1\";\n            this.sprite[spriteIndex].visible = false;\n          }\n        }\n\n        if (this.equipment[equipmentIndex].material.length > 0) {\n          for (var _i4 = 0; _i4 < this.equipment[equipmentIndex].material.length; _i4++) {\n            this.equipment[equipmentIndex].material[_i4].color.set(\"#ffffff\");\n          }\n        }\n      }\n    } //告警播放\n\n  }, {\n    key: \"alarmPlay\",\n    value: function alarmPlay(info) {\n      var utterThis = new window.SpeechSynthesisUtterance();\n      utterThis.text = info;\n      utterThis.lang = \"zh-CN\"; //使用语言\n\n      utterThis.pitch = 2; //表示说话的音高，数值，范围从0（最小）到2（最大）。默认值为1\n\n      utterThis.rate = 1; // 语速，数值，默认值是1，范围是0.1到10，表示语速的倍数，例如2表示正常语速的两倍\n\n      utterThis.volume = 1; //声音的音量，区间范围是0到1，默认是1\n\n      window.speechSynthesis.speak(utterThis);\n    }\n  }, {\n    key: \"onDocumentMouseDown\",\n    value:\n    /*\r\n    *事件部分\r\n    */\n    //鼠标按下事件\n    function onDocumentMouseDown(event) {\n      this.dbclick++;\n\n      var _this = this;\n\n      setTimeout(function () {\n        _this.dbclick = 0;\n      }, 500);\n      event.preventDefault();\n\n      if (this.dbclick >= 2) {\n        // 将鼠标位置归一化为设备坐标。x 和 y 方向的取值范围是 (-1 to +1)\n        this.mouseClick.x = event.offsetX / this.dom.offsetWidth * 2 - 1;\n        this.mouseClick.y = -(event.offsetY / this.dom.offsetHeight) * 2 + 1;\n        this.raycaster.setFromCamera(this.mouseClick, this.camera);\n        var intersects = this.raycaster.intersectObjects(this.objects);\n\n        if (intersects.length > 0) {\n          this.controls.enabled = false;\n          var SELECTED = intersects[0].object; // console.log(SELECTED)\n\n          if (this.eventList != null && this.eventList.dbclick != null && this.eventList.dbclick.length > 0) {\n            this.eventList.dbclick.forEach(function (_obj, index) {\n              if (\"string\" == typeof _obj.obj_name) {\n                if (_obj.obj_name == SELECTED.name) {\n                  _obj.obj_event(SELECTED, _this);\n                }\n              } else if (_obj.findObject != null || 'function' == typeof _obj.findObject) {\n                if (_obj.findObject(SELECTED.name)) {\n                  _obj.obj_event(SELECTED, _this);\n                }\n              }\n            });\n          }\n\n          this.controls.enabled = true;\n        }\n      }\n    }\n  }, {\n    key: \"openCloseDoor\",\n    value: function openCloseDoor(obj, x, y, z, info) {\n      console.log(obj);\n      var doorstate = \"close\";\n      var tempobj = null;\n\n      if (obj.doorState != null && typeof obj.doorState != 'undefined') {\n        doorstate = obj.doorState;\n        tempobj = obj.parent;\n      } else {\n        console.log(\"add parent\");\n        var objparent = obj.parent;\n        tempobj = new THREE.Object3D();\n        tempobj.position.set(obj.position.x + x, obj.position.y + y, obj.position.z + z);\n        obj.position.set(-x, -y, -z);\n        tempobj.add(obj);\n        objparent.add(tempobj);\n      }\n\n      obj.doorState = doorstate == \"close\" ? \"open\" : \"close\";\n\n      if (info == \"left\" || info == \"right\") {\n        var sign = info == \"left\" ? 1 : -1;\n\n        if (obj.doorState == \"close\") {\n          tempobj.rotateOnAxis(new THREE.Vector3(0, 1, 0), 0.5 * sign * Math.PI);\n        } else {\n          tempobj.rotateOnAxis(new THREE.Vector3(0, 1, 0), -0.5 * sign * Math.PI);\n        }\n      } else if (info == \"outin\") {\n        //沿点击的法向量移动\n        // var intersects = this.raycaster.intersectObjects([obj]);\n        // if (intersects.length > 0) {\n        //     // 射线位置赋值给移动网格模型\n        //     tempobj.position.copy(intersects[0].point);\n        //     // 沿着法线方向平移移动的网格模型\n        //     var normal = intersects[0].face.normal;// 当前位置曲面法线\n        //     tempobj.translateOnAxis(normal,50); //平移50\n        // }\n        var targetPos = new THREE.Vector3(1, 0, 0); // var euler = new THREE.Euler( 1, 0,0);\n        // var matrix = new THREE.Matrix4();  //创建一个4维矩阵\n        // matrix.lookAt(obj.position.clone() , obj.position.clone() , targetPos) //设置朝向\n        // matrix.multiply(new THREE.Matrix4().makeRotationFromEuler(euler))\n        // var toRot = new THREE.Quaternion().setFromRotationMatrix(matrix)\n        // tempobj.translateOnAxis(toRot,50);\n\n        if (obj.doorState == \"close\") {\n          tempobj.translateOnAxis(targetPos, -obj.geometry.parameters.depth + 20);\n        } else {\n          tempobj.translateOnAxis(targetPos, obj.geometry.parameters.depth - 20);\n        } //使用四元素朝某个角度移动\n        // var targetPos = new THREE.Vector3(0,0,1)   //目标位置点\n        // var offsetAngle = Math.PI/2  //目标移动时的朝向偏移\n        // // var obj =  你的三维模型(或者其他物体对象，object3D ,group ,或者mesh对象)\n        // //以下代码在多段路径时可重复执行\n        // var matrix = new THREE.Matrix4()  //创建一个4维矩阵\n        // matrix.lookAt(obj.position.clone() , obj.position.clone() ,targetPos) //设置朝向\n        // matrix.multiply(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(0 , offsetAngle , 0 )))\n        // var toRot = new THREE.Quaternion().setFromRotationMatrix(matrix)  //计算出需要进行旋转的四元数值\n        // tempobj.translateOnAxis(toRot,50);\n        // if(obj.doorState==\"close\"){\n        //     tempobj.translateOnAxis(new THREE.Vector3(0, 0, 1),-obj.geometry.parameters.depth);\n        // }else{\n        //     tempobj.translateOnAxis(new THREE.Vector3(0, 0, 1),obj.geometry.parameters.depth);\n        // }\n\n      }\n    } //开关左门\n\n  }, {\n    key: \"openLeftDoor\",\n    value: function openLeftDoor(_obj, func) {\n      this.openCloseDoor(_obj, -_obj.geometry.parameters.width / 2, 0, 0, \"left\");\n    } //开关右门\n\n  }, {\n    key: \"openRightDoor\",\n    value: function openRightDoor(_obj, func) {\n      this.openCloseDoor(_obj, _obj.geometry.parameters.width / 2, 0, 0, \"right\");\n    } //开关机柜门\n\n  }, {\n    key: \"openCabinetDoor\",\n    value: function openCabinetDoor(_obj, func) {\n      this.openCloseDoor(_obj, _obj.geometry.parameters.width / 2, 0, _obj.geometry.parameters.depth / 2, \"right\");\n    } //拉出放回设备\n\n  }, {\n    key: \"openEquipmentDoor\",\n    value: function openEquipmentDoor(_obj, func) {\n      this.openCloseDoor(_obj, 0, 0, _obj.geometry.parameters.depth / 2, \"outin\");\n    } //鼠标移动\n\n  }, {\n    key: \"onDocumentMouseMove\",\n    value: function onDocumentMouseMove(event) {\n      var _this = this;\n\n      var currentElement = null;\n      this.mouseClick.x = event.offsetX / this.dom.offsetWidth * 2 - 1;\n      this.mouseClick.y = -(event.offsetY / this.dom.offsetHeight) * 2 + 1;\n      this.raycaster.setFromCamera(this.mouseClick, this.camera);\n      var intersects = this.raycaster.intersectObjects(this.objects);\n\n      if (intersects.length > 0) {\n        var SELECTED = intersects[0].object; // console.log(SELECTED)\n\n        if (SELECTED.name.toString().indexOf(\"equipment\") != -1 || SELECTED.name.toString().indexOf(\"spriteAlarm\") != -1) {\n          currentElement = SELECTED;\n        }\n      }\n\n      if (this.lastElement != currentElement) {\n        clearTimeout(this.tipTimer);\n\n        if (currentElement) {\n          this.tipTimer = setTimeout(function () {\n            // console.log(currentElement)\n            var tipInfo = \"\";\n\n            if (currentElement.name.toString().indexOf(\"equipment\") != -1) {\n              tipInfo = currentElement.data.tipInfo;\n              _this.tooltip.style.background = _this.tooltipBG;\n              _this.tooltip.querySelector(\"span\").style.borderTop = \"10px solid \" + _this.tooltipBG;\n            }\n\n            if (currentElement.name.toString().indexOf(\"spriteAlarm\") != -1) {\n              // console.log(currentElement)\n              tipInfo = currentElement.data.tipInfo;\n              _this.tooltip.style.background = _this.tooltipBG;\n              _this.tooltip.querySelector(\"span\").style.borderTop = \"10px solid \" + _this.tooltipBG;\n            }\n\n            var tiplen = tipInfo.length;\n            _this.tooltip.querySelector(\"#tipdiv\").innerHTML = tipInfo;\n            _this.tooltip.style.width = tiplen * 15 + \"px\";\n            _this.tooltip.style.display = 'block';\n            _this.tooltip.style.left = _this.lastEvent.pageX - _this.tooltip.clientWidth / 2 + 'px';\n            _this.tooltip.style.top = _this.lastEvent.pageY - _this.tooltip.clientHeight - 15 + 'px';\n          }, 1000);\n        }\n      } //设置上一次的网元为当前网元\n\n\n      this.lastElement = currentElement; //如果当前鼠标下没有网元，隐藏tooltip\n\n      if (currentElement == null) {\n        _this.tooltip.style.display = 'none';\n      } //设置每次移动时鼠标的事件对象\n\n\n      this.lastEvent = event;\n    } //测试\n\n  }, {\n    key: \"add\",\n    value: function add() {\n      var _this = this; //测试生成obj带材质\n      // this.createObjContainMtl()\n      //3,测点管道\n      // var points = [];\n      // points.push(new THREE.Vector3(0, 0, -10));\n      // points.push(new THREE.Vector3(0, 0, 10));\n      // var curvePath = new THREE.CatmullRomCurve3(points);\n      // var geometry = new THREE.TubeGeometry( curvePath, 20, 2, 8, false );\n      // var material = new THREE.MeshBasicMaterial( { color: 0xff0000 ,side:THREE.DoubleSide } );\n      // var mesh = new THREE.Mesh( geometry, material );\n      // this.scene.add( mesh );\n      ////自定义管道\n      // var cylinderGeo = new THREE.CylinderGeometry(4, 4 ,20 ,48,48);\n      // var cylinderMat = new THREE.MeshLambertMaterial({\n      //     color:0xffffff,\n      //     side:THREE.DoubleSide,\n      //     // map: this.createSkin(64,64,{imgurl:\"./images/rack_inside.png\"})\n      // });\n      // var cylinderMat2 = new THREE.MeshLambertMaterial({\n      //     color:0xffffff,\n      //     side:THREE.DoubleSide,\n      //     // map: this.createSkin(64,64,{imgurl:\"./images/test/camera.png\"})\n      // });\n      // var cylinder = new THREE.Mesh(cylinderGeo, cylinderMat);\n      // var cubeGeometry = new THREE.CubeGeometry(6.5, 20, 6.5, 0, 0, 1);\n      // var cube = new THREE.Mesh(cubeGeometry, cylinderMat);\n      // var pipe = this.mergeModel('+',cylinder,cube);\n      // var cylinderGeo1 = new THREE.CylinderGeometry(3.5, 3.5 ,20 ,48,48);\n      // var cylinder1 = new THREE.Mesh(cylinderGeo1, cylinderMat);\n      // pipe=this.mergeModel(\"-\",pipe,cylinder1);\n      // var cylinderGeo2 = new THREE.CylinderGeometry(2.5, 2.5 ,20 ,48,48);\n      // var cylinder2 = new THREE.Mesh(cylinderGeo2, cylinderMat2);\n      // pipe=this.mergeModel(\"+\",pipe,cylinder2);\n      // pipe.rotateX(0.5*Math.PI);\n      // this.scene.add(pipe);//网格模型添加到场景中\n      //4.测试加载模型\n      // var texture = new THREE.TextureLoader().load( './images/test/metal.png' );\n      // var texture1 = new THREE.TextureLoader().load( './images/test/camera_light.png' );\n      // var texture2 = new THREE.TextureLoader().load( './images/test/camera_dot.png' );\n      // var loader =new OBJLoader();\n      // loader.load( './images/test/camera.obj', function ( group ) {\n      //     console.log(group)\n      //     group.traverse( function ( child ) {\n      //         console.log(child)\n      //         if ( child instanceof THREE.Mesh) {\n      //             if(child.name==\"archmodels95_044_001\"){\n      //                 child.material.map = texture;\n      //             }else if(child.name==\"archmodels95_044_003\"){\n      //                 child.material.map = texture1;\n      //             }else{\n      //                 child.material.map = texture2;\n      //             }\n      //         }\n      //     });\n      //     _this.scene.add( group );\n      // })\n      //测试加载材质模型\n      // var mtlLoader = new MTLLoader();\n      // mtlLoader.load('./images/test/plant.mtl', function(materials) {\n      //     materials.preload();\n      //     console.log(materials)-\n      //     var objLoader = new OBJLoader();\n      //     objLoader.setMaterials(materials);\n      //     objLoader.load('./images/test/plant.obj', function(object) {\n      //         console.log(object)\n      //         _this.scene.add(object);\n      //     }, onProgress, onError);\n      // });\n      // var onProgress = function(xhr) {\n      //     if (xhr.lengthComputable) {\n      //         var percentComplete = xhr.loaded / xhr.total * 100;\n      //         console.log(Math.round(percentComplete, 2) + '% 已经加载')\n      //     }\n      // }\n      // var onError =function(){}\n      //1、测试ThreeBSP用的\n      //几何体对象\n      // let cylinder = new THREE.CylinderGeometry(50,50,5,40);//圆柱\n      // let box = new THREE.BoxGeometry(40,5,40);//立方体\n      // //材质对象\n      // let material=new THREE.MeshPhongMaterial({color:0x0000ff});\n      // //网格模型对象\n      // let cylinderMesh=new THREE.Mesh(cylinder,material);//圆柱\n      // let boxMesh=new THREE.Mesh(box,material);//立方体\n      // //包装成ThreeBSP对象\n      // let cylinderBSP = new ThreeBSP(cylinderMesh);\n      // let boxBSP = new ThreeBSP(boxMesh);\n      // let result = cylinderBSP.subtract(boxBSP);\n      // //ThreeBSP对象转化为网格模型对象\n      // let mesh = result.toMesh();\n      // this.scene.add(mesh);//网格模型添加到场景中\n      // //2、试圆柱体贴图\n      // //创建圆柱体\n      // var cylinderGeo = new THREE.CylinderGeometry(28, 30 ,200 ,48,48);\n      // cylinderGeo.computeBoundingBox();\n      // var max = cylinderGeo.boundingBox.max,\n      //         min = cylinderGeo.boundingBox.min;\n      //         console.log(cylinderGeo)\n      //         console.log(max)\n      //         console.log(min)\n      // var offset = new THREE.Vector2(0 - min.x, 0 - min.y);\n      // var range = new THREE.Vector2(max.x - min.x, max.y - min.y);\n      // var faces = cylinderGeo.faces;\n      // cylinderGeo.faceVertexUvs[0] = [];\n      // for (var i = 0; i < faces.length ; i++) {\n      //     var v1 = cylinderGeo.vertices[faces[i].a],\n      //             v2 = cylinderGeo.vertices[faces[i].b],\n      //             v3 = cylinderGeo.vertices[faces[i].c];\n      //     cylinderGeo.faceVertexUvs[0].push([\n      //         new THREE.Vector2((v1.x + offset.x) / range.x, (v1.y + offset.y) / range.y),\n      //         new THREE.Vector2((v2.x + offset.x) / range.x, (v2.y + offset.y) / range.y),\n      //         new THREE.Vector2((v3.x + offset.x) / range.x, (v3.y + offset.y) / range.y)\n      //     ]);\n      // }\n      // cylinderGeo.uvsNeedUpdate = true;\n      // console.log(cylinderGeo)\n      // var cylinderMat = new THREE.MeshLambertMaterial({//创建材料\n      //     color:0xffffff,\n      //     wireframe:false,\n      //     opacity: 0.1,\n      //     map: this.createSkin(60,200,{imgurl:\"./images/aircondition.png\"})\n      // });\n      // //创建圆柱体网格模型\n      // var cylinder = new THREE.Mesh(cylinderGeo, cylinderMat);\n      // this.scene.add(cylinder);//网格模型添加到场景中\n\n    } //测试自己生成obj文件带mtl材质的\n\n  }, {\n    key: \"createObjContainMtl\",\n    value: function createObjContainMtl() {\n      //如果obj文件没有包含材质关联的时候，自己生成带材质的关联obj文件\n      var _this = this;\n\n      var leaftexture = new THREE.TextureLoader().load('./images/plant/Archmodels66_leaf_33.jpg');\n      var soiltexture = new THREE.TextureLoader().load('./images/plant/Archmodels66_dirt_1.jpg');\n      var barktexture = new THREE.TextureLoader().load('./images/plant/Archmodels66_bark_1.jpg');\n      var jardinieretexture = new THREE.TextureLoader().load('./images/plant/Archmodels66_jardiniere.jpg');\n      var objLoader = new OBJLoader();\n      objLoader.load(\"./images/plant/plant.obj\", function (object) {\n        object.traverse(function (child) {\n          if (child instanceof THREE.Mesh) {\n            child.material = new THREE.MeshBasicMaterial({\n              color: 0xffffff\n            });\n\n            if (child.name == \"3DXY_geometry_769\" || child.name == \"3DXY_geometry_773\") {\n              child.material.name = \"wire_153228214\";\n              child.material.map = leaftexture;\n            } else if (child.name == \"3DXY_geometry_772\" || child.name == \"3DXY_geometry_776\" || child.name == \"3DXY_geometry_777\" || child.name == \"3DXY_geometry_778\") {\n              child.material.name = \"wire_108008136\";\n              child.material.map = barktexture;\n            } else if (child.name == \"3DXY_geometry_774\" || child.name == \"3DXY_geometry_775\") {\n              child.material.name = \"wire_177148027\";\n              child.material.map = soiltexture;\n            } else if (child.name == \"3DXY_geometry_770\") {\n              child.material.name = \"wire_198225087\";\n              child.material.map = jardinieretexture;\n            }\n          }\n        }); // _this.scene.add(object)\n\n        var objExporter = new OBJExporter();\n        var output = objExporter.parse(object);\n        var link = document.createElement('a');\n        link.style.display = 'none';\n        document.body.appendChild(link);\n        link.href = URL.createObjectURL(new Blob([output], {\n          type: 'text/plain'\n        }));\n        link.download = \"object.obj\";\n        link.click(); //然后自己制作mtl文件就可以了\n      }, this.onProgress, this.onError);\n    } //测试GLTF文件\n\n  }, {\n    key: \"exportGLTF\",\n    value: function exportGLTF() {\n      var box = new THREE.BoxGeometry(40, 5, 40);\n      var material = new THREE.MeshPhongMaterial({\n        color: 0x0000ff\n      });\n      var obj = new THREE.Mesh(box, material); //立方体\n      // 单个模型数据 GLTF导出\n\n      var gltfExporter = new GLTFExporter();\n      gltfExporter.parse(obj, function (result) {\n        console.log(result);\n        var output = JSON.stringify(result, null, 2);\n        var link = document.createElement('a');\n        link.style.display = 'none';\n        document.body.appendChild(link);\n        link.href = URL.createObjectURL(new Blob([output], {\n          type: 'text/plain'\n        }));\n        link.download = \"object.gltf\";\n        link.click();\n      }); //加载GLTF\n\n      var _this = this;\n\n      var loader = new GLTFLoader();\n      loader.load('./images/test/object.gltf', function (gltf) {\n        console.log('控制台查看加载gltf文件返回的对象结构', gltf);\n        console.log('gltf对象场景属性', gltf.scene);\n        console.log('gltf对象相机属性', gltf.cameras);\n\n        _this.scene.add(gltf.scene);\n      });\n    } //测试OBJ文件\n\n  }, {\n    key: \"exportOBJ\",\n    value: function exportOBJ() {\n      var box = new THREE.BoxGeometry(40, 5, 40);\n      var material = new THREE.MeshPhongMaterial({\n        color: 0x0000ff\n      });\n      var obj = new THREE.Mesh(box, material); //立方体\n      // 单个模型数据 OBJ导出\n\n      var objExporter = new OBJExporter();\n      var output = objExporter.parse(obj);\n      var link = document.createElement('a');\n      link.style.display = 'none';\n      document.body.appendChild(link);\n      link.href = URL.createObjectURL(new Blob([output], {\n        type: 'text/plain'\n      }));\n      link.download = \"object.obj\";\n      link.click(); //加载OBJ\n\n      var _this = this;\n\n      var loader = new OBJLoader();\n      var loader2 = new OBJLoader2();\n      loader.load('./images/test/object.obj', function (obj) {\n        console.log(obj);\n\n        _this.scene.add(obj);\n      }); // loader2.load( './images/test/object.obj', function ( obj ) {\n      //     _this.scene.add( obj );\n      // })\n    }\n    /* 创建字体精灵 */\n\n  }, {\n    key: \"makeTextSprite\",\n    value: function makeTextSprite(message, parameters) {\n      if (parameters === undefined) parameters = {};\n      var fontface = parameters.hasOwnProperty(\"fontface\") ? parameters[\"fontface\"] : \"Arial\";\n      /* 字体大小 */\n\n      var fontsize = parameters.hasOwnProperty(\"fontsize\") ? parameters[\"fontsize\"] : 20;\n      /* 边框厚度 */\n\n      var borderThickness = parameters.hasOwnProperty(\"borderThickness\") ? parameters[\"borderThickness\"] : 4;\n      /* 边框颜色 */\n\n      var borderColor = parameters.hasOwnProperty(\"borderColor\") ? parameters[\"borderColor\"] : {\n        r: 0,\n        g: 0,\n        b: 0,\n        a: 1.0\n      };\n      /* 背景颜色 */\n\n      var backgroundColor = parameters.hasOwnProperty(\"backgroundColor\") ? parameters[\"backgroundColor\"] : {\n        r: 255,\n        g: 255,\n        b: 255,\n        a: 1.0\n      };\n      /* 创建画布 */\n\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      /* 字体加粗 */\n\n      context.font = fontsize + \"px \" + fontface;\n      /* 获取文字的大小数据，高度取决于文字的大小 */\n\n      var metrics = context.measureText(message);\n      var textWidth = metrics.width;\n      /* 背景颜色 */\n\n      context.fillStyle = \"rgba(\" + backgroundColor.r + \",\" + backgroundColor.g + \",\" + backgroundColor.b + \",\" + backgroundColor.a + \")\";\n      /* 边框的颜色 */\n\n      context.strokeStyle = \"rgba(\" + borderColor.r + \",\" + borderColor.g + \",\" + borderColor.b + \",\" + borderColor.a + \")\";\n      context.lineWidth = borderThickness;\n      /* 绘制圆角矩形 */\n\n      this.roundRect(context, borderThickness / 2, borderThickness / 2, textWidth + borderThickness, fontsize * 1.4 + borderThickness, 6);\n      /* 字体颜色 */\n\n      context.fillStyle = \"rgba(0, 0, 0, 1.0)\";\n      context.fillText(message, borderThickness, fontsize + borderThickness);\n      /* 画布内容用于纹理贴图 */\n\n      var texture = new THREE.Texture(canvas);\n      texture.needsUpdate = true;\n      var spriteMaterial = new THREE.SpriteMaterial({\n        map: texture\n      });\n      var sprite = new THREE.Sprite(spriteMaterial);\n      /* 缩放比例 */\n\n      sprite.scale.set(10, 5, 0);\n      return sprite;\n    }\n  }, {\n    key: \"createSprite\",\n    value: function createSprite(obj) {\n      var sprite = this.makeTextSprite(' 温度：' + 12 + '℃ 湿度：' + 12 % +' ');\n      sprite.position.set(obj.x + 50, obj.y + 24, obj.z - 20);\n      sprite.scale.set(300, 100, 1); // 控制精灵大小，比如可视化中精灵大小表征数据大小 只需要设置x、y两个分量就可以\n\n      sprite.data = obj.data; //告警等级默认给1，给最低告警\n\n      sprite.name = \"spriteAlarm\";\n      sprite.visible = true;\n      console.log(sprite);\n      this.addObject(sprite);\n      this.sprite.push(sprite);\n    }\n    /* 绘制圆角矩形 */\n\n  }, {\n    key: \"roundRect\",\n    value: function roundRect(ctx, x, y, w, h, r) {\n      ctx.beginPath();\n      ctx.moveTo(x + r, y);\n      ctx.lineTo(x + w - r, y);\n      ctx.quadraticCurveTo(x + w, y, x + w, y + r);\n      ctx.lineTo(x + w, y + h - r);\n      ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n      ctx.lineTo(x + r, y + h);\n      ctx.quadraticCurveTo(x, y + h, x, y + h - r);\n      ctx.lineTo(x, y + r);\n      ctx.quadraticCurveTo(x, y, x + r, y);\n      ctx.closePath();\n      ctx.fill();\n      ctx.stroke();\n    }\n  }]);\n\n  return ThreeMap;\n}();\n\nexport { ThreeMap as default };",{"version":3,"sources":["D:/zhou/Documents/github/threeMachineRoom/src/views/ThreeMap.js"],"names":["THREE","GLTFLoader","GLTFExporter","OBJLoader","OBJLoader2","OBJExporter","MTLLoader","TWEEN","OrbitControls","ThreeMap","props","dataJson","xhr","lengthComputable","percentComplete","loaded","total","_this","hasObj","obj","findObject","objname","findedobj","objects","forEach","index","name","getPath","file","BASE_PATH","guid","guidRandom","Math","random","toString","substring","ThreeData","objList","eventList","events","btnList","btns","alarmColor","Object","assign","level1","level2","level3","level4","level5","renderer","scene","camera","equipment","sprite","cabinet","dom","document","getElementById","domID","dbclick","mouseClick","Vector2","raycaster","Raycaster","lastElement","tipTimer","tooltip","lastEvent","tooltipBG","progressSuccess","loadtimer","initRenderer","initScene","initCamera","initLight","render","setControl","InitData","domElement","addEventListener","onDocumentMouseDown","bind","onDocumentMouseMove","WebGLRenderer","antialias","setSize","offsetWidth","offsetHeight","appendChild","PerspectiveCamera","position","set","lookAt","x","y","z","add","Scene","background","Color","light","AmbientLight","light2","PointLight","shadow","near","far","castShadow","animate","requestAnimationFrame","axesHelper","AxisHelper","controls","update","length","i","InitAddObject","createText","width","depth","InitTooltip","removeChild","map","init","div","createElement","setAttribute","style","display","left","top","height","fontSize","zIndex","loading","innerHTML","textAlign","load","querySelector","clearTimeout","setTimeout","LoadSuccess","color","maxWidth","lineHeight","padding","opacity","tipdiv","tipspan","marginLeft","bottom","borderTop","borderLeft","borderRight","count","step","button","btnimg","img","commonFunc","btnTitle","onclick","clickFunction","show","tempObj","objType","createCube","addObject","createObjDesk","CreateWall","createEmptyCabinet","createSprite","createObjPlant","createObjChair","createObjAnnihilator","createObjCamera","commonDepth","commonHeight","commonWidth","commonSkin","skinColor","wallData","wallobj","wallWidth","wallDepth","positionX","startDot","endDot","positionY","positionZ","abs","cubeobj","rotation","uuid","skin","cube","childrens","walchildobj","newobj","CreateHole","mergeModel","op","mergeOP","fobj","sobj","fobjBSP","ThreeBSP","sobjBSP","resultBSP","subtract","subMesh","Mesh","updateMatrix","geometry","merge","matrix","intersect","cubeMaterialArray","push","MeshLambertMaterial","vertexColors","FaceColors","result","toMesh","material","shading","FlatShading","computeFaceNormals","computeVertexNormals","needsUpdate","buffersNeedUpdate","uvsNeedUpdate","faces","faceset","j","vertexNormals","setHex","materialIndex","receiveShadow","hasOwnProperty","cubeGeometry","CubeGeometry","skin_up_obj","skin_down_obj","skin_fore_obj","skin_behind_obj","skin_left_obj","skin_right_obj","skin_opacity","skin_right","skin_left","skin_up","skin_down","skin_fore","skin_behind","createSkinOption","rotation_obj","direction","rotateX","degree","rotateY","rotateZ","rotateOnAxis","Vector3","Cabinet","floorHeight","upobj","size","thick","upcube","leftobj","leftcube","rightobj","rightcube","tempobj","Object3D","data","alarmInfo","downobj","downcube","behindobj","behindcube","doors","skins","doorname","doorobj","doorcube","tipInfo","canvas","context","getContext","beginPath","rect","fillStyle","fill","marker","text","font","textBaseline","strokeStyle","fillText","alarmobj","imgurl","transparent","PI","createPlaneGeometry","equipmentUUID","service","serviceuuid","radiusTop","radiusBottom","radiusSegments","heightSegments","openEnded","cylinderGeo","CylinderGeometry","cylinderMat","wireframe","cylinder","childobj","createCylinderPlant","texture","loader","TextureLoader","indexOf","undefined","CanvasTexture","MaterParam","side","DoubleSide","blending","AdditiveBlending","plane","PlaneGeometry","MeshBasicMaterial","mtlLoader","materials","preload","objLoader","console","log","setMaterials","object","clone","objHandle","handleObj","onProgress","onError","ratio","scale","handleScale","handleRotale","info","cubeColor","cubefacenub","imgUrl","createSkin","imgwidth","imgheight","repeat","repeatx","wrapS","RepeatWrapping","repeaty","wrapT","floorWidth","text2","lineWidth","strokeText","arr","devid","pointid","m","cabinetUUID","changeCabinetAlarmObj","spriteIndex","equipmentIndex","isalarm","Number","level","flag","splice","visible","alarmPlay","levelArr","max","utterThis","window","SpeechSynthesisUtterance","lang","pitch","rate","volume","speechSynthesis","speak","event","preventDefault","offsetX","offsetY","setFromCamera","intersects","intersectObjects","enabled","SELECTED","_obj","obj_name","obj_event","doorstate","doorState","parent","objparent","sign","targetPos","translateOnAxis","parameters","func","openCloseDoor","currentElement","tiplen","pageX","clientWidth","pageY","clientHeight","leaftexture","soiltexture","barktexture","jardinieretexture","traverse","child","objExporter","output","parse","link","body","href","URL","createObjectURL","Blob","type","download","click","box","BoxGeometry","MeshPhongMaterial","gltfExporter","JSON","stringify","gltf","cameras","loader2","message","fontface","fontsize","borderThickness","borderColor","r","g","b","a","backgroundColor","metrics","measureText","textWidth","roundRect","Texture","spriteMaterial","SpriteMaterial","Sprite","makeTextSprite","ctx","w","h","moveTo","lineTo","quadraticCurveTo","closePath","stroke"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAO,qCAAP;AACA,SAASC,UAAT,QAA2B,uCAA3B;AACA,SAASC,YAAT,QAA6B,2CAA7B;AACA,SAASC,SAAT,QAA0B,sCAA1B;AACA,SAAQC,UAAR,QAA0B,uCAA1B;AACA,SAASC,WAAT,QAA4B,0CAA5B;AACA,SAASC,SAAT,QAA0B,sCAA1B;AACA,OAAOC,KAAP,MAAkB,mBAAlB;AACA,SAASC,aAAT,QAA8B,8CAA9B,C,CAA+E;AAC/E;;IACqBC,Q;AACjB,oBAAYC,KAAZ,EAAkBC,QAAlB,EAA4B;AAAA;;AAAA,wCAymCf,UAAWC,GAAX,EAAgB;AACzB,UAAKA,GAAG,CAACC,gBAAT,EAA4B;AACxB,YAAIC,eAAe,GAAGF,GAAG,CAACG,MAAJ,GAAaH,GAAG,CAACI,KAAjB,GAAyB,GAA/C,CADwB,CAExB;AACH;AACJ,KA9mC2B;;AAAA,qCAgnClB,UAAWJ,GAAX,EAAiB,CAAG,CAhnCF;;AAAA,wCA4zCjB;AACPK,MAAAA,KAAK,EAAC,IADC;AAEP;AACAC,MAAAA,MAAM,EAAE,gBAAUC,GAAV,EAAe;AACnB,YAAIA,GAAG,IAAI,IAAP,IAAe,OAAQA,GAAR,IAAgB,WAAnC,EAAgD;AAC5C,iBAAO,IAAP;AACH,SAFD,MAEK;AACD,iBAAO,KAAP;AACH;AACJ,OATM;AAUP;AACAC,MAAAA,UAAU,EAAE,oBAAUC,OAAV,EAAmB;AAC3B,YAAIC,SAAS,GAAG,IAAhB;AACA,aAAKC,OAAL,CAAaC,OAAb,CAAqB,UAASL,GAAT,EAAcM,KAAd,EAAoB;AACrC,cAAIN,GAAG,CAACO,IAAJ,IAAY,IAAZ,IAAoBP,GAAG,CAACO,IAAJ,IAAY,EAAhC,IAAsCP,GAAG,CAACO,IAAJ,IAAYL,OAAtD,EAA+D;AAC3DC,YAAAA,SAAS,GAAGH,GAAZ;AACA,mBAAOG,SAAP;AACH;AACJ,SALD;AAMA,eAAOA,SAAP;AACH,OApBM;AAqBP;AACAK,MAAAA,OAAO,EAAE,iBAASC,IAAT,EAAc;AACnB,eAAO,KAAKX,KAAL,CAAWY,SAAX,GAAqBD,IAA5B;AACH,OAxBM;AAyBP;AACAE,MAAAA,IAAI,EAAC,gBAAU;AACX,eAAQ,KAAKC,UAAL,KAAkB,KAAKA,UAAL,EAAlB,GAAoC,GAApC,GAAwC,KAAKA,UAAL,EAAxC,GAA0D,GAA1D,GAA8D,KAAKA,UAAL,EAA9D,GAAgF,GAAhF,GAAoF,KAAKA,UAAL,EAApF,GAAsG,GAAtG,GAA0G,KAAKA,UAAL,EAA1G,GAA4H,KAAKA,UAAL,EAA5H,GAA8I,KAAKA,UAAL,EAAtJ;AACH,OA5BM;AA6BPA,MAAAA,UA7BO,wBA6BM;AACT,eAAO,CAAE,CAAC,IAAEC,IAAI,CAACC,MAAL,EAAH,IAAkB,OAAnB,GAA4B,CAA7B,EAAgCC,QAAhC,CAAyC,EAAzC,EAA6CC,SAA7C,CAAuD,CAAvD,CAAP;AACH;AA/BM,KA5zCiB;;AAExB,SAAKzB,KAAL,GAAWA,KAAX;AACA,SAAK0B,SAAL,GAAezB,QAAf;AACA,SAAKA,QAAL,GAAcA,QAAd;AACA,SAAK0B,OAAL,GAAe1B,QAAQ,CAACY,OAAT,IAAkB,EAAjC,CALwB,CAKY;;AACpC,SAAKe,SAAL,GAAiB3B,QAAQ,CAAC4B,MAAT,IAAiB,EAAlC,CANwB,CAMa;;AACrC,SAAKC,OAAL,GAAe7B,QAAQ,CAAC8B,IAAT,IAAe,EAA9B,CAPwB,CAOS;;AACjC,SAAKC,UAAL,GAAgBC,MAAM,CAACC,MAAP,CAAc;AAC1BC,MAAAA,MAAM,EAAC,SADmB;AAE1BC,MAAAA,MAAM,EAAC,SAFmB;AAG1BC,MAAAA,MAAM,EAAC,SAHmB;AAI1BC,MAAAA,MAAM,EAAC,SAJmB;AAK1BC,MAAAA,MAAM,EAAC;AALmB,KAAd,EAMdtC,QAAQ,CAAC+B,UANK,CAAhB;AAQA,SAAKQ,QAAL,GAAc,IAAd;AACA,SAAKC,KAAL,GAAa,IAAb,CAjBwB,CAiBN;;AAClB,SAAKC,MAAL,GAAY,IAAZ;AACA,SAAK7B,OAAL,GAAe,EAAf,CAnBwB,CAmBJ;;AACpB,SAAK8B,SAAL,GAAe,EAAf,CApBwB,CAoBJ;;AACpB,SAAKC,MAAL,GAAY,EAAZ,CArBwB,CAqBP;;AACjB,SAAKC,OAAL,GAAa,EAAb,CAtBwB,CAsBN;;AAClB,SAAKC,GAAL,GAASC,QAAQ,CAACC,cAAT,CAAwB,KAAKhD,KAAL,CAAWiD,KAAnC,CAAT;AACA,SAAKC,OAAL,GAAe,CAAf;AACA,SAAKC,UAAL,GAAkB,IAAI7D,KAAK,CAAC8D,OAAV,EAAlB;AACA,SAAKC,SAAL,GAAiB,IAAI/D,KAAK,CAACgE,SAAV,EAAjB;AACA,SAAKC,WAAL,GAAiB,IAAjB,CA3BwB,CA2BA;;AACxB,SAAKC,QAAL,GAAc,IAAd,CA5BwB,CA4BJ;;AACpB,SAAKC,OAAL,GAAa,IAAb;AACA,SAAKC,SAAL,GAAe,IAAf;AACA,SAAKC,SAAL,GAAe,SAAf;AAEA,SAAKC,eAAL,GAAqB,CAArB;AACA,SAAKC,SAAL,GAAe,IAAf;AACA,SAAK1C,SAAL,GAAe,WAAf;AACH;;;;WAED,gBAAO;AACH,WAAK2C,YAAL;AACA,WAAKC,SAAL;AACA,WAAKC,UAAL;AACA,WAAKC,SAAL;AACA,WAAKC,MAAL,GALG,CAMH;;AACA,WAAKC,UAAL,GAPG,CAQH;;AACA,WAAKC,QAAL,GATG,CASe;;AAClB,WAAK5B,QAAL,CAAc6B,UAAd,CAAyBC,gBAAzB,CAA0C,WAA1C,EAAuD,KAAKC,mBAAL,CAAyBC,IAAzB,CAA8B,IAA9B,CAAvD,EAA4F,KAA5F;AACA,WAAKhC,QAAL,CAAc6B,UAAd,CAAyBC,gBAAzB,CAA0C,WAA1C,EAAsD,KAAKG,mBAAL,CAAyBD,IAAzB,CAA8B,IAA9B,CAAtD,EAA2F,KAA3F;AACH,K,CAED;;;;WACA,wBAAe;AACX,WAAKhC,QAAL,GAAgB,IAAIlD,KAAK,CAACoF,aAAV,CAAwB;AAAEC,QAAAA,SAAS,EAAE;AAAb,OAAxB,CAAhB;AACA,WAAKnC,QAAL,CAAcoC,OAAd,CAAsB,KAAK9B,GAAL,CAAS+B,WAA/B,EAA2C,KAAK/B,GAAL,CAASgC,YAApD;AACA,WAAKhC,GAAL,CAASiC,WAAT,CAAqB,KAAKvC,QAAL,CAAc6B,UAAnC;AACH,K,CACD;;;;WACA,sBAAa;AACT,WAAK3B,MAAL,GAAc,IAAIpD,KAAK,CAAC0F,iBAAV,CAA4B,EAA5B,EAAgC,KAAKlC,GAAL,CAAS+B,WAAT,GAAuB,KAAK/B,GAAL,CAASgC,YAAhE,EAA8E,CAA9E,EAAiF,MAAjF,CAAd;AACA,WAAKpC,MAAL,CAAY1B,IAAZ,GAAmB,YAAnB;AACA,WAAK0B,MAAL,CAAYuC,QAAZ,CAAqBC,GAArB,CAAyB,CAAzB,EAA2B,IAA3B,EAAgC,IAAhC,EAHS,CAIT;AACA;AACA;AACA;;AACA,WAAKxC,MAAL,CAAYyC,MAAZ,CAAmB;AAAEC,QAAAA,CAAC,EAAE,CAAL;AAAQC,QAAAA,CAAC,EAAE,CAAX;AAAcC,QAAAA,CAAC,EAAE;AAAjB,OAAnB;AACA,WAAK7C,KAAL,CAAW8C,GAAX,CAAe,KAAK7C,MAApB;AACH,K,CACD;;;;WACA,qBAAY;AACR,WAAKD,KAAL,GAAa,IAAInD,KAAK,CAACkG,KAAV,EAAb;AACA,WAAK/C,KAAL,CAAWgD,UAAX,GAAwB,IAAInG,KAAK,CAACoG,KAAV,CAAgB,QAAhB,CAAxB;AACH,K,CACD;;;;WACA,qBAAW;AACP,UAAIC,KAAK,GAAG,IAAIrG,KAAK,CAACsG,YAAV,CAAuB,QAAvB,CAAZ;AACAD,MAAAA,KAAK,CAACV,QAAN,CAAeC,GAAf,CAAmB,CAAnB,EAAsB,CAAtB,EAAwB,CAAxB;AACA,WAAKzC,KAAL,CAAW8C,GAAX,CAAeI,KAAf;AACA,UAAIE,MAAM,GAAG,IAAIvG,KAAK,CAACwG,UAAV,CAAqB,QAArB,CAAb;AACAD,MAAAA,MAAM,CAACE,MAAP,CAAcrD,MAAd,CAAqBsD,IAArB,GAA2B,CAA3B;AACAH,MAAAA,MAAM,CAACE,MAAP,CAAcrD,MAAd,CAAqBuD,GAArB,GAA2B,IAA3B;AACAJ,MAAAA,MAAM,CAACZ,QAAP,CAAgBC,GAAhB,CAAoB,CAApB,EAAuB,GAAvB,EAA4B,CAA5B;AACAW,MAAAA,MAAM,CAACK,UAAP,GAAoB,IAApB,CARO,CAQkB;;AACzB,WAAKzD,KAAL,CAAW8C,GAAX,CAAeM,MAAf;AACH,K,CACD;;;;WACA,kBAAS;AACL,WAAKM,OAAL;AACH;;;WACD,mBAAU;AACNC,MAAAA,qBAAqB,CAAC,KAAKlC,MAAL,CAAYM,IAAZ,CAAiB,IAAjB,CAAD,CAArB;AACA,WAAKhC,QAAL,CAAc0B,MAAd,CAAqB,KAAKzB,KAA1B,EAAiC,KAAKC,MAAtC;AACH;;;WACD,qBAAY;AACR;AACA,UAAM2D,UAAU,GAAG,IAAI/G,KAAK,CAACgH,UAAV,CAAqB,CAArB,CAAnB;AACA,WAAK7D,KAAL,CAAW8C,GAAX,CAAec,UAAf;AACH,K,CACD;;;;WACA,sBAAa;AACT,WAAKE,QAAL,GAAgB,IAAIzG,aAAJ,CAAkB,KAAK4C,MAAvB,EAA8B,KAAKI,GAAnC,CAAhB;AACA,WAAKyD,QAAL,CAAcC,MAAd;AACH;;;WACD,oBAAU;AACN;AACA,UAAG,KAAK7E,OAAL,CAAa8E,MAAb,GAAoB,CAAvB,EAAyB;AACrB,aAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAK/E,OAAL,CAAa8E,MAA3B,EAAkCC,CAAC,EAAnC,EAAsC;AAClC,eAAKC,aAAL,CAAmB,KAAKhF,OAAL,CAAa+E,CAAb,CAAnB;AACH;AACJ,OANK,CAON;AACA;AACA;;;AACA,WAAKE,UAAL,CAAgB,KAAKjF,OAAL,CAAa,CAAb,EAAgBkF,KAAhC,EAAsC,KAAKlF,OAAL,CAAa,CAAb,EAAgBmF,KAAtD;AACA,WAAKC,WAAL,GAXM,CAYN;AACH,K,CACD;;;;WACA,qBAAW;AACP,WAAKjE,GAAL,CAASkE,WAAT,CAAqB,KAAKxE,QAAL,CAAc6B,UAAnC;AACA,UAAI4C,GAAG,GAAG,IAAIlH,QAAJ,CAAa,KAAKC,KAAlB,EAAwB,KAAK0B,SAA7B,CAAV;AACAuF,MAAAA,GAAG,CAACC,IAAJ;AACH;;;WACD,mBAAS;AACL,UAAIC,GAAG,GAAGpE,QAAQ,CAACqE,aAAT,CAAuB,KAAvB,CAAV;AACND,MAAAA,GAAG,CAACE,YAAJ,CAAiB,IAAjB,EAAuB,SAAvB;AACAF,MAAAA,GAAG,CAACG,KAAJ,CAAUC,OAAV,GAAoB,OAApB;AACAJ,MAAAA,GAAG,CAACG,KAAJ,CAAUrC,QAAV,GAAqB,UAArB;AACAkC,MAAAA,GAAG,CAACG,KAAJ,CAAUE,IAAV,GAAiB,GAAjB;AACAL,MAAAA,GAAG,CAACG,KAAJ,CAAUG,GAAV,GAAgB,GAAhB;AACAN,MAAAA,GAAG,CAACG,KAAJ,CAAUT,KAAV,GAAkB,MAAlB;AACMM,MAAAA,GAAG,CAACG,KAAJ,CAAUI,MAAV,GAAmB,MAAnB;AACAP,MAAAA,GAAG,CAACG,KAAJ,CAAUK,QAAV,GAAmB,MAAnB;AACAR,MAAAA,GAAG,CAACG,KAAJ,CAAUM,MAAV,GAAiB,KAAjB;AACAT,MAAAA,GAAG,CAACG,KAAJ,CAAU7B,UAAV,GAAuB,kBAAvB;AACA,UAAIoC,OAAO,GAAC9E,QAAQ,CAACqE,aAAT,CAAuB,KAAvB,CAAZ;AACAS,MAAAA,OAAO,CAACC,SAAR,GAAkB,UAAlB;AACAD,MAAAA,OAAO,CAACP,KAAR,CAAcG,GAAd,GAAkB,KAAlB;AACAI,MAAAA,OAAO,CAACP,KAAR,CAAcrC,QAAd,GAAuB,UAAvB;AACA4C,MAAAA,OAAO,CAACP,KAAR,CAAcT,KAAd,GAAoB,MAApB;AACAgB,MAAAA,OAAO,CAACP,KAAR,CAAcS,SAAd,GAAwB,QAAxB;AACAZ,MAAAA,GAAG,CAACpC,WAAJ,CAAgB8C,OAAhB;AACN,WAAK/E,GAAL,CAASiC,WAAT,CAAqBoC,GAArB;AACG;;;WACD,uBAAa;AACT,UAAI5G,KAAK,GAAC,IAAV;;AACA,UAAG,KAAKqD,eAAL,IAAsB,CAAzB,EAA2B;AACvB,YAAIoE,IAAI,GAAC,KAAKlF,GAAL,CAASmF,aAAT,CAAuB,UAAvB,CAAT;AACAD,QAAAA,IAAI,CAACV,KAAL,CAAWC,OAAX,GAAmB,MAAnB;AACAW,QAAAA,YAAY,CAAC,KAAKrE,SAAN,CAAZ;AACH,OAJD,MAIK;AACD,aAAKA,SAAL,GAAiBsE,UAAU,CAAC,YAAU;AAClC5H,UAAAA,KAAK,CAAC6H,WAAN;AACH,SAF0B,EAEzB,IAFyB,CAA3B;AAGH;AACJ,K,CACD;;;;WACA,uBAAa;AACT,WAAK3E,OAAL,GAAeV,QAAQ,CAACqE,aAAT,CAAuB,KAAvB,CAAf;AACN,WAAK3D,OAAL,CAAa4D,YAAb,CAA0B,IAA1B,EAAgC,SAAhC;AACA,WAAK5D,OAAL,CAAa6D,KAAb,CAAmBC,OAAnB,GAA6B,MAA7B;AACM,WAAK9D,OAAL,CAAa6D,KAAb,CAAmBrC,QAAnB,GAA8B,UAA9B;AACA,WAAKxB,OAAL,CAAa6D,KAAb,CAAmBe,KAAnB,GAAyB,MAAzB;AACA,WAAK5E,OAAL,CAAa6D,KAAb,CAAmBgB,QAAnB,GAA4B,OAA5B;AACN,WAAK7E,OAAL,CAAa6D,KAAb,CAAmBT,KAAnB,GAA2B,MAA3B;AACM,WAAKpD,OAAL,CAAa6D,KAAb,CAAmBI,MAAnB,GAA4B,MAA5B;AACA,WAAKjE,OAAL,CAAa6D,KAAb,CAAmBiB,UAAnB,GAA8B,MAA9B;AACA,WAAK9E,OAAL,CAAa6D,KAAb,CAAmBS,SAAnB,GAA6B,QAA7B;AACA,WAAKtE,OAAL,CAAa6D,KAAb,CAAmBkB,OAAnB,GAA2B,MAA3B;AACA,WAAK/E,OAAL,CAAa6D,KAAb,CAAmB7B,UAAnB,GAAgC,KAAK9B,SAArC;AACA,WAAKF,OAAL,CAAa6D,KAAb,CAAmBmB,OAAnB,GAA2B,GAA3B;AACA,WAAKhF,OAAL,CAAa6D,KAAb,CAAmB,eAAnB,IAAsC,KAAtC;AACA,UAAIoB,MAAM,GAAC3F,QAAQ,CAACqE,aAAT,CAAuB,KAAvB,CAAX;AACAsB,MAAAA,MAAM,CAACrB,YAAP,CAAoB,IAApB,EAAyB,QAAzB;AACA,UAAIsB,OAAO,GAAC5F,QAAQ,CAACqE,aAAT,CAAuB,MAAvB,CAAZ;AACAuB,MAAAA,OAAO,CAACrB,KAAR,CAAcsB,UAAd,GAAyB,KAAzB;AACAD,MAAAA,OAAO,CAACrB,KAAR,CAAcuB,MAAd,GAAqB,OAArB;AACAF,MAAAA,OAAO,CAACrB,KAAR,CAAcE,IAAd,GAAmB,OAAnB;AACAmB,MAAAA,OAAO,CAACrB,KAAR,CAAcrC,QAAd,GAAuB,UAAvB;AACA0D,MAAAA,OAAO,CAACrB,KAAR,CAAcwB,SAAd,GAAwB,gBAAc,KAAKnF,SAA3C;AACAgF,MAAAA,OAAO,CAACrB,KAAR,CAAcyB,UAAd,GAAyB,wBAAzB;AACAJ,MAAAA,OAAO,CAACrB,KAAR,CAAc0B,WAAd,GAA0B,wBAA1B;AACA,WAAKvF,OAAL,CAAasB,WAAb,CAAyB4D,OAAzB;AACA,WAAKlF,OAAL,CAAasB,WAAb,CAAyB2D,MAAzB;AACA,WAAK5F,GAAL,CAASiC,WAAT,CAAqB,KAAKtB,OAA1B;AACH,K,CACD;;;;WACA,mBAAS;AACL,UAAIlD,KAAK,GAAC,IAAV;;AACA,UAAI0I,KAAK,GAAG,KAAKnH,OAAL,CAAa2E,MAAzB;AACN,UAAIyC,IAAI,GAAG,EAAX;AAEA,UAAI/B,GAAG,GAAGpE,QAAQ,CAACqE,aAAT,CAAuB,KAAvB,CAAV;AACAD,MAAAA,GAAG,CAACE,YAAJ,CAAiB,IAAjB,EAAuB,SAAvB;AACAF,MAAAA,GAAG,CAACG,KAAJ,CAAUC,OAAV,GAAoB,OAApB;AACAJ,MAAAA,GAAG,CAACG,KAAJ,CAAUrC,QAAV,GAAqB,UAArB;AACAkC,MAAAA,GAAG,CAACG,KAAJ,CAAUE,IAAV,GAAiB,MAAjB;AACAL,MAAAA,GAAG,CAACG,KAAJ,CAAUG,GAAV,GAAgB,MAAhB;AACAN,MAAAA,GAAG,CAACG,KAAJ,CAAUT,KAAV,GAAkB,MAAlB;AACAM,MAAAA,GAAG,CAACG,KAAJ,CAAUI,MAAV,GAAoBuB,KAAK,GAAGC,IAAR,GAAeA,IAAhB,GAAwB,IAA3C;AACA/B,MAAAA,GAAG,CAACG,KAAJ,CAAU7B,UAAV,GAAuB,wBAAvB;AACA0B,MAAAA,GAAG,CAACG,KAAJ,CAAU,eAAV,IAA6B,KAA7B;AACA,WAAKxE,GAAL,CAASiC,WAAT,CAAqBoC,GAArB;;AAEA,WAAK,IAAIT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuC,KAApB,EAA2BvC,CAAC,EAA5B,EAAgC;AAC/B,YAAIyC,MAAM,GAAG,KAAKrH,OAAL,CAAa4E,CAAb,CAAb;AACA,YAAI0C,MAAM,GAAGD,MAAM,CAACC,MAApB;AACA,YAAIC,GAAG,GAAGtG,QAAQ,CAACqE,aAAT,CAAuB,KAAvB,CAAV;AACAiC,QAAAA,GAAG,CAAC/B,KAAJ,CAAUrC,QAAV,GAAqB,UAArB;AACAoE,QAAAA,GAAG,CAAC/B,KAAJ,CAAUE,IAAV,GAAiB,KAAjB;AACA6B,QAAAA,GAAG,CAAC/B,KAAJ,CAAUG,GAAV,GAAiByB,IAAI,GAAG,CAAP,GAAYxC,CAAC,GAAGwC,IAAjB,GAA0B,IAA1C;AACAG,QAAAA,GAAG,CAAC/B,KAAJ,CAAU,gBAAV,IAA8B,MAA9B;AACA+B,QAAAA,GAAG,CAAC/B,KAAJ,CAAU,QAAV,IAAsB,SAAtB;AACA+B,QAAAA,GAAG,CAAChC,YAAJ,CAAiB,KAAjB,EAAwB,KAAKiC,UAAL,CAAgBrI,OAAhB,CAAwBmI,MAAxB,CAAxB;AACAC,QAAAA,GAAG,CAAC/B,KAAJ,CAAUT,KAAV,GAAkB,MAAlB;AACAwC,QAAAA,GAAG,CAAC/B,KAAJ,CAAUI,MAAV,GAAmB,MAAnB;AACS2B,QAAAA,GAAG,CAAChC,YAAJ,CAAiB,OAAjB,EAA0B8B,MAAM,CAACI,QAAjC;;AACAF,QAAAA,GAAG,CAACG,OAAJ,GAAY,YAAU;AAAEL,UAAAA,MAAM,CAACM,aAAP,CAAqBlJ,KAArB;AAA4B,SAApD;;AACT4G,QAAAA,GAAG,CAACpC,WAAJ,CAAgBsE,GAAhB;AACA;AACE,K,CACD;;;;WACA,uBAAc5I,GAAd,EAAkB;AACd,UAAIA,GAAG,CAACiJ,IAAJ,IAAY,IAAZ,IAAoB,OAAQjJ,GAAG,CAACiJ,IAAZ,IAAqB,WAAzC,IAAwDjJ,GAAG,CAACiJ,IAAhE,EAAsE;AAClE,YAAIC,OAAO,GAAG,IAAd;;AACA,gBAAQlJ,GAAG,CAACmJ,OAAZ;AACI,eAAK,MAAL;AACID,YAAAA,OAAO,GAAG,KAAKE,UAAL,CAAgBpJ,GAAhB,CAAV;AACA,iBAAKqJ,SAAL,CAAeH,OAAf,EAAuB,OAAvB;AACA;;AACJ,eAAK,MAAL;AACI,iBAAKI,aAAL,CAAmBtJ,GAAnB;AACA;;AACJ,eAAK,MAAL;AACI,iBAAKuJ,UAAL,CAAgBvJ,GAAhB;AACA;;AACJ,eAAK,cAAL;AACIkJ,YAAAA,OAAO,GAAG,KAAKM,kBAAL,CAAwBxJ,GAAxB,CAAV;AACA,iBAAKqJ,SAAL,CAAeH,OAAf,EAAuB,OAAvB;AACA;;AACJ,eAAK,QAAL;AACI,iBAAKO,YAAL,CAAkBzJ,GAAlB;AACA;AACJ;AACA;AACA;AACA;;AACA,eAAK,UAAL;AAAkB;AACd,iBAAK0J,cAAL,CAAoB1J,GAApB;AACA;;AACJ,eAAK,OAAL;AAAe;AACX,iBAAK2J,cAAL,CAAoB3J,GAApB;AACA;;AACJ,eAAK,gBAAL;AAAwB;AACpB,iBAAK4J,oBAAL,CAA0B5J,GAA1B;AACA;;AACJ,eAAK,WAAL;AAAmB;AACf,iBAAK6J,eAAL,CAAqB7J,GAArB;AACA;AAjCR;AAmCH;AACJ,K,CACD;;;;WACA,oBAAYA,GAAZ,EAAiB;AACb,UAAIF,KAAK,GAAC,IAAV;;AACA,UAAIgK,WAAW,GAAG9J,GAAG,CAACqG,KAAJ,IAAa,EAA/B,CAFa,CAEqB;;AAClC,UAAI0D,YAAY,GAAG/J,GAAG,CAACiH,MAAJ,IAAc,GAAjC,CAHa,CAGwB;;AACrC,UAAI+C,WAAW,GAAGhK,GAAG,CAACoG,KAAJ,IAAa,GAA/B,CAJa,CAIsB;;AACnC,UAAI6D,UAAU,GAAGjK,GAAG,CAAC6G,KAAJ,CAAUqD,SAAV,IAAuB,QAAxC,CALa,CAMb;;AACAlK,MAAAA,GAAG,CAACmK,QAAJ,CAAa9J,OAAb,CAAqB,UAAS+J,OAAT,EAAkB9J,KAAlB,EAAwB;AACzC,YAAI+J,SAAS,GAAGL,WAAhB;AACA,YAAIM,SAAS,GAAGF,OAAO,CAAC/D,KAAR,IAAeyD,WAA/B;AACA,YAAIS,SAAS,GAAG,CAAC,CAACH,OAAO,CAACI,QAAR,CAAiB7F,CAAjB,IAAoB,CAArB,KAA2ByF,OAAO,CAACK,MAAR,CAAe9F,CAAf,IAAkB,CAA7C,CAAD,IAAoD,CAApE;AACA,YAAI+F,SAAS,GAAG,CAAC,CAACN,OAAO,CAACI,QAAR,CAAiB5F,CAAjB,IAAsB,CAAvB,KAA6BwF,OAAO,CAACK,MAAR,CAAe7F,CAAf,IAAoB,CAAjD,CAAD,IAAwD,CAAxE;AACA,YAAI+F,SAAS,GAAG,CAAC,CAACP,OAAO,CAACI,QAAR,CAAiB3F,CAAjB,IAAsB,CAAvB,KAA6BuF,OAAO,CAACK,MAAR,CAAe5F,CAAf,IAAoB,CAAjD,CAAD,IAAwD,CAAxE,CALyC,CAMzC;;AACA,YAAIuF,OAAO,CAACI,QAAR,CAAiB3F,CAAjB,IAAsBuF,OAAO,CAACK,MAAR,CAAe5F,CAAzC,EAA4C;AACxCwF,UAAAA,SAAS,GAAGxJ,IAAI,CAAC+J,GAAL,CAASR,OAAO,CAACI,QAAR,CAAiB7F,CAAjB,GAAqByF,OAAO,CAACK,MAAR,CAAe9F,CAA7C,CAAZ;AACA2F,UAAAA,SAAS,GAAGF,OAAO,CAAC/D,KAAR,IAAiByD,WAA7B;AACH,SAHD,MAGO,IAAIM,OAAO,CAACI,QAAR,CAAiB7F,CAAjB,IAAsByF,OAAO,CAACK,MAAR,CAAe9F,CAAzC,EAA4C;AAC/C0F,UAAAA,SAAS,GAAGD,OAAO,CAAC/D,KAAR,IAAiByD,WAA7B;AACAQ,UAAAA,SAAS,GAAGzJ,IAAI,CAAC+J,GAAL,CAASR,OAAO,CAACI,QAAR,CAAiB3F,CAAjB,GAAqBuF,OAAO,CAACK,MAAR,CAAe5F,CAA7C,CAAZ;AACH;;AACD,YAAIgG,OAAO,GAAG;AACVzE,UAAAA,KAAK,EAAEiE,SADG;AAEVpD,UAAAA,MAAM,EAAEmD,OAAO,CAACnD,MAAR,IAAkB8C,YAFhB;AAGV1D,UAAAA,KAAK,EAAEiE,SAHG;AAIVQ,UAAAA,QAAQ,EAAEV,OAAO,CAACU,QAJR;AAKVnG,UAAAA,CAAC,EAAE4F,SALO;AAMV3F,UAAAA,CAAC,EAAE8F,SANO;AAOV7F,UAAAA,CAAC,EAAE8F,SAPO;AAQVI,UAAAA,IAAI,EAAEX,OAAO,CAACW,IARJ;AASVxK,UAAAA,IAAI,EAAC6J,OAAO,CAAC7J,IATH;AAUVsG,UAAAA,KAAK,EAAE;AACHqD,YAAAA,SAAS,EAAED,UADR;AAEHe,YAAAA,IAAI,EAACZ,OAAO,CAACY;AAFV;AAVG,SAAd;;AAeA,YAAIC,IAAI,GAAGnL,KAAK,CAACsJ,UAAN,CAAiByB,OAAjB,CAAX;;AACA,YAAI/K,KAAK,CAAC+I,UAAN,CAAiB9I,MAAjB,CAAwBqK,OAAO,CAACc,SAAhC,KAA8Cd,OAAO,CAACc,SAAR,CAAkBlF,MAAlB,GAA2B,CAA7E,EAAgF;AAC5EoE,UAAAA,OAAO,CAACc,SAAR,CAAkB7K,OAAlB,CAA0B,UAAS8K,WAAT,EAAsB7K,KAAtB,EAA4B;AAClD,gBAAI8K,MAAM,GAAGtL,KAAK,CAACuL,UAAN,CAAiBF,WAAjB,CAAb;;AACAF,YAAAA,IAAI,GAAGnL,KAAK,CAACwL,UAAN,CAAiBH,WAAW,CAACI,EAA7B,EAAiCN,IAAjC,EAAuCG,MAAvC,EAA8CnB,UAA9C,CAAP;AACH,WAHD;AAIH;;AACDnK,QAAAA,KAAK,CAACuJ,SAAN,CAAgB4B,IAAhB,EAAqB,OAArB;AACH,OArCD;AAsCH,K,CACD;;;;WACA,oBAAWO,OAAX,EAAoBC,IAApB,EAA0BC,IAA1B,EAA+BzB,UAA/B,EAA2C;AACvC,UAAI0B,OAAO,GAAG,IAAIC,QAAJ,CAAaH,IAAb,CAAd;AACA,UAAII,OAAO,GAAG,IAAID,QAAJ,CAAaF,IAAb,CAAd;AACA,UAAII,SAAS,GAAG,IAAhB;;AACA,UAAIN,OAAO,IAAI,GAAf,EAAoB;AAChBM,QAAAA,SAAS,GAAGH,OAAO,CAACI,QAAR,CAAiBF,OAAjB,CAAZ;AACH,OAFD,MAEO,IAAIL,OAAO,IAAI,GAAf,EAAoB;AACvB,YAAIQ,OAAO,GAAG,IAAInN,KAAK,CAACoN,IAAV,CAAeP,IAAf,CAAd;AACAA,QAAAA,IAAI,CAACQ,YAAL;AACAT,QAAAA,IAAI,CAACU,QAAL,CAAcC,KAAd,CAAoBV,IAAI,CAACS,QAAzB,EAAmCT,IAAI,CAACW,MAAxC;AACA,eAAOZ,IAAP,CAJuB,CAK3B;AACC,OANM,MAMA,IAAID,OAAO,IAAI,GAAf,EAAoB;AAAC;AACxBM,QAAAA,SAAS,GAAGH,OAAO,CAACW,SAAR,CAAkBT,OAAlB,CAAZ;AACH,OAFM,MAEA;AACH,aAAKxC,SAAL,CAAeqC,IAAf,EAAoB,OAApB;AACA,eAAOD,IAAP;AACH;;AACD,UAAIc,iBAAiB,GAAG,EAAxB;AACAA,MAAAA,iBAAiB,CAACC,IAAlB,CAAuB,IAAI3N,KAAK,CAAC4N,mBAAV,CAA8B;AACjDC,QAAAA,YAAY,EAAE7N,KAAK,CAAC8N;AAD6B,OAA9B,CAAvB;AAGA,UAAIC,MAAM,GAAGd,SAAS,CAACe,MAAV,CAAiBN,iBAAjB,CAAb;AACAK,MAAAA,MAAM,CAACE,QAAP,CAAgBC,OAAhB,GAA0BlO,KAAK,CAACmO,WAAhC;AACAJ,MAAAA,MAAM,CAACT,QAAP,CAAgBc,kBAAhB;AACAL,MAAAA,MAAM,CAACT,QAAP,CAAgBe,oBAAhB;AACAN,MAAAA,MAAM,CAAC7B,IAAP,GAAaU,IAAI,CAACV,IAAL,GAAUS,OAAV,GAAkBE,IAAI,CAACX,IAApC;AACA6B,MAAAA,MAAM,CAACrM,IAAP,GAAYkL,IAAI,CAAClL,IAAL,GAAUiL,OAAV,GAAkBE,IAAI,CAACnL,IAAnC;AACAqM,MAAAA,MAAM,CAACE,QAAP,CAAgBK,WAAhB,GAA8B,IAA9B;AACAP,MAAAA,MAAM,CAACT,QAAP,CAAgBiB,iBAAhB,GAAoC,IAApC;AACAR,MAAAA,MAAM,CAACT,QAAP,CAAgBkB,aAAhB,GAAgC,IAAhC;AAEAT,MAAAA,MAAM,CAACE,QAAP,GAAgBrB,IAAI,CAACqB,QAArB;;AAEA,WAAK,IAAI7G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2G,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBtH,MAA1C,EAAkDC,CAAC,EAAnD,EAAuD;AACnD,YAAIsH,OAAO,GAAG,KAAd;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG/B,IAAI,CAACU,QAAL,CAAcmB,KAAlC,EAAyCE,CAAC,EAA1C,EAA8C;AAC1C,cAAIZ,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C9I,CAA1C,KAAgD8G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC9I,CAAxF,IACGiI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C7I,CAA1C,KAAgD6G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC7I,CAD3F,IAEGgI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C5I,CAA1C,KAAgD4G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC5I,CAF3F,IAGG+H,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C9I,CAA1C,KAAgD8G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC9I,CAH3F,IAIGiI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C7I,CAA1C,KAAgD6G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC7I,CAJ3F,IAKGgI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C5I,CAA1C,KAAgD4G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC5I,CAL3F,IAMG+H,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C9I,CAA1C,KAAgD8G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC9I,CAN3F,IAOGiI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C7I,CAA1C,KAAgD6G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC7I,CAP3F,IAQGgI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C5I,CAA1C,KAAgD4G,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC5I,CAR/F,EAQkG;AAC1F+H,YAAAA,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyB2B,KAAzB,CAA+B8F,MAA/B,CAAsCzD,UAAtC;AACA2C,YAAAA,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyB0H,aAAzB,GAAuClC,IAAI,CAACU,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBG,aAA9D;AACAJ,YAAAA,OAAO,IAAI,IAAX;AACP;AACJ;;AACD,YAAIA,OAAO,IAAI,KAAf,EAAqB;AACjB,eAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG9B,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBtH,MAAvC,EAA+CwH,CAAC,EAAhD,EAAoD;AAChD,gBAAIZ,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C9I,CAA1C,KAAgD+G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC9I,CAAxF,IACGiI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C7I,CAA1C,KAAgD8G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC7I,CAD3F,IAEGgI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C5I,CAA1C,KAAgD6G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC5I,CAF3F,IAGG+H,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C9I,CAA1C,KAAgD+G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC9I,CAH3F,IAIGiI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C7I,CAA1C,KAAgD8G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC7I,CAJ3F,IAKGgI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C5I,CAA1C,KAAgD6G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC5I,CAL3F,IAMG+H,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C9I,CAA1C,KAAgD+G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC9I,CAN3F,IAOGiI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C7I,CAA1C,KAAgD8G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC7I,CAP3F,IAQGgI,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyBwH,aAAzB,CAAuC,CAAvC,EAA0C5I,CAA1C,KAAgD6G,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBC,aAAvB,CAAqC,CAArC,EAAwC5I,CAR/F,EAQkG;AAC9F+H,cAAAA,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyB2B,KAAzB,CAA+B8F,MAA/B,CAAsCzD,UAAtC;AACA2C,cAAAA,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyB0H,aAAzB,GAAuCjC,IAAI,CAACS,QAAL,CAAcmB,KAAd,CAAoBE,CAApB,EAAuBG,aAA9D;AACAJ,cAAAA,OAAO,GAAG,IAAV;AACH;AACJ;AACJ;;AACD,YAAIA,OAAO,IAAI,KAAf,EAAsB;AAClB;AACAX,UAAAA,MAAM,CAACT,QAAP,CAAgBmB,KAAhB,CAAsBrH,CAAtB,EAAyB2B,KAAzB,CAA+B8F,MAA/B,CAAsCzD,UAAtC;AACH;AACJ;;AAED2C,MAAAA,MAAM,CAACnH,UAAP,GAAoB,IAApB;AACAmH,MAAAA,MAAM,CAACgB,aAAP,GAAuB,IAAvB;AACA,aAAOhB,MAAP;AACH,K,CACD;;;;WACA,oBAAa5M,GAAb,EAAkB;AACd,UAAI8J,WAAW,GAAI,EAAnB,CADc,CACQ;;AACtB,UAAIC,YAAY,GAAI,GAApB,CAFc,CAEU;;AACxB,UAAIC,WAAW,GAAI,GAAnB,CAHc,CAGS;;AACvB,UAAIC,UAAU,GAAG,QAAjB,CAJc,CAKd;;AACA,UAAII,SAAS,GAAGL,WAAhB;AACA,UAAIM,SAAS,GAAGtK,GAAG,CAACqG,KAAJ,IAAayD,WAA7B;AACA,UAAIS,SAAS,GAAG,CAAC,CAACvK,GAAG,CAACwK,QAAJ,CAAa7F,CAAb,IAAkB,CAAnB,KAAyB3E,GAAG,CAACyK,MAAJ,CAAW9F,CAAX,IAAgB,CAAzC,CAAD,IAAgD,CAAhE;AACA,UAAI+F,SAAS,GAAG,CAAC,CAAC1K,GAAG,CAACwK,QAAJ,CAAa5F,CAAb,IAAkB,CAAnB,KAAyB5E,GAAG,CAACyK,MAAJ,CAAW7F,CAAX,IAAgB,CAAzC,CAAD,IAAgD,CAAhE;AACA,UAAI+F,SAAS,GAAG,CAAC,CAAC3K,GAAG,CAACwK,QAAJ,CAAa3F,CAAb,IAAkB,CAAnB,KAAyB7E,GAAG,CAACyK,MAAJ,CAAW5F,CAAX,IAAgB,CAAzC,CAAD,IAAgD,CAAhE,CAVc,CAWd;;AACA,UAAI7E,GAAG,CAACwK,QAAJ,CAAa3F,CAAb,IAAkB7E,GAAG,CAACyK,MAAJ,CAAW5F,CAAjC,EAAoC;AAChCwF,QAAAA,SAAS,GAAGxJ,IAAI,CAAC+J,GAAL,CAAS5K,GAAG,CAACwK,QAAJ,CAAa7F,CAAb,GAAiB3E,GAAG,CAACyK,MAAJ,CAAW9F,CAArC,CAAZ;AACA2F,QAAAA,SAAS,GAAGtK,GAAG,CAACqG,KAAJ,IAAayD,WAAzB;AACH,OAHD,MAGO,IAAI9J,GAAG,CAACwK,QAAJ,CAAa7F,CAAb,IAAkB3E,GAAG,CAACyK,MAAJ,CAAW9F,CAAjC,EAAoC;AACvC0F,QAAAA,SAAS,GAAGrK,GAAG,CAACqG,KAAJ,IAAayD,WAAzB;AACAQ,QAAAA,SAAS,GAAGzJ,IAAI,CAAC+J,GAAL,CAAS5K,GAAG,CAACwK,QAAJ,CAAa3F,CAAb,GAAiB7E,GAAG,CAACyK,MAAJ,CAAW5F,CAArC,CAAZ;AACH;;AACD,UAAIgG,OAAO,GAAG;AACVzE,QAAAA,KAAK,EAAEiE,SADG;AAEVpD,QAAAA,MAAM,EAAEjH,GAAG,CAACiH,MAAJ,IAAc8C,YAFZ;AAGV1D,QAAAA,KAAK,EAAEiE,SAHG;AAIVQ,QAAAA,QAAQ,EAAE9K,GAAG,CAAC8K,QAJJ;AAKVC,QAAAA,IAAI,EAAE/K,GAAG,CAAC+K,IALA;AAMVxK,QAAAA,IAAI,EAAEP,GAAG,CAACO,IANA;AAOV4I,QAAAA,OAAO,EAAEnJ,GAAG,CAACmJ,OAPH;AAQVxE,QAAAA,CAAC,EAAE4F,SARO;AASV3F,QAAAA,CAAC,EAAE8F,SATO;AAUV7F,QAAAA,CAAC,EAAE8F,SAVO;AAWV9D,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAACkK,SAAJ,IAAiBD,UADzB;AAEHe,UAAAA,IAAI,EAAEhL,GAAG,CAACgL;AAFP;AAXG,OAAd;AAgBA,UAAIC,IAAI,GAAC,KAAK7B,UAAL,CAAgByB,OAAhB,CAAT;AACA,aAAOI,IAAP;AACH,K,CACD;;;;WACA,oBAAWjL,GAAX,EAAe;AACX,UAAIoG,KAAK,GAAGpG,GAAG,CAACoG,KAAJ,IAAa,IAAzB,CADW,CACqB;;AAChC,UAAIa,MAAM,GAAGjH,GAAG,CAACiH,MAAJ,IAAc,EAA3B,CAFW,CAEqB;;AAChC,UAAIZ,KAAK,GAACrG,GAAG,CAACqG,KAAJ,IAAaD,KAAvB,CAHW,CAGoB;;AAC/B,UAAIzB,CAAC,GAAG3E,GAAG,CAAC2E,CAAJ,IAAS,CAAjB;AAAA,UAAoBC,CAAC,GAAG5E,GAAG,CAAC4E,CAAJ,IAAS,CAAjC;AAAA,UAAoCC,CAAC,GAAG7E,GAAG,CAAC6E,CAAJ,IAAS,CAAjD;AACA,UAAIqF,SAAS,GAAGlK,GAAG,CAAC6G,KAAJ,CAAUgH,cAAV,CAAyB,WAAzB,IAAsC7N,GAAG,CAAC6G,KAAJ,CAAUqD,SAAhD,GAA4D,EAA5E,CALW,CAMX;;AACA,UAAI4D,YAAY,GAAG,IAAIjP,KAAK,CAACkP,YAAV,CAAuB3H,KAAvB,EAA8Ba,MAA9B,EAAsCZ,KAAtC,EAA6C,CAA7C,EAAgD,CAAhD,EAAmD,CAAnD,CAAnB,CAPW,CASX;;AACA,WAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6H,YAAY,CAACR,KAAb,CAAmBtH,MAAvC,EAA+CC,CAAC,IAAI,CAApD,EAAuD;AACnD6H,QAAAA,YAAY,CAACR,KAAb,CAAmBrH,CAAnB,EAAsB2B,KAAtB,CAA4B8F,MAA5B,CAAmCxD,SAAnC;AACA4D,QAAAA,YAAY,CAACR,KAAb,CAAmBrH,CAAC,GAAG,CAAvB,EAA0B2B,KAA1B,CAAgC8F,MAAhC,CAAuCxD,SAAvC;AACH,OAbU,CAcX;;;AACA,UAAI8D,WAAW,GAAG;AACdtB,QAAAA,YAAY,EAAE7N,KAAK,CAAC8N;AADN,OAAlB;AAGA,UAAIsB,aAAa,GAAGD,WAApB;AAAA,UACIE,aAAa,GAAGF,WADpB;AAAA,UAEIG,eAAe,GAAGH,WAFtB;AAAA,UAGII,aAAa,GAAGJ,WAHpB;AAAA,UAIIK,cAAc,GAAGL,WAJrB;AAKA,UAAIM,YAAY,GAAG,CAAnB;;AACA,UAAItO,GAAG,CAAC6G,KAAJ,IAAa,IAAb,IAAqB,OAAQ7G,GAAG,CAAC6G,KAAZ,IAAsB,WAA3C,IACG7G,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,IAAkB,IADrB,IAC6B,OAAQhL,GAAG,CAAC6G,KAAJ,CAAUmE,IAAlB,IAA2B,WAD5D,EACyE;AACrE;AACA,YAAIhL,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAehD,OAAf,IAA0B,IAA1B,IAAkC,OAAQhI,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAehD,OAAvB,IAAmC,WAAzE,EAAsF;AAClFsG,UAAAA,YAAY,GAAGtO,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAehD,OAA9B;AACH;;AACD,YAAIuG,UAAU,GAACvO,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,YAA9B,KAA6C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAeuD,UAAf,CAA0BV,cAA1B,CAAyC,WAAzC,CAA7C,GAAmG7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAeuD,UAAf,CAA0BrE,SAA7H,GAAuIlK,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,IAA2C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAed,SAA1D,GAAoE,EAA1N;AACA,YAAIsE,SAAS,GAACxO,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,KAA4C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAewD,SAAf,CAAyBX,cAAzB,CAAwC,WAAxC,CAA5C,GAAiG7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAewD,SAAf,CAAyBtE,SAA1H,GAAoIlK,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,IAA2C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAed,SAA1D,GAAoE,EAAtN;AACA,YAAIuE,OAAO,GAACzO,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,SAA9B,KAA0C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAeyD,OAAf,CAAuBZ,cAAvB,CAAsC,WAAtC,CAA1C,GAA6F7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAeyD,OAAf,CAAuBvE,SAApH,GAA8HlK,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,IAA2C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAed,SAA1D,GAAoE,EAA9M;AACA,YAAIwE,SAAS,GAAC1O,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,KAA4C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe0D,SAAf,CAAyBb,cAAzB,CAAwC,WAAxC,CAA5C,GAAiG7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe0D,SAAf,CAAyBxE,SAA1H,GAAoIlK,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,IAA2C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAed,SAA1D,GAAoE,EAAtN;AACA,YAAIyE,SAAS,GAAC3O,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,KAA4C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe2D,SAAf,CAAyBd,cAAzB,CAAwC,WAAxC,CAA5C,GAAiG7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe2D,SAAf,CAAyBzE,SAA1H,GAAoIlK,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,IAA2C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAed,SAA1D,GAAoE,EAAtN;AACA,YAAI0E,WAAW,GAAC5O,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,aAA9B,KAA8C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe4D,WAAf,CAA2Bf,cAA3B,CAA0C,WAA1C,CAA9C,GAAqG7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe4D,WAAf,CAA2B1E,SAAhI,GAA0IlK,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe6C,cAAf,CAA8B,WAA9B,IAA2C7N,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAed,SAA1D,GAAoE,EAA9N,CAVqE,CAYrE;;AACAmE,QAAAA,cAAc,GAAG,KAAKQ,gBAAL,CAAsBxI,KAAtB,EAA6BY,MAA7B,EAAqCjH,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAeuD,UAApD,EAAgET,YAAhE,EAA6ES,UAA7E,EAAyF,CAAzF,CAAjB,CAbqE,CAcrE;;AACAH,QAAAA,aAAa,GAAG,KAAKS,gBAAL,CAAsBxI,KAAtB,EAA6BY,MAA7B,EAAqCjH,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAewD,SAApD,EAA+DV,YAA/D,EAA4EU,SAA5E,EAAuF,CAAvF,CAAhB,CAfqE,CAgBrE;;AACAR,QAAAA,WAAW,GAAG,KAAKa,gBAAL,CAAsBzI,KAAtB,EAA6BC,KAA7B,EAAoCrG,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAeyD,OAAnD,EAA4DX,YAA5D,EAAyEW,OAAzE,EAAkF,CAAlF,CAAd,CAjBqE,CAkBrE;;AACAR,QAAAA,aAAa,GAAG,KAAKY,gBAAL,CAAsBzI,KAAtB,EAA6BC,KAA7B,EAAoCrG,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe0D,SAAnD,EAA8DZ,YAA9D,EAA2EY,SAA3E,EAAsF,CAAtF,CAAhB,CAnBqE,CAoBrE;;AACAR,QAAAA,aAAa,GAAG,KAAKW,gBAAL,CAAsBzI,KAAtB,EAA6Ba,MAA7B,EAAqCjH,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe2D,SAApD,EAA+Db,YAA/D,EAA4Ea,SAA5E,EAAuF,CAAvF,CAAhB,CArBqE,CAsBrE;;AACAR,QAAAA,eAAe,GAAG,KAAKU,gBAAL,CAAsBzI,KAAtB,EAA6Ba,MAA7B,EAAqCjH,GAAG,CAAC6G,KAAJ,CAAUmE,IAAV,CAAe4D,WAApD,EAAiEd,YAAjE,EAA8Ec,WAA9E,EAA2F,EAA3F,CAAlB;AACH;;AACD,UAAIrC,iBAAiB,GAAG,EAAxB,CAlDW,CAkDgB;AAC3B;AACA;;AACAA,MAAAA,iBAAiB,CAACC,IAAlB,CAAuB,IAAI3N,KAAK,CAAC4N,mBAAV,CAA8B4B,cAA9B,CAAvB;AACA9B,MAAAA,iBAAiB,CAACC,IAAlB,CAAuB,IAAI3N,KAAK,CAAC4N,mBAAV,CAA8B2B,aAA9B,CAAvB;AACA7B,MAAAA,iBAAiB,CAACC,IAAlB,CAAuB,IAAI3N,KAAK,CAAC4N,mBAAV,CAA8BuB,WAA9B,CAAvB;AACAzB,MAAAA,iBAAiB,CAACC,IAAlB,CAAuB,IAAI3N,KAAK,CAAC4N,mBAAV,CAA8BwB,aAA9B,CAAvB;AACA1B,MAAAA,iBAAiB,CAACC,IAAlB,CAAuB,IAAI3N,KAAK,CAAC4N,mBAAV,CAA8ByB,aAA9B,CAAvB;AACA3B,MAAAA,iBAAiB,CAACC,IAAlB,CAAuB,IAAI3N,KAAK,CAAC4N,mBAAV,CAA8B0B,eAA9B,CAAvB;AAEA,UAAIlD,IAAI,GAAG,IAAIpM,KAAK,CAACoN,IAAV,CAAe6B,YAAf,EAA6BvB,iBAA7B,CAAX;AACAtB,MAAAA,IAAI,CAACxF,UAAL,GAAkB,IAAlB;AACAwF,MAAAA,IAAI,CAAC2C,aAAL,GAAqB,IAArB;AACA3C,MAAAA,IAAI,CAACF,IAAL,GAAY/K,GAAG,CAAC+K,IAAhB;AACAE,MAAAA,IAAI,CAAC1K,IAAL,GAAYP,GAAG,CAACO,IAAhB;AACA0K,MAAAA,IAAI,CAACzG,QAAL,CAAcC,GAAd,CAAkBE,CAAlB,EAAqBC,CAArB,EAAwBC,CAAxB;;AACA,UAAI7E,GAAG,CAAC8K,QAAJ,IAAgB,IAAhB,IAAwB,OAAQ9K,GAAG,CAAC8K,QAAZ,IAAyB,WAAjD,IAAgE9K,GAAG,CAAC8K,QAAJ,CAAa9E,MAAb,GAAsB,CAA1F,EAA6F;AACzFhG,QAAAA,GAAG,CAAC8K,QAAJ,CAAazK,OAAb,CAAqB,UAASyO,YAAT,EAAuBxO,KAAvB,EAA6B;AAC9C;AACA,kBAAQwO,YAAY,CAACC,SAArB;AACI,iBAAK,GAAL;AACI9D,cAAAA,IAAI,CAAC+D,OAAL,CAAaF,YAAY,CAACG,MAA1B;AACA;;AACJ,iBAAK,GAAL;AACIhE,cAAAA,IAAI,CAACiE,OAAL,CAAaJ,YAAY,CAACG,MAA1B;AACA;;AACJ,iBAAK,GAAL;AACIhE,cAAAA,IAAI,CAACkE,OAAL,CAAaL,YAAY,CAACG,MAA1B;AACA;;AACJ,iBAAK,KAAL;AAAa;AACThE,cAAAA,IAAI,CAACmE,YAAL,CAAkB,IAAIvQ,KAAK,CAACwQ,OAAV,CAAkBP,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlB,EAA0CH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAA1C,EAAkEH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlE,CAAlB,EAA6GH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAA7G;AACA;AAZR;AAcH,SAhBD;AAiBH;;AACD,aAAOhE,IAAP;AACH,K,CACD;;;;WACA,qBAAajL,GAAb,EAAkB;AACd;AACA,UAAIsP,OAAJ;AAAA,UAAYC,WAAW,GAAC,EAAxB;AAAA,UAA2BxE,IAAI,GAAC/K,GAAG,CAAC+K,IAAJ,IAAU,KAAKlC,UAAL,CAAgBlI,IAAhB,EAA1C,CAFc,CAId;;AACA,UAAI6O,KAAK,GAAE;AACPvG,QAAAA,IAAI,EAAE,IADC;AAEP8B,QAAAA,IAAI,EAAE,EAFC;AAGPxK,QAAAA,IAAI,EAAE,SAHC;AAIP4I,QAAAA,OAAO,EAAE,MAJF;AAKP/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASrJ,KALT;AAMPa,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASC,KANV;AAOPrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASpJ,KAPT;AAQP1B,QAAAA,CAAC,EAAE,CARI;AASPC,QAAAA,CAAC,EAAE5E,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgBjH,GAAG,CAACyP,IAAJ,CAASC,KATrB;AAUP7K,QAAAA,CAAC,EAAE,CAVI;AAWPgC,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXA,OAAX;AAgBA,UAAI2E,MAAM,GAAG,KAAKvG,UAAL,CAAgBoG,KAAhB,CAAb,CArBc,CAuBd;;AACA,UAAII,OAAO,GAAE;AACT3G,QAAAA,IAAI,EAAE,IADG;AAET8B,QAAAA,IAAI,EAAE,EAFG;AAGTxK,QAAAA,IAAI,EAAE,UAHG;AAIT4I,QAAAA,OAAO,EAAE,MAJA;AAKT/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASC,KALP;AAMTzI,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,IAAEjH,GAAG,CAACyP,IAAJ,CAASC,KAN1B;AAOTrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASpJ,KAPP;AAQT1B,QAAAA,CAAC,EAAE,EAAE3E,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,GAAe,CAAf,GAAiBpG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAAlC,IAAuC,GARjC;AAST9K,QAAAA,CAAC,EAAE,CAAC5E,GAAG,CAACyP,IAAJ,CAASxI,MAAV,GAAiB,CAAjB,GAAmBjH,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAT5B;AAUT7K,QAAAA,CAAC,EAAE,CAVM;AAWTgC,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXE,OAAb;AAgBA,UAAI6E,QAAQ,GAAG,KAAKzG,UAAL,CAAgBwG,OAAhB,CAAf;AACAN,MAAAA,OAAO,GAAG,KAAKhE,UAAL,CAAgB,GAAhB,EAAqBqE,MAArB,EAA6BE,QAA7B,CAAV,CAzCc,CA2Cd;;AACA,UAAIC,QAAQ,GAAE;AACV7G,QAAAA,IAAI,EAAE,IADI;AAEV8B,QAAAA,IAAI,EAAE,EAFI;AAGVxK,QAAAA,IAAI,EAAE,WAHI;AAIV4I,QAAAA,OAAO,EAAE,MAJC;AAKV/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASC,KALN;AAMVzI,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,IAAEjH,GAAG,CAACyP,IAAJ,CAASC,KANzB;AAOVrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASpJ,KAPN;AAQV1B,QAAAA,CAAC,EAAE,CAAC3E,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,GAAe,CAAf,GAAiBpG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAAjC,IAAsC,GAR/B;AASV9K,QAAAA,CAAC,EAAE,CAAC5E,GAAG,CAACyP,IAAJ,CAASxI,MAAV,GAAiB,CAAjB,GAAmBjH,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAT3B;AAUV7K,QAAAA,CAAC,EAAE,CAVO;AAWVgC,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXG,OAAd;AAgBA,UAAI+E,SAAS,GAAG,KAAK3G,UAAL,CAAgB0G,QAAhB,CAAhB;AACAR,MAAAA,OAAO,GAAG,KAAKhE,UAAL,CAAgB,GAAhB,EAAqBgE,OAArB,EAA8BS,SAA9B,CAAV;AAEA,WAAK1G,SAAL,CAAeiG,OAAf,EAAuB,QAAvB,EA/Dc,CA+DqB;;AAEnC,UAAIU,OAAO,GAAG,IAAInR,KAAK,CAACoR,QAAV,EAAd;AACAD,MAAAA,OAAO,CAAClL,GAAR,CAAYwK,OAAZ;AACAU,MAAAA,OAAO,CAACzP,IAAR,GAAeP,GAAG,CAACO,IAAnB;AACAyP,MAAAA,OAAO,CAACjF,IAAR,GAAeA,IAAf;AACAiF,MAAAA,OAAO,CAACE,IAAR,GAAclQ,GAAG,CAACkQ,IAAJ,IAAU;AAAC3P,QAAAA,IAAI,EAACP,GAAG,CAACO,IAAV;AAAe4P,QAAAA,SAAS,EAAC;AAAzB,OAAxB;AACAH,MAAAA,OAAO,CAACxL,QAAR,CAAiBC,GAAjB,CAAqBzE,GAAG,CAAC2E,CAAJ,IAAO,CAA5B,EAA8B,CAAC3E,GAAG,CAAC4E,CAAJ,IAAO,CAAR,IAAW2K,WAAzC,EAAqDvP,GAAG,CAAC6E,CAAJ,IAAO,CAA5D;AACA,WAAKwE,SAAL,CAAe2G,OAAf,EAAuB,QAAvB;;AAEA,UAAIhQ,GAAG,CAAC8K,QAAJ,IAAgB,IAAhB,IAAwB,OAAQ9K,GAAG,CAAC8K,QAAZ,IAAyB,WAAjD,IAAgE9K,GAAG,CAAC8K,QAAJ,CAAa9E,MAAb,GAAsB,CAA1F,EAA6F;AACzFhG,QAAAA,GAAG,CAAC8K,QAAJ,CAAazK,OAAb,CAAqB,UAASyO,YAAT,EAAuBxO,KAAvB,EAA6B;AAC9C;AACA,kBAAQwO,YAAY,CAACC,SAArB;AACI,iBAAK,GAAL;AACIiB,cAAAA,OAAO,CAAChB,OAAR,CAAgBF,YAAY,CAACG,MAA7B;AACA;;AACJ,iBAAK,GAAL;AACIe,cAAAA,OAAO,CAACd,OAAR,CAAgBJ,YAAY,CAACG,MAA7B;AACA;;AACJ,iBAAK,GAAL;AACIe,cAAAA,OAAO,CAACb,OAAR,CAAgBL,YAAY,CAACG,MAA7B;AACA;;AACJ,iBAAK,KAAL;AAAa;AACTe,cAAAA,OAAO,CAACZ,YAAR,CAAqB,IAAIvQ,KAAK,CAACwQ,OAAV,CAAkBP,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlB,EAA0CH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAA1C,EAAkEH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlE,CAArB,EAAgHH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAhH;AACA;AAZR;AAcH,SAhBD;AAiBH;;AACD,aAAOe,OAAP;AAEH,K,CACD;;;;WACA,4BAAmBhQ,GAAnB,EAAuB;AACnB;AACA,UAAIsP,OAAJ;AAAA,UAAYC,WAAW,GAAC,EAAxB;AAAA,UAA2BzP,KAAK,GAAC,IAAjC;AAAA,UAAsCiL,IAAI,GAAC/K,GAAG,CAAC+K,IAAJ,IAAU,KAAKlC,UAAL,CAAgBlI,IAAhB,EAArD,CAFmB,CAGnB;;;AACA,UAAIyP,OAAO,GAAE;AACTnH,QAAAA,IAAI,EAAE,IADG;AAET1I,QAAAA,IAAI,EAAE,UAFG;AAGTwK,QAAAA,IAAI,EAAC,EAHI;AAIT5B,QAAAA,OAAO,EAAE,MAJA;AAKT/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASrJ,KALP;AAMTa,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASC,KANR;AAOTrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASpJ,KAPP;AAQT1B,QAAAA,CAAC,EAAE,CARM;AASTC,QAAAA,CAAC,EAAE,CAAC5E,GAAG,CAACyP,IAAJ,CAASxI,MAAV,GAAiB,CAAjB,GAAmBjH,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAT5B;AAUT7K,QAAAA,CAAC,EAAE,CAVM;AAWTgC,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXE,OAAb;AAgBA,UAAIqF,QAAQ,GAAG,KAAKjH,UAAL,CAAgBgH,OAAhB,CAAf,CApBmB,CAsBnB;;AACA,UAAIZ,KAAK,GAAE;AACPvG,QAAAA,IAAI,EAAE,IADC;AAEP8B,QAAAA,IAAI,EAAE,EAFC;AAGPxK,QAAAA,IAAI,EAAE,SAHC;AAIP4I,QAAAA,OAAO,EAAE,MAJF;AAKP/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASrJ,KALT;AAMPa,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASC,KANV;AAOPrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASpJ,KAPT;AAQP1B,QAAAA,CAAC,EAAE,CARI;AASPC,QAAAA,CAAC,EAAE5E,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgBjH,GAAG,CAACyP,IAAJ,CAASC,KATrB;AAUP7K,QAAAA,CAAC,EAAE,CAVI;AAWPgC,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXA,OAAX;AAgBA,UAAI2E,MAAM,GAAG,KAAKvG,UAAL,CAAgBoG,KAAhB,CAAb;AAEAF,MAAAA,OAAO,GAAG,KAAKhE,UAAL,CAAgB,GAAhB,EAAoB+E,QAApB,EAA6BV,MAA7B,CAAV,CAzCmB,CA2CnB;;AACA,UAAIC,OAAO,GAAE;AACT3G,QAAAA,IAAI,EAAE,IADG;AAET8B,QAAAA,IAAI,EAAE,EAFG;AAGTxK,QAAAA,IAAI,EAAE,UAHG;AAIT4I,QAAAA,OAAO,EAAE,MAJA;AAKT/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASC,KALP;AAMTzI,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,IAAEjH,GAAG,CAACyP,IAAJ,CAASC,KAN1B;AAOTrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASpJ,KAPP;AAQT1B,QAAAA,CAAC,EAAE,CAAC3E,GAAG,CAACyP,IAAJ,CAASrJ,KAAV,GAAgB,CAAhB,GAAkBpG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAR3B;AAST9K,QAAAA,CAAC,EAAE5E,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,CAAhB,GAAkBjH,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAT3B;AAUT7K,QAAAA,CAAC,EAAE,CAVM;AAWTgC,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXE,OAAb;AAgBA,UAAI6E,QAAQ,GAAG,KAAKzG,UAAL,CAAgBwG,OAAhB,CAAf;AACAN,MAAAA,OAAO,GAAG,KAAKhE,UAAL,CAAgB,GAAhB,EAAqBgE,OAArB,EAA8BO,QAA9B,CAAV,CA7DmB,CA+DnB;;AACA,UAAIC,QAAQ,GAAE;AACV7G,QAAAA,IAAI,EAAE,IADI;AAEV8B,QAAAA,IAAI,EAAE,EAFI;AAGVxK,QAAAA,IAAI,EAAE,WAHI;AAIV4I,QAAAA,OAAO,EAAE,MAJC;AAKV/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASC,KALN;AAMVzI,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,IAAEjH,GAAG,CAACyP,IAAJ,CAASC,KANzB;AAOVrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASpJ,KAPN;AAQV1B,QAAAA,CAAC,EAAE3E,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,GAAe,CAAf,GAAiBpG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CARzB;AASV9K,QAAAA,CAAC,EAAE5E,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,CAAhB,GAAkBjH,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAT1B;AAUV7K,QAAAA,CAAC,EAAE,CAVO;AAWVgC,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXG,OAAd;AAgBA,UAAI+E,SAAS,GAAG,KAAK3G,UAAL,CAAgB0G,QAAhB,CAAhB;AACAR,MAAAA,OAAO,GAAG,KAAKhE,UAAL,CAAgB,GAAhB,EAAqBgE,OAArB,EAA8BS,SAA9B,CAAV,CAjFmB,CAmFnB;;AACA,UAAIO,SAAS,GAAE;AACXrH,QAAAA,IAAI,EAAE,IADK;AAEX8B,QAAAA,IAAI,EAAE,EAFK;AAGXxK,QAAAA,IAAI,EAAE,EAHK;AAIX4I,QAAAA,OAAO,EAAE,MAJE;AAKX/C,QAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASrJ,KALL;AAMXa,QAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,IAAEjH,GAAG,CAACyP,IAAJ,CAASC,KANxB;AAOXrJ,QAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASC,KAPL;AAQX/K,QAAAA,CAAC,EAAE,CARQ;AASXC,QAAAA,CAAC,EAAE5E,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,CAAhB,GAAkBjH,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CATzB;AAUX7K,QAAAA,CAAC,EAAE,CAAC7E,GAAG,CAACyP,IAAJ,CAASpJ,KAAV,GAAgB,CAAhB,GAAkBrG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAVzB;AAWX7I,QAAAA,KAAK,EAAE;AACHqD,UAAAA,SAAS,EAAElK,GAAG,CAAC6G,KAAJ,CAAUqD,SADlB;AAEHc,UAAAA,IAAI,EAAEhL,GAAG,CAAC6G,KAAJ,CAAUmE;AAFb;AAXI,OAAf;AAgBA,UAAIuF,UAAU,GAAG,KAAKnH,UAAL,CAAgBkH,SAAhB,CAAjB;AACAhB,MAAAA,OAAO,GAAG,KAAKhE,UAAL,CAAgB,GAAhB,EAAqBgE,OAArB,EAA8BiB,UAA9B,CAAV;AACA,WAAKlH,SAAL,CAAeiG,OAAf,EAAuB,QAAvB,EAtGmB,CAsGgB;;AAEnC,UAAIU,OAAO,GAAG,IAAInR,KAAK,CAACoR,QAAV,EAAd;AACAD,MAAAA,OAAO,CAAClL,GAAR,CAAYwK,OAAZ;AACAU,MAAAA,OAAO,CAACzP,IAAR,GAAeP,GAAG,CAACO,IAAnB;AACAyP,MAAAA,OAAO,CAACjF,IAAR,GAAeA,IAAf;AACAiF,MAAAA,OAAO,CAACE,IAAR,GAAclQ,GAAG,CAACkQ,IAAJ,IAAU;AAAC3P,QAAAA,IAAI,EAACP,GAAG,CAACO,IAAV;AAAe4P,QAAAA,SAAS,EAAC;AAAzB,OAAxB;AACAH,MAAAA,OAAO,CAACxL,QAAR,CAAiBC,GAAjB,CAAqBzE,GAAG,CAAC2E,CAAJ,IAAO,CAA5B,EAA8B,CAAC3E,GAAG,CAAC4E,CAAJ,IAAO,CAAR,IAAW2K,WAAzC,EAAqDvP,GAAG,CAAC6E,CAAJ,IAAO,CAA5D;AACA,WAAKwE,SAAL,CAAe2G,OAAf,EAAuB,QAAvB;AACA,WAAK5N,OAAL,CAAaoK,IAAb,CAAkBwD,OAAlB,EA/GmB,CAgHnB;;AACA,UAAGhQ,GAAG,CAACwQ,KAAJ,IAAW,IAAX,IAAiB,OAAQxQ,GAAG,CAACwQ,KAAZ,IAAsB,WAA1C,EAAsD;AAClD,YAAGxQ,GAAG,CAACwQ,KAAJ,CAAUC,KAAV,CAAgBzK,MAAhB,IAAwB,CAAxB,IAA2BhG,GAAG,CAACwQ,KAAJ,CAAUE,QAAV,CAAmB1K,MAAnB,IAA2B,CAAzD,EAA2D;AACvD,cAAI2K,OAAO,GAAG;AACV1H,YAAAA,IAAI,EAAE,IADI;AAEV8B,YAAAA,IAAI,EAAC,EAFK;AAGVxK,YAAAA,IAAI,EAAEP,GAAG,CAACwQ,KAAJ,CAAUE,QAAV,CAAmB,CAAnB,CAHI;AAIVvH,YAAAA,OAAO,EAAE,MAJC;AAKV9C,YAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASC,KALN;AAMVtJ,YAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASrJ,KANN;AAOVa,YAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,IAAEjH,GAAG,CAACyP,IAAJ,CAASC,KAPzB;AAQV/K,YAAAA,CAAC,EAAE,CARO;AASVC,YAAAA,CAAC,EAAE,CATO;AAUVC,YAAAA,CAAC,EAAE7E,GAAG,CAACyP,IAAJ,CAASpJ,KAAT,GAAe,CAAf,GAAiBrG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAAhC,GAAkC,CAV3B;AAWV5E,YAAAA,QAAQ,EAAC9K,GAAG,CAACwQ,KAAJ,CAAU1F,QAAV,IAAoB,IAXnB;AAYVjE,YAAAA,KAAK,EAAE;AACHqD,cAAAA,SAAS,EAAElK,GAAG,CAACwQ,KAAJ,CAAUC,KAAV,CAAgB,CAAhB,EAAmBvG,SAD3B;AAEHc,cAAAA,IAAI,EAAEhL,GAAG,CAACwQ,KAAJ,CAAUC,KAAV,CAAgB,CAAhB;AAFH;AAZG,WAAd;AAiBA,cAAIG,QAAQ,GAAG,KAAKxH,UAAL,CAAgBuH,OAAhB,CAAf;;AACA,cAAG3Q,GAAG,CAACwQ,KAAJ,CAAU1F,QAAb,EAAsB;AAClB8F,YAAAA,QAAQ,CAACpM,QAAT,CAAkBC,GAAlB,CAAsBzE,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,GAAe,CAArC,EAAuC,CAAvC,EAAyCpG,GAAG,CAACyP,IAAJ,CAASpJ,KAAT,GAAe,CAAf,GAAiBrG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAAhC,GAAkC,CAAlC,GAAoC1P,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,GAAe,CAA5F;AACH;;AACDwK,UAAAA,QAAQ,CAACC,OAAT,GAAmB7Q,GAAG,CAACwQ,KAAJ,CAAUK,OAA7B;AACAb,UAAAA,OAAO,CAAClL,GAAR,CAAY8L,QAAZ;AACA,eAAKvH,SAAL,CAAeuH,QAAf,EAAwB,QAAxB;AACH,SAzBD,MAyBM,IAAG5Q,GAAG,CAACwQ,KAAJ,CAAUC,KAAV,CAAgBzK,MAAhB,IAAwB,CAAxB,IAA2BhG,GAAG,CAACwQ,KAAJ,CAAUE,QAAV,CAAmB1K,MAAnB,IAA2B,CAAzD,EAA2D;AAC7D,eAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACjG,GAAG,CAACwQ,KAAJ,CAAUC,KAAV,CAAgBzK,MAA9B,EAAqCC,CAAC,EAAtC,EAAyC;AACrC,gBAAItB,CAAC,GAACsB,CAAC,KAAG,CAAJ,GAAM,CAACjG,GAAG,CAACyP,IAAJ,CAASrJ,KAAV,GAAgB,CAAtB,GAAwBpG,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,GAAe,CAA7C;AACA,gBAAIuK,OAAO,GAAG;AACV1H,cAAAA,IAAI,EAAE,IADI;AAEV8B,cAAAA,IAAI,EAAC,EAFK;AAGVxK,cAAAA,IAAI,EAAEP,GAAG,CAACwQ,KAAJ,CAAUE,QAAV,CAAmBzK,CAAnB,CAHI;AAIVkD,cAAAA,OAAO,EAAE,MAJC;AAKV9C,cAAAA,KAAK,EAAErG,GAAG,CAACyP,IAAJ,CAASC,KALN;AAMVtJ,cAAAA,KAAK,EAAEpG,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,GAAe,CANZ;AAOVa,cAAAA,MAAM,EAAEjH,GAAG,CAACyP,IAAJ,CAASxI,MAPP;AAQVtC,cAAAA,CAAC,EAAEA,CARO;AASVC,cAAAA,CAAC,EAAE,CATO;AAUVC,cAAAA,CAAC,EAAE7E,GAAG,CAACyP,IAAJ,CAASpJ,KAAT,GAAe,CAAf,GAAiBrG,GAAG,CAACyP,IAAJ,CAASC,KAAT,GAAe,CAAhC,GAAkC,CAV3B;AAWV7I,cAAAA,KAAK,EAAE;AACHqD,gBAAAA,SAAS,EAAElK,GAAG,CAACwQ,KAAJ,CAAUC,KAAV,CAAgBxK,CAAhB,EAAmBiE,SAD3B;AAEHc,gBAAAA,IAAI,EAAEhL,GAAG,CAACwQ,KAAJ,CAAUC,KAAV,CAAgBxK,CAAhB;AAFH;AAXG,aAAd;AAgBA,gBAAI2K,QAAQ,GAAG,KAAKxH,UAAL,CAAgBuH,OAAhB,CAAf;AACAX,YAAAA,OAAO,CAAClL,GAAR,CAAY8L,QAAZ;AACA,iBAAKvH,SAAL,CAAeuH,QAAf,EAAwB,QAAxB;AACH;AACJ;AACJ,OAnKkB,CAoKnB;;;AACA,UAAG,KAAK/H,UAAL,CAAgB9I,MAAhB,CAAuBC,GAAG,CAACkQ,IAA3B,CAAH,EAAoC;AAChC;AACA,YAAI9J,KAAK,GAACpG,GAAG,CAACyP,IAAJ,CAASrJ,KAAT,IAAgB,EAA1B;AACA,YAAIa,MAAM,GAACjH,GAAG,CAACyP,IAAJ,CAASxI,MAAT,IAAiB,EAA5B;AACA,YAAI6J,MAAM,GAAGxO,QAAQ,CAACqE,aAAT,CAAuB,QAAvB,CAAb;AACAmK,QAAAA,MAAM,CAAC,OAAD,CAAN,GAAgB1K,KAAhB;AACA0K,QAAAA,MAAM,CAAC,QAAD,CAAN,GAAiB7J,MAAjB;AACA,YAAI8J,OAAO,GAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAd;AACAD,QAAAA,OAAO,CAACE,SAAR;AACAF,QAAAA,OAAO,CAACG,IAAR,CAAa,CAAb,EAAgB,CAAhB,EAAmB9K,KAAnB,EAA0Ba,MAA1B;AACA8J,QAAAA,OAAO,CAACI,SAAR,GAAoB,wBAApB,CAVgC,CAUe;;AAC/CJ,QAAAA,OAAO,CAACK,IAAR;;AAEA,YAAIC,MAAM,GAAC,SAAPA,MAAO,CAASN,OAAT,EAAkBpM,CAAlB,EAAqBC,CAArB,EAAuB0M,IAAvB,EAA4B;AACnC,cAAI1J,KAAK,GAAC,SAAV;AACAmJ,UAAAA,OAAO,CAACQ,IAAR,GAAe,KAAG,uBAAlB;AACAR,UAAAA,OAAO,CAACI,SAAR,GAAoBvJ,KAApB;AACAmJ,UAAAA,OAAO,CAACzJ,SAAR,GAAoB,QAApB;AACAyJ,UAAAA,OAAO,CAACS,YAAR,GAAuB,QAAvB;AACAT,UAAAA,OAAO,CAACU,WAAR,GAAoB7J,KAApB;AACAmJ,UAAAA,OAAO,CAACW,QAAR,CAAiBJ,IAAjB,EAAuB3M,CAAvB,EAA0BC,CAA1B;AACH,SARD;;AASAyM,QAAAA,MAAM,CAACN,OAAD,EAAU3K,KAAK,GAAC,CAAhB,EAAmBa,MAAM,GAAC,CAA1B,EAA6BjH,GAAG,CAACkQ,IAAJ,CAAS3P,IAAtC,CAAN;AACA,YAAIoR,QAAQ,GAAC;AACTvL,UAAAA,KAAK,EAACA,KADG;AAETa,UAAAA,MAAM,EAACA,MAFE;AAGT2K,UAAAA,MAAM,EAACd,MAHE;AAITlM,UAAAA,CAAC,EAAC5E,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,CAAhB,GAAkB,CAJX;AAKT4K,UAAAA,WAAW,EAAC,IALH;AAMT7J,UAAAA,OAAO,EAAC,GANC;AAOT8C,UAAAA,QAAQ,EAAE,CAAC;AAAEiE,YAAAA,SAAS,EAAE,GAAb;AAAkBE,YAAAA,MAAM,EAAE,CAAC,GAAD,GAAKpO,IAAI,CAACiR;AAApC,WAAD;AAPD,SAAb;AASA,YAAIR,IAAI,GAAC,KAAKS,mBAAL,CAAyBJ,QAAzB,CAAT;AACA3B,QAAAA,OAAO,CAAClL,GAAR,CAAYwM,IAAZ,EAjCgC,CAkChC;AAGH;;AACD,UAAI,KAAKzI,UAAL,CAAgB9I,MAAhB,CAAuBC,GAAG,CAACkL,SAA3B,KAAyClL,GAAG,CAACkL,SAAJ,CAAclF,MAAd,GAAuB,CAApE,EAAuE;AACnE,YAAIgM,aAAa,GAAC,EAAlB;AACAhS,QAAAA,GAAG,CAACkL,SAAJ,CAAc7K,OAAd,CAAsB,UAAS4R,OAAT,EAAkB3R,KAAlB,EAAwB;AAC1C,cAAI4R,WAAW,GAACD,OAAO,CAAClH,IAAR,IAAcjL,KAAK,CAAC+I,UAAN,CAAiBlI,IAAjB,EAA9B;;AACAsR,UAAAA,OAAO,CAACtN,CAAR,GAAU3E,GAAG,CAAC2E,CAAd;AACAsN,UAAAA,OAAO,CAACpN,CAAR,GAAU7E,GAAG,CAAC6E,CAAd;AACAoN,UAAAA,OAAO,CAACrN,CAAR,GAAUqN,OAAO,CAACrN,CAAR,GAAU2K,WAAV,IAAuBvP,GAAG,CAAC4E,CAAJ,GAAM,CAAC5E,GAAG,CAACyP,IAAJ,CAASxI,MAAT,GAAgB,IAAEjH,GAAG,CAACyP,IAAJ,CAASC,KAA5B,IAAmC,CAAhE,CAAV;AACAuC,UAAAA,OAAO,CAACnH,QAAR,GAAiB9K,GAAG,CAAC8K,QAAJ,IAAc,IAA/B;;AACA,cAAIM,MAAM,GAAGtL,KAAK,CAACsJ,UAAN,CAAiB6I,OAAjB,CAAb;;AACA7G,UAAAA,MAAM,CAAC8E,IAAP,GAAY+B,OAAO,CAAC/B,IAApB;AACA9E,UAAAA,MAAM,CAAC8E,IAAP,CAAY,aAAZ,IAA2BnF,IAA3B;AACAK,UAAAA,MAAM,CAACL,IAAP,GAAYmH,WAAZ;AACAF,UAAAA,aAAa,CAACxF,IAAd,CAAmB0F,WAAnB;;AACApS,UAAAA,KAAK,CAACuJ,SAAN,CAAgB+B,MAAhB;;AACAtL,UAAAA,KAAK,CAACoC,SAAN,CAAgBsK,IAAhB,CAAqBpB,MAArB;AACH,SAbD;AAcA4E,QAAAA,OAAO,CAACE,IAAR,CAAa,eAAb,IAA8B8B,aAA9B;AACH;;AACD,UAAIhS,GAAG,CAAC8K,QAAJ,IAAgB,IAAhB,IAAwB,OAAQ9K,GAAG,CAAC8K,QAAZ,IAAyB,WAAjD,IAAgE9K,GAAG,CAAC8K,QAAJ,CAAa9E,MAAb,GAAsB,CAA1F,EAA6F;AACzFhG,QAAAA,GAAG,CAAC8K,QAAJ,CAAazK,OAAb,CAAqB,UAASyO,YAAT,EAAuBxO,KAAvB,EAA6B;AAC9C;AACA,kBAAQwO,YAAY,CAACC,SAArB;AACI,iBAAK,GAAL;AACIiB,cAAAA,OAAO,CAAChB,OAAR,CAAgBF,YAAY,CAACG,MAA7B;AACA;;AACJ,iBAAK,GAAL;AACIe,cAAAA,OAAO,CAACd,OAAR,CAAgBJ,YAAY,CAACG,MAA7B;AACA;;AACJ,iBAAK,GAAL;AACIe,cAAAA,OAAO,CAACb,OAAR,CAAgBL,YAAY,CAACG,MAA7B;AACA;;AACJ,iBAAK,KAAL;AAAa;AACTe,cAAAA,OAAO,CAACZ,YAAR,CAAqB,IAAIvQ,KAAK,CAACwQ,OAAV,CAAkBP,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlB,EAA0CH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAA1C,EAAkEH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlE,CAArB,EAAgHH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAhH;AACA;AAZR;AAcH,SAhBD;AAiBH;;AACD,aAAOe,OAAP;AAEH,K,CACD;;;;WACA,6BAAoBhQ,GAApB,EAAwB;AACpB,UAAIF,KAAK,GAAC,IAAV;;AACA,UAAIqS,SAAS,GAAGnS,GAAG,CAACmS,SAAJ,IAAiB,EAAjC,CAFoB,CAEkB;;AACtC,UAAIC,YAAY,GAAGpS,GAAG,CAACoS,YAAJ,IAAoB,EAAvC,CAHoB,CAGwB;;AAC5C,UAAInL,MAAM,GAACjH,GAAG,CAACiH,MAAJ,IAAc,GAAzB,CAJoB,CAIW;;AAC/B,UAAIoL,cAAc,GAACrS,GAAG,CAACqS,cAAJ,IAAoB,CAAvC;AACA,UAAIC,cAAc,GAACtS,GAAG,CAACsS,cAAJ,IAAoB,CAAvC;AACA,UAAIC,SAAS,GAAEvS,GAAG,CAACuS,SAAJ,IAAiB,KAAhC;AACA,UAAI5N,CAAC,GAAG3E,GAAG,CAAC2E,CAAJ,IAAS,CAAjB;AAAA,UAAoBC,CAAC,GAAG5E,GAAG,CAAC4E,CAAJ,IAAS,CAAjC;AAAA,UAAoCC,CAAC,GAAG7E,GAAG,CAAC6E,CAAJ,IAAS,CAAjD;AACA,UAAIqF,SAAS,GAAGlK,GAAG,CAAC6G,KAAJ,CAAUqD,SAAV,IAAuB,QAAvC,CAToB,CAUpB;;AACA,UAAIsI,WAAW,GAAG,IAAI3T,KAAK,CAAC4T,gBAAV,CAA2BN,SAA3B,EAAsCC,YAAtC,EAAoDnL,MAApD,EAA4DoL,cAA5D,EAA2EC,cAA3E,EAA0FC,SAA1F,CAAlB,CAXoB,CAYpB;;AACA,UAAIG,WAAW,GAAG,IAAI7T,KAAK,CAAC4N,mBAAV,CAA8B;AAAC;AAC7C7E,QAAAA,KAAK,EAACsC,SADsC;AAE5CyI,QAAAA,SAAS,EAAC;AAFkC,OAA9B,CAAlB,CAboB,CAiBpB;;AACA,UAAIC,QAAQ,GAAG,IAAI/T,KAAK,CAACoN,IAAV,CAAeuG,WAAf,EAA4BE,WAA5B,CAAf;AACAE,MAAAA,QAAQ,CAACpO,QAAT,CAAkBC,GAAlB,CAAsBE,CAAtB,EAAyBC,CAAzB,EAA4BC,CAA5B,EAnBoB,CAmBW;;AAC/B,UAAI,KAAKgE,UAAL,CAAgB9I,MAAhB,CAAuBC,GAAG,CAACkL,SAA3B,KAAyClL,GAAG,CAACkL,SAAJ,CAAclF,MAAd,GAAuB,CAApE,EAAuE;AACnEhG,QAAAA,GAAG,CAACkL,SAAJ,CAAc7K,OAAd,CAAsB,UAASwS,QAAT,EAAmBvS,KAAnB,EAAyB;AAC3C,cAAI8K,MAAJ;;AACA,cAAGyH,QAAQ,CAAC1J,OAAT,IAAkB,OAArB,EAA6B;AACzBiC,YAAAA,MAAM,GAAGtL,KAAK,CAACiS,mBAAN,CAA0Bc,QAA1B,CAAT;AACH,WAFD,MAEK;AACDzH,YAAAA,MAAM,GAAGtL,KAAK,CAACgT,mBAAN,CAA0BD,QAA1B,CAAT;AACH;;AACD/S,UAAAA,KAAK,CAACuJ,SAAN,CAAgB+B,MAAhB,EAAuB,OAAvB,EAP2C,CAQ3C;;AACH,SATD;AAUH;;AACD,aAAOwH,QAAP;AACH,K,CACD;;;;WACA,6BAAqB5S,GAArB,EAA0B;AACtB,UAAI+S,OAAJ;AACA,UAAIlB,WAAW,GAAC7R,GAAG,CAAC6R,WAApB;;AACA,UAAG7R,GAAG,CAAC6R,WAAJ,KAAkB,KAArB,EAA2B;AACvBA,QAAAA,WAAW,GAAC,IAAZ;AACH;;AACD,UAAI,OAAO7R,GAAG,CAAC4R,MAAX,IAAqB,QAAzB,EAAmC;AAAC;AAChC,YAAIoB,MAAM,GAAG,IAAInU,KAAK,CAACoU,aAAV,EAAb,CAD+B,CAE/B;;AACA,YAAIrB,MAAM,GAAC5R,GAAG,CAAC4R,MAAf;;AACA,YAAG5R,GAAG,CAAC4R,MAAJ,CAAWsB,OAAX,CAAmB,aAAnB,KAAmC,CAAC,CAAvC,EAAyC;AACrCtB,UAAAA,MAAM,GAAC,KAAK/I,UAAL,CAAgBrI,OAAhB,CAAwBR,GAAG,CAAC4R,MAA5B,CAAP;AACH;;AACDmB,QAAAA,OAAO,GAAGC,MAAM,CAACzL,IAAP,CAAYqK,MAAZ,EAAoB,YAAY,CAAG,CAAnC,EAAqCuB,SAArC,EAAgD,YAAY,CAAG,CAA/D,CAAV;AACH,OARD,MAQO;AACHJ,QAAAA,OAAO,GAAG,IAAIlU,KAAK,CAACuU,aAAV,CAAwBpT,GAAG,CAAC4R,MAA5B,CAAV;AACH;;AACD,UAAIyB,UAAU,GAAG;AAAC;AACd7M,QAAAA,GAAG,EAAEuM,OADQ;AAEbO,QAAAA,IAAI,EAAEtT,GAAG,CAACsT,IAAJ,IAAUzU,KAAK,CAAC0U,UAFT;AAGb;AACA1B,QAAAA,WAAW,EAAEA,WAJA;AAKb7J,QAAAA,OAAO,EAAEhI,GAAG,CAACgI,OAAJ,IAAa;AALT,OAAjB;;AAOA,UAAIhI,GAAG,CAACwT,QAAR,EAAkB;AACdH,QAAAA,UAAU,CAACG,QAAX,GAAsB3U,KAAK,CAAC4U,gBAA5B,CADc,CAC8B;AAC/C;;AACD,UAAIC,KAAK,GAAG,IAAI7U,KAAK,CAACoN,IAAV,CACR,IAAIpN,KAAK,CAAC8U,aAAV,CAAwB3T,GAAG,CAACoG,KAA5B,EAAmCpG,GAAG,CAACiH,MAAvC,EAA+C,CAA/C,EAAkD,CAAlD,CADQ,EAER,IAAIpI,KAAK,CAAC+U,iBAAV,CAA4BP,UAA5B,CAFQ,CAAZ;AAIAK,MAAAA,KAAK,CAAClP,QAAN,CAAeG,CAAf,GAAmB3E,GAAG,CAAC2E,CAAJ,IAAO,CAA1B;AACA+O,MAAAA,KAAK,CAAClP,QAAN,CAAeI,CAAf,GAAmB5E,GAAG,CAAC4E,CAAJ,IAAO,CAA1B;AACA8O,MAAAA,KAAK,CAAClP,QAAN,CAAeK,CAAf,GAAmB7E,GAAG,CAAC6E,CAAJ,IAAO,CAA1B;;AACA,UAAI7E,GAAG,CAAC8K,QAAJ,IAAgB,IAAhB,IAAwB,OAAQ9K,GAAG,CAAC8K,QAAZ,IAAyB,WAAjD,IAAgE9K,GAAG,CAAC8K,QAAJ,CAAa9E,MAAb,GAAsB,CAA1F,EAA6F;AACzFhG,QAAAA,GAAG,CAAC8K,QAAJ,CAAazK,OAAb,CAAqB,UAASyO,YAAT,EAAuBxO,KAAvB,EAA6B;AAC9C;AACA,kBAAQwO,YAAY,CAACC,SAArB;AACI,iBAAK,GAAL;AACI2E,cAAAA,KAAK,CAAC1E,OAAN,CAAcF,YAAY,CAACG,MAA3B;AACA;;AACJ,iBAAK,GAAL;AACIyE,cAAAA,KAAK,CAACxE,OAAN,CAAcJ,YAAY,CAACG,MAA3B;AACA;;AACJ,iBAAK,GAAL;AACIyE,cAAAA,KAAK,CAACvE,OAAN,CAAcL,YAAY,CAACG,MAA3B;AACA;;AACJ,iBAAK,KAAL;AAAa;AACTyE,cAAAA,KAAK,CAACtE,YAAN,CAAmB,IAAIvQ,KAAK,CAACwQ,OAAV,CAAkBP,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlB,EAA0CH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAA1C,EAAkEH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAAlE,CAAnB,EAA8GH,YAAY,CAACG,MAAb,CAAoB,CAApB,CAA9G;AACA;AAZR;AAcH,SAhBD;AAiBH;;AACD,aAAOyE,KAAP;AACH,K,CACD;;;;WACA,wBAAe1T,GAAf,EAAmB;AACf,UAAIF,KAAK,GAAC,IAAV;;AACA,UAAI+T,SAAS,GAAG,IAAI1U,SAAJ,EAAhB;AACA0U,MAAAA,SAAS,CAACtM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,iBAAzB,CAAf,EAA4D,UAASsT,SAAT,EAAoB;AAC5EA,QAAAA,SAAS,CAACC,OAAV;AACA,YAAIC,SAAS,GAAG,IAAIhV,SAAJ,EAAhB;AACAiV,QAAAA,OAAO,CAACC,GAAR,CAAYJ,SAAZ;AACAE,QAAAA,SAAS,CAACG,YAAV,CAAuBL,SAAvB;AACAE,QAAAA,SAAS,CAACzM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,iBAAzB,CAAf,EAA4D,UAAS4T,MAAT,EAAiB;AACzEpU,UAAAA,GAAG,CAACkL,SAAJ,CAAc7K,OAAd,CAAsB,UAASwS,QAAT,EAAkB;AACpC,gBAAIzH,MAAM,GAAGgJ,MAAM,CAACC,KAAP,EAAb;;AACA,gBAAG,CAACjJ,MAAM,CAACkJ,SAAX,EAAqB;AACjB,kBAAGzB,QAAQ,CAACyB,SAAZ,EAAsB;AAClBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBzB,QAAQ,CAACyB,SAA1B;AACH,eAFD,MAEM,IAAGtU,GAAG,CAACsU,SAAP,EAAiB;AACnBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBtU,GAAG,CAACsU,SAArB;AACH;AACJ;;AACDlJ,YAAAA,MAAM,GAACtL,KAAK,CAACyU,SAAN,CAAgBnJ,MAAhB,CAAP;AACAA,YAAAA,MAAM,CAAC5G,QAAP,CAAgBC,GAAhB,CAAoBoO,QAAQ,CAAClO,CAAT,IAAY,CAAhC,EAAmCkO,QAAQ,CAACjO,CAAT,IAAY,CAA/C,EAAkDiO,QAAQ,CAAChO,CAAT,IAAY,CAA9D;;AACA/E,YAAAA,KAAK,CAACkC,KAAN,CAAY8C,GAAZ,CAAiBsG,MAAjB;AACH,WAZD;AAaAtL,UAAAA,KAAK,CAACqD,eAAN,IAAuB,CAAvB;AACH,SAfD,EAeGrD,KAAK,CAAC0U,UAfT,EAeqB1U,KAAK,CAAC2U,OAf3B;AAgBH,OArBD;AAsBH,K,CACD;;;;WACA,wBAAgBzU,GAAhB,EAAqB;AACjB,UAAIF,KAAK,GAAC,IAAV;;AACA,UAAI+T,SAAS,GAAG,IAAI1U,SAAJ,EAAhB;AACA0U,MAAAA,SAAS,CAACtM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,iBAAzB,CAAf,EAA4D,UAASsT,SAAT,EAAoB;AAC5EA,QAAAA,SAAS,CAACC,OAAV;AACA,YAAIC,SAAS,GAAG,IAAIhV,SAAJ,EAAhB;AACAgV,QAAAA,SAAS,CAACG,YAAV,CAAuBL,SAAvB;AACAE,QAAAA,SAAS,CAACzM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,iBAAzB,CAAf,EAA4D,UAAS4T,MAAT,EAAiB;AAEzEpU,UAAAA,GAAG,CAACkL,SAAJ,CAAc7K,OAAd,CAAsB,UAASwS,QAAT,EAAkB;AACpC,gBAAIzH,MAAM,GAAGgJ,MAAM,CAACC,KAAP,EAAb;;AACA,gBAAG,CAACjJ,MAAM,CAACkJ,SAAX,EAAqB;AACjB,kBAAGzB,QAAQ,CAACyB,SAAZ,EAAsB;AAClBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBzB,QAAQ,CAACyB,SAA1B;AACH,eAFD,MAEM,IAAGtU,GAAG,CAACsU,SAAP,EAAiB;AACnBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBtU,GAAG,CAACsU,SAArB;AACH;AACJ;;AACDlJ,YAAAA,MAAM,GAACtL,KAAK,CAACyU,SAAN,CAAgBnJ,MAAhB,CAAP;AACAA,YAAAA,MAAM,CAAC5G,QAAP,CAAgBC,GAAhB,CAAoBoO,QAAQ,CAAClO,CAAT,IAAY,CAAhC,EAAmCkO,QAAQ,CAACjO,CAAT,IAAY,CAA/C,EAAkDiO,QAAQ,CAAChO,CAAT,IAAY,CAA9D;;AACA/E,YAAAA,KAAK,CAACkC,KAAN,CAAY8C,GAAZ,CAAiBsG,MAAjB;AACH,WAZD;AAaAtL,UAAAA,KAAK,CAACqD,eAAN,IAAuB,CAAvB;AACH,SAhBD,EAgBGrD,KAAK,CAAC0U,UAhBT,EAgBqB1U,KAAK,CAAC2U,OAhB3B;AAiBH,OArBD;AAsBH,K,CACD;;;;WACA,uBAAezU,GAAf,EAAoB;AAChB,UAAIF,KAAK,GAAC,IAAV;;AACA,UAAI+T,SAAS,GAAG,IAAI1U,SAAJ,EAAhB;AACA0U,MAAAA,SAAS,CAACtM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,eAAzB,CAAf,EAA0D,UAASsT,SAAT,EAAoB;AAC1E;AACA;AACA;AACAA,QAAAA,SAAS,CAACC,OAAV;AACA,YAAIC,SAAS,GAAG,IAAIhV,SAAJ,EAAhB;AAEAgV,QAAAA,SAAS,CAACG,YAAV,CAAuBL,SAAvB;AAEAE,QAAAA,SAAS,CAACzM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,eAAzB,CAAf,EAA0D,UAAS4T,MAAT,EAAiB;AAEvEpU,UAAAA,GAAG,CAACkL,SAAJ,CAAc7K,OAAd,CAAsB,UAASwS,QAAT,EAAkB;AACpC,gBAAIzH,MAAM,GAAGgJ,MAAM,CAACC,KAAP,EAAb;;AACA,gBAAG,CAACjJ,MAAM,CAACkJ,SAAX,EAAqB;AACjB,kBAAGzB,QAAQ,CAACyB,SAAZ,EAAsB;AAClBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBzB,QAAQ,CAACyB,SAA1B;AACH,eAFD,MAEM,IAAGtU,GAAG,CAACsU,SAAP,EAAiB;AACnBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBtU,GAAG,CAACsU,SAArB;AACH;AACJ;;AACDlJ,YAAAA,MAAM,GAACtL,KAAK,CAACyU,SAAN,CAAgBnJ,MAAhB,CAAP;AACAA,YAAAA,MAAM,CAAC5G,QAAP,CAAgBC,GAAhB,CAAoBoO,QAAQ,CAAClO,CAAT,IAAY,CAAhC,EAAmCkO,QAAQ,CAACjO,CAAT,IAAY,CAA/C,EAAkDiO,QAAQ,CAAChO,CAAT,IAAY,CAA9D;;AACA/E,YAAAA,KAAK,CAACkC,KAAN,CAAY8C,GAAZ,CAAiBsG,MAAjB;AACH,WAZD;AAaAtL,UAAAA,KAAK,CAACqD,eAAN,IAAuB,CAAvB;AACH,SAhBD,EAgBGrD,KAAK,CAAC0U,UAhBT,EAgBqB1U,KAAK,CAAC2U,OAhB3B;AAiBH,OA1BD;AA2BH,K,CACD;;;;WACA,8BAAqBzU,GAArB,EAAyB;AACrB,UAAIF,KAAK,GAAC,IAAV;;AACA,UAAI+T,SAAS,GAAG,IAAI1U,SAAJ,EAAhB;AACA0U,MAAAA,SAAS,CAACtM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,6BAAzB,CAAf,EAAwE,UAASsT,SAAT,EAAoB;AACxFA,QAAAA,SAAS,CAACC,OAAV;AACA,YAAIC,SAAS,GAAG,IAAIhV,SAAJ,EAAhB;AACAgV,QAAAA,SAAS,CAACG,YAAV,CAAuBL,SAAvB;AACAE,QAAAA,SAAS,CAACzM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,6BAAzB,CAAf,EAAwE,UAAS4T,MAAT,EAAiB;AACrFpU,UAAAA,GAAG,CAACkL,SAAJ,CAAc7K,OAAd,CAAsB,UAASwS,QAAT,EAAkB;AACpC,gBAAIzH,MAAM,GAAGgJ,MAAM,CAACC,KAAP,EAAb;;AACA,gBAAG,CAACjJ,MAAM,CAACkJ,SAAX,EAAqB;AACjB,kBAAGzB,QAAQ,CAACyB,SAAZ,EAAsB;AAClBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBzB,QAAQ,CAACyB,SAA1B;AACH,eAFD,MAEM,IAAGtU,GAAG,CAACsU,SAAP,EAAiB;AACnBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBtU,GAAG,CAACsU,SAArB;AACH;AACJ;;AACDlJ,YAAAA,MAAM,GAACtL,KAAK,CAACyU,SAAN,CAAgBnJ,MAAhB,CAAP;AACAA,YAAAA,MAAM,CAAC5G,QAAP,CAAgBC,GAAhB,CAAoBoO,QAAQ,CAAClO,CAAT,IAAY,CAAhC,EAAmCkO,QAAQ,CAACjO,CAAT,IAAY,CAA/C,EAAkDiO,QAAQ,CAAChO,CAAT,IAAY,CAA9D;;AACA/E,YAAAA,KAAK,CAACkC,KAAN,CAAY8C,GAAZ,CAAiBsG,MAAjB;AACH,WAZD;AAaAtL,UAAAA,KAAK,CAACqD,eAAN,IAAuB,CAAvB;AACH,SAfD,EAeGrD,KAAK,CAAC0U,UAfT,EAeqB1U,KAAK,CAAC2U,OAf3B;AAgBH,OApBD;AAqBH,K,CACD;;;;WACA,yBAAgBzU,GAAhB,EAAoB;AAChB,UAAIF,KAAK,GAAC,IAAV;;AACA,UAAI+T,SAAS,GAAG,IAAI1U,SAAJ,EAAhB;AACA0U,MAAAA,SAAS,CAACtM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,mBAAzB,CAAf,EAA8D,UAASsT,SAAT,EAAoB;AAC9EA,QAAAA,SAAS,CAACC,OAAV;AACA,YAAIC,SAAS,GAAG,IAAIhV,SAAJ,EAAhB;AACAgV,QAAAA,SAAS,CAACG,YAAV,CAAuBL,SAAvB;AACAE,QAAAA,SAAS,CAACzM,IAAV,CAAezH,KAAK,CAAC+I,UAAN,CAAiBrI,OAAjB,CAAyB,mBAAzB,CAAf,EAA8D,UAAS4T,MAAT,EAAiB;AAC3EpU,UAAAA,GAAG,CAACkL,SAAJ,CAAc7K,OAAd,CAAsB,UAASwS,QAAT,EAAkB;AACpC,gBAAIzH,MAAM,GAAGgJ,MAAM,CAACC,KAAP,EAAb;;AACA,gBAAG,CAACjJ,MAAM,CAACkJ,SAAX,EAAqB;AACjB,kBAAGzB,QAAQ,CAACyB,SAAZ,EAAsB;AAClBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBzB,QAAQ,CAACyB,SAA1B;AACH,eAFD,MAEM,IAAGtU,GAAG,CAACsU,SAAP,EAAiB;AACnBlJ,gBAAAA,MAAM,CAACkJ,SAAP,GAAiBtU,GAAG,CAACsU,SAArB;AACH;AACJ;;AACDlJ,YAAAA,MAAM,GAACtL,KAAK,CAACyU,SAAN,CAAgBnJ,MAAhB,CAAP;AACAA,YAAAA,MAAM,CAAC5G,QAAP,CAAgBC,GAAhB,CAAoBoO,QAAQ,CAAClO,CAAT,IAAY,CAAhC,EAAmCkO,QAAQ,CAACjO,CAAT,IAAY,CAA/C,EAAkDiO,QAAQ,CAAChO,CAAT,IAAY,CAA9D;;AACA/E,YAAAA,KAAK,CAACkC,KAAN,CAAY8C,GAAZ,CAAiBsG,MAAjB;AACH,WAZD;AAaAtL,UAAAA,KAAK,CAACqD,eAAN,IAAuB,CAAvB;AACH,SAfD,EAeGrD,KAAK,CAAC0U,UAfT,EAeqB1U,KAAK,CAAC2U,OAf3B;AAgBH,OApBD;AAqBH;;;WACD,mBAAUzU,GAAV,EAAc;AACV,UAAIA,GAAG,CAACsU,SAAJ,IAAiB,IAAjB,IAAyB,OAAQtU,GAAG,CAACsU,SAAZ,IAA0B,WAAnD,IAAkEtU,GAAG,CAACsU,SAAJ,CAActO,MAAd,GAAuB,CAA7F,EAAgG;AAC5FhG,QAAAA,GAAG,CAACsU,SAAJ,CAAcjU,OAAd,CAAsB,UAASwS,QAAT,EAAkB;AACpC;AACA,kBAAQA,QAAQ,CAAC9D,SAAjB;AACI,iBAAK,GAAL;AACI,kBAAG8D,QAAQ,CAAC6B,KAAZ,EAAkB;AACd1U,gBAAAA,GAAG,CAAC2U,KAAJ,CAAUhQ,CAAV,GAAYkO,QAAQ,CAAC6B,KAArB;AACH;;AACD,kBAAG7B,QAAQ,CAAC5D,MAAZ,EAAmB;AACfjP,gBAAAA,GAAG,CAACgP,OAAJ,CAAY6D,QAAQ,CAAC5D,MAArB;AACH;;AACD;;AACJ,iBAAK,GAAL;AACI,kBAAG4D,QAAQ,CAAC6B,KAAZ,EAAkB;AACd1U,gBAAAA,GAAG,CAAC2U,KAAJ,CAAU/P,CAAV,GAAYiO,QAAQ,CAAC6B,KAArB;AACH;;AACD,kBAAG7B,QAAQ,CAAC5D,MAAZ,EAAmB;AACfjP,gBAAAA,GAAG,CAACkP,OAAJ,CAAY2D,QAAQ,CAAC5D,MAArB;AACH;;AACD;;AACJ,iBAAK,GAAL;AACI,kBAAG4D,QAAQ,CAAC6B,KAAZ,EAAkB;AACd1U,gBAAAA,GAAG,CAAC2U,KAAJ,CAAU9P,CAAV,GAAYgO,QAAQ,CAAC6B,KAArB;AACH;;AACD,kBAAG7B,QAAQ,CAAC5D,MAAZ,EAAmB;AACfjP,gBAAAA,GAAG,CAACmP,OAAJ,CAAY0D,QAAQ,CAAC5D,MAArB;AACH;;AACD;;AACJ,iBAAK,KAAL;AAAa;AACT,kBAAG4D,QAAQ,CAAC+B,WAAT,IAAsB/B,QAAQ,CAAC+B,WAAT,CAAqB5O,MAArB,IAA6B,CAAtD,EAAwD;AACpDhG,gBAAAA,GAAG,CAAC2U,KAAJ,CAAUlQ,GAAV,CAAcoO,QAAQ,CAAC+B,WAAT,CAAqB,CAArB,CAAd,EAAsC/B,QAAQ,CAAC+B,WAAT,CAAqB,CAArB,CAAtC,EAA8D/B,QAAQ,CAAC+B,WAAT,CAAqB,CAArB,CAA9D;AACH;;AACD,kBAAG/B,QAAQ,CAACgC,YAAT,IAAuBhC,QAAQ,CAACgC,YAAT,CAAsB7O,MAAtB,IAA8B,CAAxD,EAA0D;AACtDhG,gBAAAA,GAAG,CAACoP,YAAJ,CAAiB,IAAIvQ,KAAK,CAACwQ,OAAV,CAAkBwD,QAAQ,CAACgC,YAAT,CAAsB,CAAtB,CAAlB,EAA2ChC,QAAQ,CAACgC,YAAT,CAAsB,CAAtB,CAA3C,EAAoEhC,QAAQ,CAACgC,YAAT,CAAsB,CAAtB,CAApE,CAAjB,EAAgHhC,QAAQ,CAACgC,YAAT,CAAsB,CAAtB,CAAhH;AACH;;AACD;AAhCR;AAkCH,SApCD;AAqCH;;AACD,aAAO7U,GAAP;AACH,K,CACD;;;;WASA;AACA,yBAAYA,GAAZ,EAAgB2E,CAAhB,EAAkBC,CAAlB,EAAoBC,CAApB,EAAsB;AAClB,UAAImL,OAAO,GAAG,IAAInR,KAAK,CAACoR,QAAV,EAAd;AACAD,MAAAA,OAAO,CAACxL,QAAR,CAAiBC,GAAjB,CAAqBzE,GAAG,CAACwE,QAAJ,CAAaG,CAAb,GAAiBA,CAAtC,EAA0C3E,GAAG,CAACwE,QAAJ,CAAaI,CAAb,GAAeA,CAAzD,EAA4D5E,GAAG,CAACwE,QAAJ,CAAaK,CAAb,GAAeA,CAA3E;AACA7E,MAAAA,GAAG,CAACwE,QAAJ,CAAaC,GAAb,CAAiB,CAACE,CAAlB,EAAqB,CAACC,CAAtB,EAAyB,CAACC,CAA1B;AACAmL,MAAAA,OAAO,CAAClL,GAAR,CAAY9E,GAAZ;AACA,aAAOgQ,OAAP;AACH,K,CACD;;;;WACA,mBAAWhQ,GAAX,EAAe8U,IAAf,EAAqB;AACjB,UAAGA,IAAH,EAAQ;AACJ,YAAGA,IAAI,IAAE,QAAT,EAAkB;AACd,eAAK1U,OAAL,CAAaoM,IAAb,CAAkBxM,GAAlB;AACH;;AACD,YAAG8U,IAAI,IAAE,OAAT,EAAiB;AACb,eAAK9S,KAAL,CAAW8C,GAAX,CAAe9E,GAAf;AACH;AACJ,OAPD,MAOK;AACD,aAAKI,OAAL,CAAaoM,IAAb,CAAkBxM,GAAlB;AACA,aAAKgC,KAAL,CAAW8C,GAAX,CAAe9E,GAAf;AACH;AACJ,K,CACD;;;;WACA,0BAAkBoG,KAAlB,EAAwBa,MAAxB,EAAgCjH,GAAhC,EAAqCiL,IAArC,EAA0C8J,SAA1C,EAAqDC,WAArD,EAAkE;AAC9D,UAAI,KAAKnM,UAAL,CAAgB9I,MAAhB,CAAuBC,GAAvB,CAAJ,EAAiC;AAC7B,YAAI,KAAK6I,UAAL,CAAgB9I,MAAhB,CAAuBC,GAAG,CAACiV,MAA3B,CAAJ,EAAwC;AACpC,cAAI5B,UAAU,GAAC;AACXzL,YAAAA,KAAK,EAACmN,SADK;AAEXvO,YAAAA,GAAG,EAAE,KAAK0O,UAAL,CAAgB9O,KAAhB,EAAuBa,MAAvB,EAA+BjH,GAA/B,CAFM;AAGXgI,YAAAA,OAAO,EAAEhI,GAAG,CAACgI,OAAJ,IAAa;AAHX,WAAf;;AAKA,cAAGhI,GAAG,CAAC6R,WAAP,EAAmB;AACfwB,YAAAA,UAAU,CAACxB,WAAX,GAAuB7R,GAAG,CAAC6R,WAA3B;AACH;;AACD,cAAI7R,GAAG,CAACwT,QAAR,EAAkB;AACdH,YAAAA,UAAU,CAACG,QAAX,GAAsB3U,KAAK,CAAC4U,gBAA5B,CADc,CAC8B;AAC/C;;AACD,iBAAOJ,UAAP;AACH,SAbD,MAaO;AACH,cAAI,KAAKxK,UAAL,CAAgB9I,MAAhB,CAAuBC,GAAG,CAACkK,SAA3B,CAAJ,EAA2C;AACvCe,YAAAA,IAAI,CAACqC,KAAL,CAAW0H,WAAX,EAAwBpN,KAAxB,CAA8B8F,MAA9B,CAAqC1N,GAAG,CAACkK,SAAzC;AACAe,YAAAA,IAAI,CAACqC,KAAL,CAAW0H,WAAW,GAAG,CAAzB,EAA4BpN,KAA5B,CAAkC8F,MAAlC,CAAyC1N,GAAG,CAACkK,SAA7C;AACH;;AACD,iBAAO;AACHwC,YAAAA,YAAY,EAAE7N,KAAK,CAAC8N;AADjB,WAAP;AAGH;AACJ,OAvBD,MAuBO;AACH,eAAO;AACHD,UAAAA,YAAY,EAAE7N,KAAK,CAAC8N;AADjB,SAAP;AAGH;AACJ,K,CACD;;;;WACA,oBAAYvG,KAAZ,EAAkBa,MAAlB,EAAyBjH,GAAzB,EAA8B;AAC1B,UAAImV,QAAQ,GAAG,GAAf;AAAA,UAAmBC,SAAS,GAAC,GAA7B;;AACA,UAAIpV,GAAG,CAACoG,KAAJ,IAAa,IAAb,IAAoB,OAAQpG,GAAG,CAACoG,KAAZ,IAAsB,WAA9C,EAA2D;AACvD+O,QAAAA,QAAQ,GAAGnV,GAAG,CAACoG,KAAf;AACH;;AACD,UAAIpG,GAAG,CAACiH,MAAJ,IAAc,IAAd,IAAsB,OAAQjH,GAAG,CAACiH,MAAZ,IAAuB,WAAjD,EAA8D;AAC1DmO,QAAAA,SAAS,GAAGpV,GAAG,CAACiH,MAAhB;AACH;;AACD,UAAI8L,OAAO,GAAG,IAAIlU,KAAK,CAACoU,aAAV,GAA0B1L,IAA1B,CAA+B,KAAKsB,UAAL,CAAgBrI,OAAhB,CAAwBR,GAAG,CAACiV,MAA5B,CAA/B,CAAd;AACA,UAAII,MAAM,GAAG,KAAb;;AACA,UAAIrV,GAAG,CAACsV,OAAJ,IAAe,IAAf,IAAuB,OAAQtV,GAAG,CAACsV,OAAZ,IAAwB,WAA/C,IAA8DtV,GAAG,CAACsV,OAAJ,IAAa,IAA/E,EAAqF;AACjFvC,QAAAA,OAAO,CAACwC,KAAR,GAAgB1W,KAAK,CAAC2W,cAAtB;AACAH,QAAAA,MAAM,GAAG,IAAT;AACH;;AACD,UAAIrV,GAAG,CAACyV,OAAJ,IAAe,IAAf,IAAuB,OAAQzV,GAAG,CAACyV,OAAZ,IAAwB,WAA/C,IAA8DzV,GAAG,CAACyV,OAAJ,IAAe,IAAjF,EAAuF;AACnF1C,QAAAA,OAAO,CAAC2C,KAAR,GAAgB7W,KAAK,CAAC2W,cAAtB;AACAH,QAAAA,MAAM,GAAG,IAAT;AACH;;AACD,UAAIA,MAAJ,EAAY;AACRtC,QAAAA,OAAO,CAACsC,MAAR,CAAe5Q,GAAf,CAAmB2B,KAAK,GAAG+O,QAA3B,EAAqClO,MAAM,GAAGmO,SAA9C;AACH;;AACD,aAAOrC,OAAP;AACH,K,CACD;;;;WACA,oBAAW4C,UAAX,EAAsBpG,WAAtB,EAAkC;AAC9B,UAAIuB,MAAM,GAAGxO,QAAQ,CAACqE,aAAT,CAAuB,QAAvB,CAAb;AACNmK,MAAAA,MAAM,CAAC,OAAD,CAAN,GAAgB,IAAhB;AACAA,MAAAA,MAAM,CAAC,QAAD,CAAN,GAAiB,IAAjB;AACA,UAAIC,OAAO,GAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAd;AACAD,MAAAA,OAAO,CAACE,SAAR;AACMF,MAAAA,OAAO,CAACG,IAAR,CAAa,CAAb,EAAgB,CAAhB,EAAmB,IAAnB,EAAyB,IAAzB;AACAH,MAAAA,OAAO,CAACI,SAAR,GAAoB,wBAApB,CAP8B,CAOiB;;AACrDJ,MAAAA,OAAO,CAACK,IAAR;;AAEA,UAAIC,MAAM,GAAC,SAAPA,MAAO,CAASN,OAAT,EAAkBO,IAAlB,EAAwBsE,KAAxB,EAA+BjR,CAA/B,EAAkCC,CAAlC,EAAoC;AAC9C,YAAIgD,KAAK,GAAC,SAAV,CAD8C,CAC1B;;AACpBmJ,QAAAA,OAAO,CAACQ,IAAR,GAAe,KAAG,uBAAlB;AACAR,QAAAA,OAAO,CAACI,SAAR,GAAoBvJ,KAApB;AACAmJ,QAAAA,OAAO,CAACzJ,SAAR,GAAoB,QAApB;AACAyJ,QAAAA,OAAO,CAACS,YAAR,GAAuB,QAAvB,CAL8C,CAM9C;;AACAT,QAAAA,OAAO,CAACU,WAAR,GAAoB7J,KAApB;AACAmJ,QAAAA,OAAO,CAAC8E,SAAR,GAAkB,CAAlB;AACS9E,QAAAA,OAAO,CAAC+E,UAAR,CAAmBxE,IAAnB,EAAyB3M,CAAzB,EAA4BC,CAA5B;AAET,YAAG,CAACgR,KAAJ,EAAW;AACXhR,QAAAA,CAAC,IAAE,EAAH;AACAgD,QAAAA,KAAK,GAAC,SAAN;AACAmJ,QAAAA,OAAO,CAACQ,IAAR,GAAe,KAAG,uBAAlB;AACAR,QAAAA,OAAO,CAACI,SAAR,GAAoBvJ,KAApB;AACAmJ,QAAAA,OAAO,CAACzJ,SAAR,GAAoB,QAApB;AACAyJ,QAAAA,OAAO,CAACS,YAAR,GAAuB,QAAvB;AACAT,QAAAA,OAAO,CAACW,QAAR,CAAiBkE,KAAjB,EAAwBjR,CAAxB,EAA2BC,CAA3B;AACA,OAnBD;;AAoBAyM,MAAAA,MAAM,CAACN,OAAD,EAAU,MAAV,EAAkB,OAAlB,EAA2B,GAA3B,EAAgC,GAAhC,CAAN;AACAM,MAAAA,MAAM,CAACN,OAAD,EAAU,IAAV,EAAgB,eAAhB,EAAiC,GAAjC,EAAsC,GAAtC,CAAN;AACAM,MAAAA,MAAM,CAACN,OAAD,EAAU,QAAV,EAAoB,eAApB,EAAqC,GAArC,EAA0C,GAA1C,CAAN;AACM,UAAI/Q,GAAG,GAAC;AACJoG,QAAAA,KAAK,EAACmJ,WADF;AAEJtI,QAAAA,MAAM,EAAC0O,UAFH;AAGJ/D,QAAAA,MAAM,EAACd,MAHH;AAIJlM,QAAAA,CAAC,EAAC,CAJE;AAKJiN,QAAAA,WAAW,EAAC,IALR;AAMJ7J,QAAAA,OAAO,EAAC,GANJ;AAOJ8C,QAAAA,QAAQ,EAAE,CAAC;AAAEiE,UAAAA,SAAS,EAAE,GAAb;AAAkBE,UAAAA,MAAM,EAAE,CAAC,GAAD,GAAKpO,IAAI,CAACiR;AAApC,SAAD,EAA0C;AAAE/C,UAAAA,SAAS,EAAE,GAAb;AAAkBE,UAAAA,MAAM,EAAE,MAAIpO,IAAI,CAACiR;AAAnC,SAA1C;AAPN,OAAR;AASA,UAAIR,IAAI,GAAC,KAAKS,mBAAL,CAAyB/R,GAAzB,CAAT;AACA,WAAKgC,KAAL,CAAW8C,GAAX,CAAewM,IAAf;AACH,K,CACD;;;;WACA,2BAAkByE,GAAlB,EAAsB;AAClB,WAAI,IAAI9P,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAK/D,SAAL,CAAe8D,MAA7B,EAAoCC,CAAC,EAArC,EAAwC;AACpC,aAAI,IAAIuH,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACuI,GAAG,CAAC/P,MAAlB,EAAyBwH,CAAC,EAA1B,EAA6B;AACzB,cAAGuI,GAAG,CAACvI,CAAD,CAAH,CAAOwI,KAAP,IAAc,KAAK9T,SAAL,CAAe+D,CAAf,EAAkBiK,IAAlB,CAAuB8F,KAArC,IAA4CD,GAAG,CAACvI,CAAD,CAAH,CAAOyI,OAAP,IAAgB,KAAK/T,SAAL,CAAe+D,CAAf,EAAkBiK,IAAlB,CAAuB+F,OAAtF,EAA8F;AAC1F,iBAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAK/T,MAAL,CAAY6D,MAA1B,EAAiCkQ,CAAC,EAAlC,EAAqC;AACjC,kBAAG,KAAK/T,MAAL,CAAY+T,CAAZ,EAAehG,IAAf,CAAoBiG,WAApB,IAAiC,KAAKjU,SAAL,CAAe+D,CAAf,EAAkBiK,IAAlB,CAAuBiG,WAA3D,EAAuE;AACnE,qBAAKC,qBAAL,CAA2BL,GAAG,CAACvI,CAAD,CAA9B,EAAkC0I,CAAlC,EAAoCjQ,CAApC;AACH;AACJ;AACJ;AACJ;AACJ;AACJ,K,CACD;;;;WACA,+BAAsBjG,GAAtB,EAA0BqW,WAA1B,EAAsCC,cAAtC,EAAqD;AACjD,UAAIP,GAAG,GAAC,KAAK5T,MAAL,CAAYkU,WAAZ,EAAyBnG,IAAzB,CAA8BC,SAAtC;AAEA,WAAKhO,MAAL,CAAYkU,WAAZ,EAAyBvJ,QAAzB,CAAkCtG,GAAlC;;AACA,UAAGxG,GAAG,CAACuW,OAAP,EAAe;AACX,YAAGC,MAAM,CAAC,KAAKrU,MAAL,CAAYkU,WAAZ,EAAyBnG,IAAzB,CAA8BuG,KAA/B,CAAN,GAA4CD,MAAM,CAACxW,GAAG,CAACyW,KAAL,CAArD,EAAiE;AAC7D,eAAKtU,MAAL,CAAYkU,WAAZ,EAAyBnG,IAAzB,CAA8BuG,KAA9B,GAAoCzW,GAAG,CAACyW,KAAxC;AACA,eAAKtU,MAAL,CAAYkU,WAAZ,EAAyBvJ,QAAzB,CAAkClF,KAAlC,CAAwCnD,GAAxC,CAA4C,KAAKlD,UAAL,CAAgB,UAAQvB,GAAG,CAACyW,KAA5B,CAA5C;AACH;;AACD,YAAIC,IAAI,GAAC,IAAT,CALW,CAKI;;AACf,aAAI,IAAIzQ,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC8P,GAAG,CAAC/P,MAAlB,EAAyBC,CAAC,EAA1B,EAA6B;AACzB,cAAG8P,GAAG,CAAC9P,CAAD,CAAH,CAAO+P,KAAP,IAAchW,GAAG,CAACgW,KAAlB,IAAyBD,GAAG,CAAC9P,CAAD,CAAH,CAAOgQ,OAAP,IAAgBjW,GAAG,CAACiW,OAAhD,EAAwD;AAAE;AACtDF,YAAAA,GAAG,CAACY,MAAJ,CAAW1Q,CAAX,EAAa,CAAb,EAAejG,GAAf;AACA0W,YAAAA,IAAI,GAAC,KAAL;AACH;AACJ;;AACD,YAAGA,IAAH,EAAQ;AACJX,UAAAA,GAAG,CAACvJ,IAAJ,CAASxM,GAAT;AACH;;AACD,YAAG,KAAKkC,SAAL,CAAeoU,cAAf,EAA+BxJ,QAA/B,CAAwC9G,MAAxC,GAA+C,CAAlD,EAAoD;AAChD,eAAI,IAAIC,EAAC,GAAC,CAAV,EAAYA,EAAC,GAAC,KAAK/D,SAAL,CAAeoU,cAAf,EAA+BxJ,QAA/B,CAAwC9G,MAAtD,EAA6DC,EAAC,EAA9D,EAAiE;AAC7D,iBAAK/D,SAAL,CAAeoU,cAAf,EAA+BxJ,QAA/B,CAAwC7G,EAAxC,EAA2C2B,KAA3C,CAAiDnD,GAAjD,CAAqD,KAAKlD,UAAL,CAAgB,UAAQvB,GAAG,CAACyW,KAA5B,CAArD;AACH;AACJ;;AACD,aAAKvU,SAAL,CAAeoU,cAAf,EAA+BpG,IAA/B,CAAoCqG,OAApC,GAA4C,IAA5C;AACA,aAAKpU,MAAL,CAAYkU,WAAZ,EAAyBO,OAAzB,GAAiC5W,GAAG,CAACuW,OAArC;AACA,YAAIzB,IAAI,GAAC9U,GAAG,CAACO,IAAJ,GAASP,GAAG,CAACmQ,SAAtB;AACA,aAAK0G,SAAL,CAAe/B,IAAf;AACH,OAxBD,MAwBK;AACD,YAAGiB,GAAG,CAAC/P,MAAJ,GAAW,CAAd,EAAgB;AACZ,eAAI,IAAIC,GAAC,GAAC,CAAV,EAAYA,GAAC,GAAC8P,GAAG,CAAC/P,MAAlB,EAAyBC,GAAC,EAA1B,EAA6B;AACzB,gBAAG8P,GAAG,CAAC9P,GAAD,CAAH,CAAO+P,KAAP,IAAchW,GAAG,CAACgW,KAAlB,IAAyBD,GAAG,CAAC9P,GAAD,CAAH,CAAOgQ,OAAP,IAAgBjW,GAAG,CAACiW,OAAhD,EAAwD;AACpDF,cAAAA,GAAG,CAACY,MAAJ,CAAW1Q,GAAX,EAAa,CAAb;AACH;AACJ;;AACD,cAAG8P,GAAG,CAAC/P,MAAJ,GAAW,CAAd,EAAgB;AACZ,gBAAI8Q,QAAQ,GAAC,EAAb;;AACA,iBAAI,IAAI7Q,GAAC,GAAC,CAAV,EAAYA,GAAC,GAAC8P,GAAG,CAAC/P,MAAlB,EAAyBC,GAAC,EAA1B,EAA6B;AACzB6Q,cAAAA,QAAQ,CAACtK,IAAT,CAAcuJ,GAAG,CAAC9P,GAAD,CAAH,CAAOwQ,KAArB;AACH;;AACD,gBAAIM,GAAG,GAAClW,IAAI,CAACkW,GAAL,OAAAlW,IAAI,EAAQiW,QAAR,CAAZ;AACA,iBAAK3U,MAAL,CAAYkU,WAAZ,EAAyBnG,IAAzB,CAA8BuG,KAA9B,GAAoCM,GAApC;AACA,iBAAK5U,MAAL,CAAYkU,WAAZ,EAAyBvJ,QAAzB,CAAkClF,KAAlC,CAAwCnD,GAAxC,CAA4C,KAAKlD,UAAL,CAAgB,UAAQwV,GAAxB,CAA5C;AACH,WARD,MAQK;AACD,iBAAK5U,MAAL,CAAYkU,WAAZ,EAAyBnG,IAAzB,CAA8BuG,KAA9B,GAAoC,GAApC;AACA,iBAAKtU,MAAL,CAAYkU,WAAZ,EAAyBO,OAAzB,GAAiC,KAAjC;AACH;AACJ;;AACD,YAAG,KAAK1U,SAAL,CAAeoU,cAAf,EAA+BxJ,QAA/B,CAAwC9G,MAAxC,GAA+C,CAAlD,EAAoD;AAChD,eAAI,IAAIC,GAAC,GAAC,CAAV,EAAYA,GAAC,GAAC,KAAK/D,SAAL,CAAeoU,cAAf,EAA+BxJ,QAA/B,CAAwC9G,MAAtD,EAA6DC,GAAC,EAA9D,EAAiE;AAC7D,iBAAK/D,SAAL,CAAeoU,cAAf,EAA+BxJ,QAA/B,CAAwC7G,GAAxC,EAA2C2B,KAA3C,CAAiDnD,GAAjD,CAAqD,SAArD;AACH;AACJ;AACJ;AACJ,K,CACD;;;;WACA,mBAAUqQ,IAAV,EAAe;AACX,UAAIkC,SAAS,GAAG,IAAIC,MAAM,CAACC,wBAAX,EAAhB;AACAF,MAAAA,SAAS,CAAC1F,IAAV,GAAewD,IAAf;AACAkC,MAAAA,SAAS,CAACG,IAAV,GAAe,OAAf,CAHW,CAGc;;AACzBH,MAAAA,SAAS,CAACI,KAAV,GAAgB,CAAhB,CAJW,CAIQ;;AACnBJ,MAAAA,SAAS,CAACK,IAAV,GAAe,CAAf,CALW,CAKQ;;AACnBL,MAAAA,SAAS,CAACM,MAAV,GAAiB,CAAjB,CANW,CAMU;;AACrBL,MAAAA,MAAM,CAACM,eAAP,CAAuBC,KAAvB,CAA6BR,SAA7B;AACH;;;;AAoCD;AACJ;AACA;AAEI;AACA,iCAAqBS,KAArB,EAA4B;AACxB,WAAKhV,OAAL;;AACA,UAAI3C,KAAK,GAAG,IAAZ;;AACA4H,MAAAA,UAAU,CAAC,YAAY;AAAE5H,QAAAA,KAAK,CAAC2C,OAAN,GAAe,CAAf;AAAiB,OAAhC,EAAkC,GAAlC,CAAV;AACAgV,MAAAA,KAAK,CAACC,cAAN;;AACA,UAAI,KAAKjV,OAAL,IAAgB,CAApB,EAAuB;AACnB;AACA,aAAKC,UAAL,CAAgBiC,CAAhB,GAAqB8S,KAAK,CAACE,OAAN,GAAgB,KAAKtV,GAAL,CAAS+B,WAA1B,GAAyC,CAAzC,GAA6C,CAAjE;AACA,aAAK1B,UAAL,CAAgBkC,CAAhB,GAAoB,EAAE6S,KAAK,CAACG,OAAN,GAAgB,KAAKvV,GAAL,CAASgC,YAA3B,IAA2C,CAA3C,GAA+C,CAAnE;AACA,aAAKzB,SAAL,CAAeiV,aAAf,CAA6B,KAAKnV,UAAlC,EAA8C,KAAKT,MAAnD;AACA,YAAI6V,UAAU,GAAG,KAAKlV,SAAL,CAAemV,gBAAf,CAAgC,KAAK3X,OAArC,CAAjB;;AACA,YAAI0X,UAAU,CAAC9R,MAAX,GAAoB,CAAxB,EAA2B;AACvB,eAAKF,QAAL,CAAckS,OAAd,GAAsB,KAAtB;AACA,cAAIC,QAAQ,GAAGH,UAAU,CAAC,CAAD,CAAV,CAAc1D,MAA7B,CAFuB,CAGvB;;AACA,cAAG,KAAKjT,SAAL,IAAkB,IAAlB,IAA0B,KAAKA,SAAL,CAAesB,OAAf,IAA0B,IAApD,IAA4D,KAAKtB,SAAL,CAAesB,OAAf,CAAuBuD,MAAvB,GAAgC,CAA/F,EAAiG;AAC7F,iBAAK7E,SAAL,CAAesB,OAAf,CAAuBpC,OAAvB,CAA+B,UAAS6X,IAAT,EAAe5X,KAAf,EAAqB;AAChD,kBAAI,YAAY,OAAQ4X,IAAI,CAACC,QAA7B,EAAwC;AACpC,oBAAID,IAAI,CAACC,QAAL,IAAiBF,QAAQ,CAAC1X,IAA9B,EAAoC;AAChC2X,kBAAAA,IAAI,CAACE,SAAL,CAAeH,QAAf,EAAwBnY,KAAxB;AACH;AACJ,eAJD,MAIM,IAAIoY,IAAI,CAACjY,UAAL,IAAiB,IAAjB,IAAuB,cAAc,OAAQiY,IAAI,CAACjY,UAAtD,EAAmE;AACrE,oBAAIiY,IAAI,CAACjY,UAAL,CAAgBgY,QAAQ,CAAC1X,IAAzB,CAAJ,EAAoC;AAChC2X,kBAAAA,IAAI,CAACE,SAAL,CAAeH,QAAf,EAAwBnY,KAAxB;AACH;AACJ;AACJ,aAVD;AAWH;;AACD,eAAKgG,QAAL,CAAckS,OAAd,GAAwB,IAAxB;AACH;AACJ;AACJ;;;WACD,uBAAchY,GAAd,EAAkB2E,CAAlB,EAAoBC,CAApB,EAAsBC,CAAtB,EAAwBiQ,IAAxB,EAA6B;AACzBb,MAAAA,OAAO,CAACC,GAAR,CAAYlU,GAAZ;AACA,UAAIqY,SAAS,GAAG,OAAhB;AACA,UAAIrI,OAAO,GAAG,IAAd;;AACA,UAAIhQ,GAAG,CAACsY,SAAJ,IAAiB,IAAjB,IAAyB,OAAQtY,GAAG,CAACsY,SAAZ,IAA0B,WAAvD,EAAoE;AAChED,QAAAA,SAAS,GAAGrY,GAAG,CAACsY,SAAhB;AACAtI,QAAAA,OAAO,GAAGhQ,GAAG,CAACuY,MAAd;AACH,OAHD,MAGO;AACHtE,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA,YAAIsE,SAAS,GAAGxY,GAAG,CAACuY,MAApB;AACAvI,QAAAA,OAAO,GAAG,IAAInR,KAAK,CAACoR,QAAV,EAAV;AACAD,QAAAA,OAAO,CAACxL,QAAR,CAAiBC,GAAjB,CAAqBzE,GAAG,CAACwE,QAAJ,CAAaG,CAAb,GAAiBA,CAAtC,EAA0C3E,GAAG,CAACwE,QAAJ,CAAaI,CAAb,GAAeA,CAAzD,EAA4D5E,GAAG,CAACwE,QAAJ,CAAaK,CAAb,GAAeA,CAA3E;AACA7E,QAAAA,GAAG,CAACwE,QAAJ,CAAaC,GAAb,CAAiB,CAACE,CAAlB,EAAqB,CAACC,CAAtB,EAAyB,CAACC,CAA1B;AACAmL,QAAAA,OAAO,CAAClL,GAAR,CAAY9E,GAAZ;AACAwY,QAAAA,SAAS,CAAC1T,GAAV,CAAckL,OAAd;AACH;;AACDhQ,MAAAA,GAAG,CAACsY,SAAJ,GAAiBD,SAAS,IAAI,OAAb,GAAuB,MAAvB,GAAgC,OAAjD;;AACA,UAAGvD,IAAI,IAAE,MAAN,IAAcA,IAAI,IAAE,OAAvB,EAA+B;AAC3B,YAAI2D,IAAI,GAAC3D,IAAI,IAAE,MAAN,GAAa,CAAb,GAAe,CAAC,CAAzB;;AACA,YAAG9U,GAAG,CAACsY,SAAJ,IAAe,OAAlB,EAA0B;AACtBtI,UAAAA,OAAO,CAACZ,YAAR,CAAqB,IAAIvQ,KAAK,CAACwQ,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAArB,EAAiD,MAAIoJ,IAAJ,GAAS5X,IAAI,CAACiR,EAA/D;AACH,SAFD,MAEK;AACD9B,UAAAA,OAAO,CAACZ,YAAR,CAAqB,IAAIvQ,KAAK,CAACwQ,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAArB,EAAiD,CAAC,GAAD,GAAKoJ,IAAL,GAAU5X,IAAI,CAACiR,EAAhE;AACH;AACJ,OAPD,MAOM,IAAGgD,IAAI,IAAE,OAAT,EAAiB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,YAAI4D,SAAS,GAAG,IAAI7Z,KAAK,CAACwQ,OAAV,CAAkB,CAAlB,EAAoB,CAApB,EAAsB,CAAtB,CAAhB,CAXmB,CAYnB;AACA;AACA;AACA;AACA;AACA;;AACA,YAAGrP,GAAG,CAACsY,SAAJ,IAAe,OAAlB,EAA0B;AACtBtI,UAAAA,OAAO,CAAC2I,eAAR,CAAwBD,SAAxB,EAAkC,CAAC1Y,GAAG,CAACmM,QAAJ,CAAayM,UAAb,CAAwBvS,KAAzB,GAA+B,EAAjE;AACH,SAFD,MAEK;AACD2J,UAAAA,OAAO,CAAC2I,eAAR,CAAwBD,SAAxB,EAAkC1Y,GAAG,CAACmM,QAAJ,CAAayM,UAAb,CAAwBvS,KAAxB,GAA8B,EAAhE;AACH,SAtBkB,CAwBnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;;AACH;AAEJ,K,CACD;;;;WACA,sBAAa6R,IAAb,EAAkBW,IAAlB,EAAwB;AACpB,WAAKC,aAAL,CAAmBZ,IAAnB,EAAwB,CAACA,IAAI,CAAC/L,QAAL,CAAcyM,UAAd,CAAyBxS,KAA1B,GAAgC,CAAxD,EAA0D,CAA1D,EAA4D,CAA5D,EAA8D,MAA9D;AACH,K,CACD;;;;WACA,uBAAc8R,IAAd,EAAmBW,IAAnB,EAAyB;AACrB,WAAKC,aAAL,CAAmBZ,IAAnB,EAAwBA,IAAI,CAAC/L,QAAL,CAAcyM,UAAd,CAAyBxS,KAAzB,GAA+B,CAAvD,EAAyD,CAAzD,EAA2D,CAA3D,EAA6D,OAA7D;AACH,K,CACD;;;;WACA,yBAAgB8R,IAAhB,EAAqBW,IAArB,EAA2B;AACvB,WAAKC,aAAL,CAAmBZ,IAAnB,EAAwBA,IAAI,CAAC/L,QAAL,CAAcyM,UAAd,CAAyBxS,KAAzB,GAA+B,CAAvD,EAAyD,CAAzD,EAA2D8R,IAAI,CAAC/L,QAAL,CAAcyM,UAAd,CAAyBvS,KAAzB,GAA+B,CAA1F,EAA4F,OAA5F;AACH,K,CACD;;;;WACA,2BAAkB6R,IAAlB,EAAuBW,IAAvB,EAA4B;AACxB,WAAKC,aAAL,CAAmBZ,IAAnB,EAAwB,CAAxB,EAA0B,CAA1B,EAA4BA,IAAI,CAAC/L,QAAL,CAAcyM,UAAd,CAAyBvS,KAAzB,GAA+B,CAA3D,EAA6D,OAA7D;AACH,K,CACD;;;;WACA,6BAAoBoR,KAApB,EAA0B;AACtB,UAAI3X,KAAK,GAAC,IAAV;;AACA,UAAIiZ,cAAc,GAAG,IAArB;AACA,WAAKrW,UAAL,CAAgBiC,CAAhB,GAAqB8S,KAAK,CAACE,OAAN,GAAgB,KAAKtV,GAAL,CAAS+B,WAA1B,GAAyC,CAAzC,GAA6C,CAAjE;AACA,WAAK1B,UAAL,CAAgBkC,CAAhB,GAAoB,EAAE6S,KAAK,CAACG,OAAN,GAAgB,KAAKvV,GAAL,CAASgC,YAA3B,IAA2C,CAA3C,GAA+C,CAAnE;AACA,WAAKzB,SAAL,CAAeiV,aAAf,CAA6B,KAAKnV,UAAlC,EAA8C,KAAKT,MAAnD;AACA,UAAI6V,UAAU,GAAG,KAAKlV,SAAL,CAAemV,gBAAf,CAAgC,KAAK3X,OAArC,CAAjB;;AACA,UAAG0X,UAAU,CAAC9R,MAAX,GAAkB,CAArB,EAAuB;AACnB,YAAIiS,QAAQ,GAAGH,UAAU,CAAC,CAAD,CAAV,CAAc1D,MAA7B,CADmB,CAEnB;;AACA,YAAG6D,QAAQ,CAAC1X,IAAT,CAAcQ,QAAd,GAAyBmS,OAAzB,CAAiC,WAAjC,KAA+C,CAAC,CAAhD,IACG+E,QAAQ,CAAC1X,IAAT,CAAcQ,QAAd,GAAyBmS,OAAzB,CAAiC,aAAjC,KAAiD,CAAC,CADxD,EAEC;AACG6F,UAAAA,cAAc,GAAGd,QAAjB;AACH;AACJ;;AACD,UAAI,KAAKnV,WAAL,IAAoBiW,cAAxB,EAAyC;AACrCtR,QAAAA,YAAY,CAAC,KAAK1E,QAAN,CAAZ;;AACA,YAAGgW,cAAH,EAAkB;AACd,eAAKhW,QAAL,GAAgB2E,UAAU,CAAC,YAAU;AACjC;AACA,gBAAImJ,OAAO,GAAC,EAAZ;;AACA,gBAAGkI,cAAc,CAACxY,IAAf,CAAoBQ,QAApB,GAA+BmS,OAA/B,CAAuC,WAAvC,KAAqD,CAAC,CAAzD,EAA2D;AACvDrC,cAAAA,OAAO,GAACkI,cAAc,CAAC7I,IAAf,CAAoBW,OAA5B;AACA/Q,cAAAA,KAAK,CAACkD,OAAN,CAAc6D,KAAd,CAAoB7B,UAApB,GAAiClF,KAAK,CAACoD,SAAvC;AACApD,cAAAA,KAAK,CAACkD,OAAN,CAAcwE,aAAd,CAA4B,MAA5B,EAAoCX,KAApC,CAA0CwB,SAA1C,GAAoD,gBAAcvI,KAAK,CAACoD,SAAxE;AACH;;AACD,gBAAG6V,cAAc,CAACxY,IAAf,CAAoBQ,QAApB,GAA+BmS,OAA/B,CAAuC,aAAvC,KAAuD,CAAC,CAA3D,EAA6D;AACzD;AACArC,cAAAA,OAAO,GAACkI,cAAc,CAAC7I,IAAf,CAAoBW,OAA5B;AACA/Q,cAAAA,KAAK,CAACkD,OAAN,CAAc6D,KAAd,CAAoB7B,UAApB,GAAiClF,KAAK,CAACoD,SAAvC;AACApD,cAAAA,KAAK,CAACkD,OAAN,CAAcwE,aAAd,CAA4B,MAA5B,EAAoCX,KAApC,CAA0CwB,SAA1C,GAAoD,gBAAcvI,KAAK,CAACoD,SAAxE;AAEH;;AACD,gBAAI8V,MAAM,GAACnI,OAAO,CAAC7K,MAAnB;AACAlG,YAAAA,KAAK,CAACkD,OAAN,CAAcwE,aAAd,CAA4B,SAA5B,EAAuCH,SAAvC,GAAiDwJ,OAAjD;AACA/Q,YAAAA,KAAK,CAACkD,OAAN,CAAc6D,KAAd,CAAoBT,KAApB,GAA0B4S,MAAM,GAAC,EAAP,GAAU,IAApC;AACAlZ,YAAAA,KAAK,CAACkD,OAAN,CAAc6D,KAAd,CAAoBC,OAApB,GAA8B,OAA9B;AACAhH,YAAAA,KAAK,CAACkD,OAAN,CAAc6D,KAAd,CAAoBE,IAApB,GAA4BjH,KAAK,CAACmD,SAAN,CAAgBgW,KAAhB,GAAwBnZ,KAAK,CAACkD,OAAN,CAAckW,WAAd,GAA0B,CAAnD,GAAwD,IAAnF;AACApZ,YAAAA,KAAK,CAACkD,OAAN,CAAc6D,KAAd,CAAoBG,GAApB,GAA2BlH,KAAK,CAACmD,SAAN,CAAgBkW,KAAhB,GAAwBrZ,KAAK,CAACkD,OAAN,CAAcoW,YAAtC,GAAqD,EAAtD,GAA4D,IAAtF;AACH,WArByB,EAqBxB,IArBwB,CAA1B;AAsBH;AACJ,OA1CqB,CA2CtB;;;AACA,WAAKtW,WAAL,GAAmBiW,cAAnB,CA5CsB,CA6CtB;;AACA,UAAGA,cAAc,IAAI,IAArB,EAA0B;AACtBjZ,QAAAA,KAAK,CAACkD,OAAN,CAAc6D,KAAd,CAAoBC,OAApB,GAA8B,MAA9B;AACH,OAhDqB,CAiDtB;;;AACA,WAAK7D,SAAL,GAAiBwU,KAAjB;AACH,K,CACD;;;;WACA,eAAK;AACD,UAAI3X,KAAK,GAAC,IAAV,CADC,CAED;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEH,K,CACD;;;;WACA,+BAAqB;AACjB;AACA,UAAIA,KAAK,GAAC,IAAV;;AACA,UAAIuZ,WAAW,GAAG,IAAIxa,KAAK,CAACoU,aAAV,GAA0B1L,IAA1B,CAAgC,yCAAhC,CAAlB;AACA,UAAI+R,WAAW,GAAG,IAAIza,KAAK,CAACoU,aAAV,GAA0B1L,IAA1B,CAAgC,wCAAhC,CAAlB;AACA,UAAIgS,WAAW,GAAG,IAAI1a,KAAK,CAACoU,aAAV,GAA0B1L,IAA1B,CAAgC,wCAAhC,CAAlB;AACA,UAAIiS,iBAAiB,GAAG,IAAI3a,KAAK,CAACoU,aAAV,GAA0B1L,IAA1B,CAAgC,4CAAhC,CAAxB;AACA,UAAIyM,SAAS,GAAC,IAAIhV,SAAJ,EAAd;AACAgV,MAAAA,SAAS,CAACzM,IAAV,CAAe,0BAAf,EAA0C,UAAS6M,MAAT,EAAiB;AACvDA,QAAAA,MAAM,CAACqF,QAAP,CAAiB,UAAWC,KAAX,EAAmB;AAChC,cAAKA,KAAK,YAAY7a,KAAK,CAACoN,IAA5B,EAAkC;AAC9ByN,YAAAA,KAAK,CAAC5M,QAAN,GAAe,IAAIjO,KAAK,CAAC+U,iBAAV,CAA4B;AAAChM,cAAAA,KAAK,EAAE;AAAR,aAA5B,CAAf;;AACA,gBAAG8R,KAAK,CAACnZ,IAAN,IAAY,mBAAZ,IAAiCmZ,KAAK,CAACnZ,IAAN,IAAY,mBAAhD,EAAoE;AAChEmZ,cAAAA,KAAK,CAAC5M,QAAN,CAAevM,IAAf,GAAoB,gBAApB;AACAmZ,cAAAA,KAAK,CAAC5M,QAAN,CAAetG,GAAf,GAAqB6S,WAArB;AACH,aAHD,MAGM,IAAGK,KAAK,CAACnZ,IAAN,IAAY,mBAAZ,IAAiCmZ,KAAK,CAACnZ,IAAN,IAAY,mBAA7C,IAAkEmZ,KAAK,CAACnZ,IAAN,IAAY,mBAA9E,IAAmGmZ,KAAK,CAACnZ,IAAN,IAAY,mBAAlH,EAAsI;AACxImZ,cAAAA,KAAK,CAAC5M,QAAN,CAAevM,IAAf,GAAoB,gBAApB;AACAmZ,cAAAA,KAAK,CAAC5M,QAAN,CAAetG,GAAf,GAAqB+S,WAArB;AACH,aAHK,MAGA,IAAGG,KAAK,CAACnZ,IAAN,IAAY,mBAAZ,IAAiCmZ,KAAK,CAACnZ,IAAN,IAAY,mBAAhD,EAAoE;AACtEmZ,cAAAA,KAAK,CAAC5M,QAAN,CAAevM,IAAf,GAAoB,gBAApB;AACAmZ,cAAAA,KAAK,CAAC5M,QAAN,CAAetG,GAAf,GAAqB8S,WAArB;AACH,aAHK,MAGA,IAAGI,KAAK,CAACnZ,IAAN,IAAY,mBAAf,EAAmC;AACrCmZ,cAAAA,KAAK,CAAC5M,QAAN,CAAevM,IAAf,GAAoB,gBAApB;AACAmZ,cAAAA,KAAK,CAAC5M,QAAN,CAAetG,GAAf,GAAqBgT,iBAArB;AACH;AACJ;AACJ,SAjBD,EADuD,CAmBvD;;AACA,YAAIG,WAAW,GAAG,IAAIza,WAAJ,EAAlB;AACA,YAAI0a,MAAM,GAAGD,WAAW,CAACE,KAAZ,CAAkBzF,MAAlB,CAAb;AACA,YAAI0F,IAAI,GAAGxX,QAAQ,CAACqE,aAAT,CAAwB,GAAxB,CAAX;AACAmT,QAAAA,IAAI,CAACjT,KAAL,CAAWC,OAAX,GAAqB,MAArB;AACAxE,QAAAA,QAAQ,CAACyX,IAAT,CAAczV,WAAd,CAA2BwV,IAA3B;AACAA,QAAAA,IAAI,CAACE,IAAL,GAAYC,GAAG,CAACC,eAAJ,CAAqB,IAAIC,IAAJ,CAAU,CAAEP,MAAF,CAAV,EAAsB;AAAEQ,UAAAA,IAAI,EAAE;AAAR,SAAtB,CAArB,CAAZ;AACAN,QAAAA,IAAI,CAACO,QAAL,GAAgB,YAAhB;AACAP,QAAAA,IAAI,CAACQ,KAAL,GA3BuD,CA4BvD;AACH,OA7BD,EA6BG,KAAK9F,UA7BR,EA6BoB,KAAKC,OA7BzB;AA8BH,K,CACD;;;;WACA,sBAAY;AACR,UAAI8F,GAAG,GAAG,IAAI1b,KAAK,CAAC2b,WAAV,CAAsB,EAAtB,EAAyB,CAAzB,EAA2B,EAA3B,CAAV;AACA,UAAI1N,QAAQ,GAAC,IAAIjO,KAAK,CAAC4b,iBAAV,CAA4B;AAAC7S,QAAAA,KAAK,EAAC;AAAP,OAA5B,CAAb;AACA,UAAI5H,GAAG,GAAC,IAAInB,KAAK,CAACoN,IAAV,CAAesO,GAAf,EAAmBzN,QAAnB,CAAR,CAHQ,CAG6B;AACrC;;AACA,UAAI4N,YAAY,GAAG,IAAI3b,YAAJ,EAAnB;AACA2b,MAAAA,YAAY,CAACb,KAAb,CAAmB7Z,GAAnB,EAAwB,UAAU4M,MAAV,EAAkB;AACtCqH,QAAAA,OAAO,CAACC,GAAR,CAAYtH,MAAZ;AACA,YAAIgN,MAAM,GAAGe,IAAI,CAACC,SAAL,CAAgBhO,MAAhB,EAAwB,IAAxB,EAA8B,CAA9B,CAAb;AACA,YAAIkN,IAAI,GAAGxX,QAAQ,CAACqE,aAAT,CAAwB,GAAxB,CAAX;AACAmT,QAAAA,IAAI,CAACjT,KAAL,CAAWC,OAAX,GAAqB,MAArB;AACAxE,QAAAA,QAAQ,CAACyX,IAAT,CAAczV,WAAd,CAA2BwV,IAA3B;AACAA,QAAAA,IAAI,CAACE,IAAL,GAAYC,GAAG,CAACC,eAAJ,CAAqB,IAAIC,IAAJ,CAAU,CAAEP,MAAF,CAAV,EAAsB;AAAEQ,UAAAA,IAAI,EAAE;AAAR,SAAtB,CAArB,CAAZ;AACAN,QAAAA,IAAI,CAACO,QAAL,GAAgB,aAAhB;AACAP,QAAAA,IAAI,CAACQ,KAAL;AACH,OATD,EANQ,CAgBR;;AACA,UAAIxa,KAAK,GAAC,IAAV;;AACA,UAAIkT,MAAM,GAAG,IAAIlU,UAAJ,EAAb;AACAkU,MAAAA,MAAM,CAACzL,IAAP,CAAa,2BAAb,EAA0C,UAAWsT,IAAX,EAAkB;AACxD5G,QAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAmC2G,IAAnC;AACA5G,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyB2G,IAAI,CAAC7Y,KAA9B;AACAiS,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyB2G,IAAI,CAACC,OAA9B;;AACAhb,QAAAA,KAAK,CAACkC,KAAN,CAAY8C,GAAZ,CAAiB+V,IAAI,CAAC7Y,KAAtB;AACH,OALD;AAMH,K,CACD;;;;WACA,qBAAW;AACP,UAAIuY,GAAG,GAAG,IAAI1b,KAAK,CAAC2b,WAAV,CAAsB,EAAtB,EAAyB,CAAzB,EAA2B,EAA3B,CAAV;AACA,UAAI1N,QAAQ,GAAC,IAAIjO,KAAK,CAAC4b,iBAAV,CAA4B;AAAC7S,QAAAA,KAAK,EAAC;AAAP,OAA5B,CAAb;AACA,UAAI5H,GAAG,GAAC,IAAInB,KAAK,CAACoN,IAAV,CAAesO,GAAf,EAAmBzN,QAAnB,CAAR,CAHO,CAG8B;AACrC;;AACA,UAAI6M,WAAW,GAAG,IAAIza,WAAJ,EAAlB;AACA,UAAI0a,MAAM,GAAGD,WAAW,CAACE,KAAZ,CAAkB7Z,GAAlB,CAAb;AACA,UAAI8Z,IAAI,GAAGxX,QAAQ,CAACqE,aAAT,CAAwB,GAAxB,CAAX;AACAmT,MAAAA,IAAI,CAACjT,KAAL,CAAWC,OAAX,GAAqB,MAArB;AACAxE,MAAAA,QAAQ,CAACyX,IAAT,CAAczV,WAAd,CAA2BwV,IAA3B;AACAA,MAAAA,IAAI,CAACE,IAAL,GAAYC,GAAG,CAACC,eAAJ,CAAqB,IAAIC,IAAJ,CAAU,CAAEP,MAAF,CAAV,EAAsB;AAAEQ,QAAAA,IAAI,EAAE;AAAR,OAAtB,CAArB,CAAZ;AACAN,MAAAA,IAAI,CAACO,QAAL,GAAgB,YAAhB;AACAP,MAAAA,IAAI,CAACQ,KAAL,GAZO,CAaP;;AACA,UAAIxa,KAAK,GAAC,IAAV;;AACA,UAAIkT,MAAM,GAAG,IAAIhU,SAAJ,EAAb;AACA,UAAI+b,OAAO,GAAC,IAAI9b,UAAJ,EAAZ;AACA+T,MAAAA,MAAM,CAACzL,IAAP,CAAa,0BAAb,EAAyC,UAAWvH,GAAX,EAAiB;AACtDiU,QAAAA,OAAO,CAACC,GAAR,CAAYlU,GAAZ;;AACAF,QAAAA,KAAK,CAACkC,KAAN,CAAY8C,GAAZ,CAAiB9E,GAAjB;AACH,OAHD,EAjBO,CAqBP;AACA;AACA;AACH;AAED;;;;WACA,wBAAegb,OAAf,EAAwBpC,UAAxB,EAAoC;AAEhC,UAAKA,UAAU,KAAKzF,SAApB,EAAgCyF,UAAU,GAAG,EAAb;AAEhC,UAAIqC,QAAQ,GAAGrC,UAAU,CAAC/K,cAAX,CAA0B,UAA1B,IACX+K,UAAU,CAAC,UAAD,CADC,GACc,OAD7B;AAGA;;AACA,UAAIsC,QAAQ,GAAGtC,UAAU,CAAC/K,cAAX,CAA0B,UAA1B,IACX+K,UAAU,CAAC,UAAD,CADC,GACc,EAD7B;AAGA;;AACA,UAAIuC,eAAe,GAAGvC,UAAU,CAAC/K,cAAX,CAA0B,iBAA1B,IAClB+K,UAAU,CAAC,iBAAD,CADQ,GACc,CADpC;AAGA;;AACA,UAAIwC,WAAW,GAAGxC,UAAU,CAAC/K,cAAX,CAA0B,aAA1B,IACd+K,UAAU,CAAC,aAAD,CADI,GACc;AAAEyC,QAAAA,CAAC,EAAC,CAAJ;AAAOC,QAAAA,CAAC,EAAC,CAAT;AAAYC,QAAAA,CAAC,EAAC,CAAd;AAAiBC,QAAAA,CAAC,EAAC;AAAnB,OADhC;AAGA;;AACA,UAAIC,eAAe,GAAG7C,UAAU,CAAC/K,cAAX,CAA0B,iBAA1B,IAClB+K,UAAU,CAAC,iBAAD,CADQ,GACc;AAAEyC,QAAAA,CAAC,EAAC,GAAJ;AAASC,QAAAA,CAAC,EAAC,GAAX;AAAgBC,QAAAA,CAAC,EAAC,GAAlB;AAAuBC,QAAAA,CAAC,EAAC;AAAzB,OADpC;AAGA;;AACA,UAAI1K,MAAM,GAAGxO,QAAQ,CAACqE,aAAT,CAAuB,QAAvB,CAAb;AACA,UAAIoK,OAAO,GAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAd;AAEA;;AACAD,MAAAA,OAAO,CAACQ,IAAR,GAAe2J,QAAQ,GAAG,KAAX,GAAmBD,QAAlC;AAEA;;AACA,UAAIS,OAAO,GAAG3K,OAAO,CAAC4K,WAAR,CAAqBX,OAArB,CAAd;AACA,UAAIY,SAAS,GAAGF,OAAO,CAACtV,KAAxB;AAEA;;AACA2K,MAAAA,OAAO,CAACI,SAAR,GAAsB,UAAUsK,eAAe,CAACJ,CAA1B,GAA8B,GAA9B,GAAoCI,eAAe,CAACH,CAApD,GAAwD,GAAxD,GAChBG,eAAe,CAACF,CADA,GACI,GADJ,GACUE,eAAe,CAACD,CAD1B,GAC8B,GADpD;AAGA;;AACAzK,MAAAA,OAAO,CAACU,WAAR,GAAsB,UAAU2J,WAAW,CAACC,CAAtB,GAA0B,GAA1B,GAAgCD,WAAW,CAACE,CAA5C,GAAgD,GAAhD,GAChBF,WAAW,CAACG,CADI,GACA,GADA,GACMH,WAAW,CAACI,CADlB,GACsB,GAD5C;AAEAzK,MAAAA,OAAO,CAAC8E,SAAR,GAAoBsF,eAApB;AAEA;;AACA,WAAKU,SAAL,CAAe9K,OAAf,EAAwBoK,eAAe,GAAC,CAAxC,EAA2CA,eAAe,GAAC,CAA3D,EAA8DS,SAAS,GAAGT,eAA1E,EAA2FD,QAAQ,GAAG,GAAX,GAAiBC,eAA5G,EAA6H,CAA7H;AAEA;;AACApK,MAAAA,OAAO,CAACI,SAAR,GAAoB,oBAApB;AACAJ,MAAAA,OAAO,CAACW,QAAR,CAAkBsJ,OAAlB,EAA2BG,eAA3B,EAA4CD,QAAQ,GAAGC,eAAvD;AAEA;;AACA,UAAIpI,OAAO,GAAG,IAAIlU,KAAK,CAACid,OAAV,CAAkBhL,MAAlB,CAAd;AACAiC,MAAAA,OAAO,CAAC5F,WAAR,GAAsB,IAAtB;AAEA,UAAI4O,cAAc,GAAG,IAAIld,KAAK,CAACmd,cAAV,CAAyB;AAAExV,QAAAA,GAAG,EAAEuM;AAAP,OAAzB,CAArB;AACA,UAAI5Q,MAAM,GAAG,IAAItD,KAAK,CAACod,MAAV,CAAkBF,cAAlB,CAAb;AAEA;;AACA5Z,MAAAA,MAAM,CAACwS,KAAP,CAAalQ,GAAb,CAAiB,EAAjB,EAAoB,CAApB,EAAsB,CAAtB;AAEA,aAAOtC,MAAP;AACH;;;WAED,sBAAanC,GAAb,EAAkB;AACd,UAAImC,MAAM,GAAG,KAAK+Z,cAAL,CAAoB,SAAS,EAAT,GAAc,OAAd,GAAwB,KAAI,CAAE,GAAlD,CAAb;AACA/Z,MAAAA,MAAM,CAACqC,QAAP,CAAgBC,GAAhB,CAAoBzE,GAAG,CAAC2E,CAAJ,GAAQ,EAA5B,EAA+B3E,GAAG,CAAC4E,CAAJ,GAAM,EAArC,EAAwC5E,GAAG,CAAC6E,CAAJ,GAAM,EAA9C;AACA1C,MAAAA,MAAM,CAACwS,KAAP,CAAalQ,GAAb,CAAiB,GAAjB,EAAsB,GAAtB,EAA0B,CAA1B,EAHc,CAGgB;;AAC9BtC,MAAAA,MAAM,CAAC+N,IAAP,GAAYlQ,GAAG,CAACkQ,IAAhB,CAJc,CAIQ;;AACtB/N,MAAAA,MAAM,CAAC5B,IAAP,GAAY,aAAZ;AACA4B,MAAAA,MAAM,CAACyU,OAAP,GAAe,IAAf;AACA3C,MAAAA,OAAO,CAACC,GAAR,CAAY/R,MAAZ;AACA,WAAKkH,SAAL,CAAelH,MAAf;AACA,WAAKA,MAAL,CAAYqK,IAAZ,CAAiBrK,MAAjB;AACH;AAED;;;;WACA,mBAAUga,GAAV,EAAexX,CAAf,EAAkBC,CAAlB,EAAqBwX,CAArB,EAAwBC,CAAxB,EAA2BhB,CAA3B,EAA8B;AAE1Bc,MAAAA,GAAG,CAAClL,SAAJ;AACAkL,MAAAA,GAAG,CAACG,MAAJ,CAAW3X,CAAC,GAAC0W,CAAb,EAAgBzW,CAAhB;AACAuX,MAAAA,GAAG,CAACI,MAAJ,CAAW5X,CAAC,GAACyX,CAAF,GAAIf,CAAf,EAAkBzW,CAAlB;AACAuX,MAAAA,GAAG,CAACK,gBAAJ,CAAqB7X,CAAC,GAACyX,CAAvB,EAA0BxX,CAA1B,EAA6BD,CAAC,GAACyX,CAA/B,EAAkCxX,CAAC,GAACyW,CAApC;AACAc,MAAAA,GAAG,CAACI,MAAJ,CAAW5X,CAAC,GAACyX,CAAb,EAAgBxX,CAAC,GAACyX,CAAF,GAAIhB,CAApB;AACAc,MAAAA,GAAG,CAACK,gBAAJ,CAAqB7X,CAAC,GAACyX,CAAvB,EAA0BxX,CAAC,GAACyX,CAA5B,EAA+B1X,CAAC,GAACyX,CAAF,GAAIf,CAAnC,EAAsCzW,CAAC,GAACyX,CAAxC;AACAF,MAAAA,GAAG,CAACI,MAAJ,CAAW5X,CAAC,GAAC0W,CAAb,EAAgBzW,CAAC,GAACyX,CAAlB;AACAF,MAAAA,GAAG,CAACK,gBAAJ,CAAqB7X,CAArB,EAAwBC,CAAC,GAACyX,CAA1B,EAA6B1X,CAA7B,EAAgCC,CAAC,GAACyX,CAAF,GAAIhB,CAApC;AACAc,MAAAA,GAAG,CAACI,MAAJ,CAAW5X,CAAX,EAAcC,CAAC,GAACyW,CAAhB;AACAc,MAAAA,GAAG,CAACK,gBAAJ,CAAqB7X,CAArB,EAAwBC,CAAxB,EAA2BD,CAAC,GAAC0W,CAA7B,EAAgCzW,CAAhC;AACAuX,MAAAA,GAAG,CAACM,SAAJ;AACAN,MAAAA,GAAG,CAAC/K,IAAJ;AACA+K,MAAAA,GAAG,CAACO,MAAJ;AAEH;;;;;;SAr1DgBpd,Q","sourcesContent":["/*\r\n作者:Mr.Xie\r\n创建时间:2020年05月29日\r\n功能描述:3D机房封装\r\n\r\n使用方式\r\nlet props={domID:\"three-dom\"}\r\nthis.map = new ThreeMap(props[,dataJson]);\r\nthis.map.init();\r\n*/\r\nimport * as THREE from 'three';\r\nimport 'imports-loader?THREE=three!threebsp'\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\r\nimport { GLTFExporter } from 'three/examples/jsm/exporters/GLTFExporter'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport {OBJLoader2 } from 'three/examples/jsm/loaders/OBJLoader2'\r\nimport { OBJExporter } from 'three/examples/jsm/exporters/OBJExporter'\r\nimport { MTLLoader } from 'three/examples/jsm/loaders/MTLLoader'\r\nimport TWEEN from '@tweenjs/tween.js'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js'   //r100及以上\r\n// var OrbitControls = require('three-orbit-controls')(THREE)  //r100 以下\r\nexport default class ThreeMap {\r\n    constructor(props,dataJson) {\r\n\r\n        this.props=props;\r\n        this.ThreeData=dataJson;\r\n        this.dataJson=dataJson;\r\n        this.objList = dataJson.objects||[];//对象列表\r\n        this.eventList = dataJson.events||{};//事件对象列表\r\n        this.btnList = dataJson.btns||[];//按钮列表\r\n        this.alarmColor=Object.assign({\r\n            level1:\"#00c5ff\",\r\n            level2:\"#b0f604\",\r\n            level3:\"#fcff00\",\r\n            level4:\"#ff8d00\",\r\n            level5:\"#ff0000\",\r\n        },dataJson.alarmColor);\r\n\r\n        this.renderer=null;\r\n        this.scene = null;//场景\r\n        this.camera=null;\r\n        this.objects = [];  //存放对象\r\n        this.equipment=[];  //存放设备\r\n        this.sprite=[];  //存放告警精灵图标\r\n        this.cabinet=[];  //存放柜子\r\n        this.dom=document.getElementById(this.props.domID);\r\n        this.dbclick = 0;\r\n        this.mouseClick = new THREE.Vector2();\r\n        this.raycaster = new THREE.Raycaster();\r\n        this.lastElement=null;  //存放最后一个设备\r\n        this.tipTimer=null; //显示提示用的timer\r\n        this.tooltip=null;\r\n        this.lastEvent=null;\r\n        this.tooltipBG='#ACDEFE';\r\n\r\n        this.progressSuccess=0;\r\n        this.loadtimer=null;\r\n        this.BASE_PATH=\"./images/\"\r\n    }\r\n\r\n    init() {\r\n        this.initRenderer();\r\n        this.initScene();\r\n        this.initCamera();\r\n        this.initLight();\r\n        this.render();\r\n        // this.setHelper();\r\n        this.setControl();\r\n        // this.add();\r\n        this.InitData();  //添加3D对象、事件等\r\n        this.renderer.domElement.addEventListener('mousedown', this.onDocumentMouseDown.bind(this), false);\r\n        this.renderer.domElement.addEventListener('mousemove',this.onDocumentMouseMove.bind(this), false);\r\n    }\r\n\r\n    //初始化渲染场景\r\n    initRenderer() {\r\n        this.renderer = new THREE.WebGLRenderer({ antialias: true });\r\n        this.renderer.setSize(this.dom.offsetWidth,this.dom.offsetHeight);\r\n        this.dom.appendChild(this.renderer.domElement);\r\n    }\r\n    //初始化相机\r\n    initCamera() {\r\n        this.camera = new THREE.PerspectiveCamera(45, this.dom.offsetWidth / this.dom.offsetHeight, 1, 100000);\r\n        this.camera.name = 'mainCamera';\r\n        this.camera.position.set(0,1000,1800)\r\n        //默认就是以Y轴为上方的\r\n        // this.camera.up.x = 0;\r\n        // this.camera.up.y =1;\r\n        // this.camera.up.z =0;\r\n        this.camera.lookAt({ x: 0, y: 0, z: 0 });\r\n        this.scene.add(this.camera);\r\n    }\r\n    //初始化场景\r\n    initScene() {\r\n        this.scene = new THREE.Scene();\r\n        this.scene.background = new THREE.Color(0x225F93);\r\n    }\r\n    //初始化灯光\r\n    initLight(){\r\n        var light = new THREE.AmbientLight(0xcccccc);\r\n        light.position.set(0, 0,0);\r\n        this.scene.add(light);\r\n        var light2 = new THREE.PointLight(0x555555);\r\n        light2.shadow.camera.near =1;\r\n        light2.shadow.camera.far = 5000;\r\n        light2.position.set(0, 350, 0);\r\n        light2.castShadow = true;//表示这个光是可以产生阴影的\r\n        this.scene.add(light2);\r\n    }\r\n    //渲染\r\n    render() {\r\n        this.animate()\r\n    }\r\n    animate() {\r\n        requestAnimationFrame(this.render.bind(this));\r\n        this.renderer.render(this.scene, this.camera);\r\n    }\r\n    setHelper() {\r\n        //红色x,绿色y,蓝色z\r\n        const axesHelper = new THREE.AxisHelper(5);\r\n        this.scene.add(axesHelper);\r\n    }\r\n    //鼠标拖拽控制\r\n    setControl() {\r\n        this.controls = new OrbitControls(this.camera,this.dom);\r\n        this.controls.update();\r\n    }\r\n    InitData(){\r\n        // this.Loading();\r\n        if(this.objList.length>0){\r\n            for(let i=0;i<this.objList.length;i++){\r\n                this.InitAddObject(this.objList[i]);\r\n            }\r\n        }\r\n        // if(this.btnList.length>0){\r\n        //     this.InitBtn();\r\n        // }\r\n        this.createText(this.objList[0].width,this.objList[0].depth);\r\n        this.InitTooltip();\r\n        // this.LoadSuccess();\r\n    }\r\n    //刷新视图\r\n    resetView(){\r\n        this.dom.removeChild(this.renderer.domElement);\r\n        var map = new ThreeMap(this.props,this.ThreeData);\r\n        map.init();\r\n    }\r\n    Loading(){\r\n        var div = document.createElement('div');\r\n\t\tdiv.setAttribute('id', 'loading');\r\n\t\tdiv.style.display = 'block';\r\n\t\tdiv.style.position = 'absolute';\r\n\t\tdiv.style.left = '0';\r\n\t\tdiv.style.top = '0';\r\n\t\tdiv.style.width = '100%';\r\n        div.style.height = '100%';\r\n        div.style.fontSize=\"30px\";\r\n        div.style.zIndex=\"999\";\r\n        div.style.background = 'rgba(0,0,0,0.65)';\r\n        let loading=document.createElement('div');\r\n        loading.innerHTML=\"模型加载中...\";\r\n        loading.style.top=\"40%\";\r\n        loading.style.position=\"absolute\";\r\n        loading.style.width=\"100%\";\r\n        loading.style.textAlign=\"center\";\r\n        div.appendChild(loading);\r\n\t\tthis.dom.appendChild(div);\r\n    }\r\n    LoadSuccess(){\r\n        let _this=this;\r\n        if(this.progressSuccess==3){\r\n            let load=this.dom.querySelector(\"#loading\");\r\n            load.style.display=\"none\";\r\n            clearTimeout(this.loadtimer);\r\n        }else{\r\n            this.loadtimer = setTimeout(function(){\r\n                _this.LoadSuccess();\r\n            },1000);\r\n        }\r\n    }\r\n    //添加提示框\r\n    InitTooltip(){\r\n        this.tooltip = document.createElement('div');\r\n\t\tthis.tooltip.setAttribute('id', 'tooltip');\r\n\t\tthis.tooltip.style.display = 'none';\r\n        this.tooltip.style.position = 'absolute';\r\n        this.tooltip.style.color=\"#000\";\r\n        this.tooltip.style.maxWidth=\"200px\";\r\n\t\tthis.tooltip.style.width = '32px';\r\n        this.tooltip.style.height = 'auto';\r\n        this.tooltip.style.lineHeight=\"22px\";\r\n        this.tooltip.style.textAlign=\"center\";\r\n        this.tooltip.style.padding=\"10px\";\r\n        this.tooltip.style.background = this.tooltipBG;\r\n        this.tooltip.style.opacity=0.8;\r\n        this.tooltip.style['border-radius'] = '5px';\r\n        let tipdiv=document.createElement('div');\r\n        tipdiv.setAttribute(\"id\",\"tipdiv\");\r\n        let tipspan=document.createElement('span');\r\n        tipspan.style.marginLeft=\"50%\";\r\n        tipspan.style.bottom=\"-10px\";\r\n        tipspan.style.left=\"-10px\";\r\n        tipspan.style.position=\"absolute\";\r\n        tipspan.style.borderTop=\"10px solid \"+this.tooltipBG;\r\n        tipspan.style.borderLeft=\"10px solid transparent\";\r\n        tipspan.style.borderRight=\"10px solid transparent\";\r\n        this.tooltip.appendChild(tipspan);\r\n        this.tooltip.appendChild(tipdiv);\r\n        this.dom.appendChild(this.tooltip);\r\n    }\r\n    //添加按钮\r\n    InitBtn(){\r\n        var _this=this;\r\n        var count = this.btnList.length;\r\n\t\tvar step = 24;\r\n\r\n\t\tvar div = document.createElement('div');\r\n\t\tdiv.setAttribute('id', 'toolbar');\r\n\t\tdiv.style.display = 'block';\r\n\t\tdiv.style.position = 'absolute';\r\n\t\tdiv.style.left = '10px';\r\n\t\tdiv.style.top = '75px';\r\n\t\tdiv.style.width = '32px';\r\n\t\tdiv.style.height = (count * step + step) + 'px';\r\n\t\tdiv.style.background = 'rgba(255,255,255,0.75)';\r\n\t\tdiv.style['border-radius'] = '5px';\r\n\t\tthis.dom.appendChild(div);\r\n\r\n\t\tfor (var i = 0; i < count; i++) {\r\n\t\t\tvar button = this.btnList[i];\r\n\t\t\tvar btnimg = button.btnimg;\r\n\t\t\tvar img = document.createElement('img');\r\n\t\t\timg.style.position = 'absolute';\r\n\t\t\timg.style.left = '4px';\r\n\t\t\timg.style.top = (step / 2 + (i * step)) + 'px';\r\n\t\t\timg.style['pointer-events'] = 'auto';\r\n\t\t\timg.style['cursor'] = 'pointer';\r\n\t\t\timg.setAttribute('src', this.commonFunc.getPath(btnimg));\r\n\t\t\timg.style.width = '24px';\r\n\t\t\timg.style.height = '24px';\r\n            img.setAttribute('title', button.btnTitle);\r\n            img.onclick=function(){ button.clickFunction(_this)};\r\n\t\t\tdiv.appendChild(img);\r\n\t\t}\r\n    }\r\n    //添加3D对象\r\n    InitAddObject(obj){\r\n        if (obj.show == null || typeof (obj.show) == 'undefined' || obj.show) {\r\n            let tempObj = null;\r\n            switch (obj.objType) {\r\n                case 'cube':\r\n                    tempObj = this.createCube(obj)\r\n                    this.addObject(tempObj,\"scene\");\r\n                    break;\r\n                case 'desk':\r\n                    this.createObjDesk(obj)\r\n                    break;\r\n                case 'wall':\r\n                    this.CreateWall(obj);\r\n                    break;\r\n                case 'emptyCabinet':\r\n                    tempObj = this.createEmptyCabinet(obj);\r\n                    this.addObject(tempObj,\"scene\");\r\n                    break;\r\n                case 'sprite':\r\n                    this.createSprite(obj)\r\n                    break\r\n                // case 'cylinderPlant':  //自定义花\r\n                //     tempObj = this.createCylinderPlant(obj)\r\n                //     this.addObject(tempObj,\"scene\");\r\n                //     break;\r\n                case 'objPlant':  //模型花\r\n                    this.createObjPlant(obj);\r\n                    break;\r\n                case 'chair':  //模型花\r\n                    this.createObjChair(obj);\r\n                    break;\r\n                case 'objAnnihilator':  //模型灭火器\r\n                    this.createObjAnnihilator(obj);\r\n                    break;\r\n                case 'objCamera':  //模型摄像头\r\n                    this.createObjCamera(obj);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    //创建墙\r\n    CreateWall (obj) {\r\n        let _this=this;\r\n        var commonDepth = obj.depth || 40;//墙体厚度\r\n        var commonHeight = obj.height || 100;//墙体高度\r\n        var commonWidth = obj.width || 300;//墙体宽度\r\n        var commonSkin = obj.style.skinColor || 0x98750f;\r\n        //建立墙面\r\n        obj.wallData.forEach(function(wallobj, index){\r\n            var wallWidth = commonWidth;\r\n            var wallDepth = wallobj.depth||commonDepth;\r\n            var positionX = ((wallobj.startDot.x||0) + (wallobj.endDot.x||0)) / 2;\r\n            var positionY = ((wallobj.startDot.y || 0) + (wallobj.endDot.y || 0)) / 2;\r\n            var positionZ = ((wallobj.startDot.z || 0) + (wallobj.endDot.z || 0)) / 2;\r\n            //z相同 表示x方向为长度\r\n            if (wallobj.startDot.z == wallobj.endDot.z) {\r\n                wallWidth = Math.abs(wallobj.startDot.x - wallobj.endDot.x);\r\n                wallDepth = wallobj.depth || commonDepth;\r\n            } else if (wallobj.startDot.x == wallobj.endDot.x) {\r\n                wallWidth = wallobj.depth || commonDepth;\r\n                wallDepth = Math.abs(wallobj.startDot.z - wallobj.endDot.z);\r\n            }\r\n            var cubeobj = {\r\n                width: wallWidth,\r\n                height: wallobj.height || commonHeight,\r\n                depth: wallDepth,\r\n                rotation: wallobj.rotation,\r\n                x: positionX,\r\n                y: positionY,\r\n                z: positionZ,\r\n                uuid: wallobj.uuid,\r\n                name:wallobj.name,\r\n                style: {\r\n                    skinColor: commonSkin,\r\n                    skin:wallobj.skin\r\n                }\r\n            }\r\n            var cube = _this.createCube(cubeobj);\r\n            if (_this.commonFunc.hasObj(wallobj.childrens) && wallobj.childrens.length > 0) {\r\n                wallobj.childrens.forEach(function(walchildobj, index){\r\n                    var newobj = _this.CreateHole(walchildobj);\r\n                    cube = _this.mergeModel(walchildobj.op, cube, newobj,commonSkin);\r\n                })\r\n            }\r\n            _this.addObject(cube,\"scene\");\r\n        });\r\n    }\r\n    //模型合并 使用ThreeBSP插件mergeOP计算方式 -表示减去 +表示加上\r\n    mergeModel(mergeOP, fobj, sobj,commonSkin) {\r\n        var fobjBSP = new ThreeBSP(fobj);\r\n        var sobjBSP = new ThreeBSP(sobj);\r\n        var resultBSP = null;\r\n        if (mergeOP == '-') {\r\n            resultBSP = fobjBSP.subtract(sobjBSP);\r\n        } else if (mergeOP == '+') {\r\n            var subMesh = new THREE.Mesh(sobj);\r\n            sobj.updateMatrix();\r\n            fobj.geometry.merge(sobj.geometry, sobj.matrix);\r\n            return fobj;\r\n        //    resultBSP = fobjBSP.union(sobjBSP);\r\n        } else if (mergeOP == '&') {//交集\r\n            resultBSP = fobjBSP.intersect(sobjBSP);\r\n        } else {\r\n            this.addObject(sobj,\"scene\");\r\n            return fobj;\r\n        }\r\n        var cubeMaterialArray = [];\r\n        cubeMaterialArray.push(new THREE.MeshLambertMaterial({\r\n            vertexColors: THREE.FaceColors\r\n        }));\r\n        var result = resultBSP.toMesh(cubeMaterialArray);\r\n        result.material.shading = THREE.FlatShading;\r\n        result.geometry.computeFaceNormals();\r\n        result.geometry.computeVertexNormals();\r\n        result.uuid= fobj.uuid+mergeOP+sobj.uuid;\r\n        result.name=fobj.name+mergeOP+sobj.name;\r\n        result.material.needsUpdate = true;\r\n        result.geometry.buffersNeedUpdate = true;\r\n        result.geometry.uvsNeedUpdate = true;\r\n\r\n        result.material=fobj.material;\r\n\r\n        for (var i = 0; i < result.geometry.faces.length; i++) {\r\n            var faceset = false;\r\n            for (var j = 0; j < fobj.geometry.faces; j++) {\r\n                if (result.geometry.faces[i].vertexNormals[0].x === fobj.geometry.faces[j].vertexNormals[0].x\r\n                    && result.geometry.faces[i].vertexNormals[0].y === fobj.geometry.faces[j].vertexNormals[0].y\r\n                    && result.geometry.faces[i].vertexNormals[0].z === fobj.geometry.faces[j].vertexNormals[0].z\r\n                    && result.geometry.faces[i].vertexNormals[1].x === fobj.geometry.faces[j].vertexNormals[1].x\r\n                    && result.geometry.faces[i].vertexNormals[1].y === fobj.geometry.faces[j].vertexNormals[1].y\r\n                    && result.geometry.faces[i].vertexNormals[1].z === fobj.geometry.faces[j].vertexNormals[1].z\r\n                    && result.geometry.faces[i].vertexNormals[2].x === fobj.geometry.faces[j].vertexNormals[2].x\r\n                    && result.geometry.faces[i].vertexNormals[2].y === fobj.geometry.faces[j].vertexNormals[2].y\r\n                    && result.geometry.faces[i].vertexNormals[2].z === fobj.geometry.faces[j].vertexNormals[2].z) {\r\n                        result.geometry.faces[i].color.setHex(commonSkin);\r\n                        result.geometry.faces[i].materialIndex=fobj.geometry.faces[j].materialIndex\r\n                        faceset == true\r\n                }\r\n            }\r\n            if (faceset == false){\r\n                for(var j = 0; j < sobj.geometry.faces.length; j++) {\r\n                    if (result.geometry.faces[i].vertexNormals[0].x === sobj.geometry.faces[j].vertexNormals[0].x\r\n                        && result.geometry.faces[i].vertexNormals[0].y === sobj.geometry.faces[j].vertexNormals[0].y\r\n                        && result.geometry.faces[i].vertexNormals[0].z === sobj.geometry.faces[j].vertexNormals[0].z\r\n                        && result.geometry.faces[i].vertexNormals[1].x === sobj.geometry.faces[j].vertexNormals[1].x\r\n                        && result.geometry.faces[i].vertexNormals[1].y === sobj.geometry.faces[j].vertexNormals[1].y\r\n                        && result.geometry.faces[i].vertexNormals[1].z === sobj.geometry.faces[j].vertexNormals[1].z\r\n                        && result.geometry.faces[i].vertexNormals[2].x === sobj.geometry.faces[j].vertexNormals[2].x\r\n                        && result.geometry.faces[i].vertexNormals[2].y === sobj.geometry.faces[j].vertexNormals[2].y\r\n                        && result.geometry.faces[i].vertexNormals[2].z === sobj.geometry.faces[j].vertexNormals[2].z) {\r\n                        result.geometry.faces[i].color.setHex(commonSkin);\r\n                        result.geometry.faces[i].materialIndex=sobj.geometry.faces[j].materialIndex;\r\n                        faceset = true;\r\n                    }\r\n                }\r\n            }\r\n            if (faceset == false) {\r\n                //最后剩余的一点点给颜色\r\n                result.geometry.faces[i].color.setHex(commonSkin);\r\n            }\r\n        }\r\n\r\n        result.castShadow = true;\r\n        result.receiveShadow = true;\r\n        return result;\r\n    }\r\n    //挖洞、玻璃、挂东西\r\n    CreateHole ( obj) {\r\n        var commonDepth =  40;//厚度\r\n        var commonHeight =  100;//高度\r\n        var commonWidth =  300;//强体高度\r\n        var commonSkin = 0x98750f;\r\n        //建立墙面\r\n        var wallWidth = commonWidth;\r\n        var wallDepth = obj.depth || commonDepth;\r\n        var positionX = ((obj.startDot.x || 0) + (obj.endDot.x || 0)) / 2;\r\n        var positionY = ((obj.startDot.y || 0) + (obj.endDot.y || 0)) / 2;\r\n        var positionZ = ((obj.startDot.z || 0) + (obj.endDot.z || 0)) / 2;\r\n        //z相同 表示x方向为长度\r\n        if (obj.startDot.z == obj.endDot.z) {\r\n            wallWidth = Math.abs(obj.startDot.x - obj.endDot.x);\r\n            wallDepth = obj.depth || commonDepth;\r\n        } else if (obj.startDot.x == obj.endDot.x) {\r\n            wallWidth = obj.depth || commonDepth;\r\n            wallDepth = Math.abs(obj.startDot.z - obj.endDot.z);\r\n        }\r\n        var cubeobj = {\r\n            width: wallWidth,\r\n            height: obj.height || commonHeight,\r\n            depth: wallDepth,\r\n            rotation: obj.rotation,\r\n            uuid: obj.uuid,\r\n            name: obj.name,\r\n            objType: obj.objType,\r\n            x: positionX,\r\n            y: positionY,\r\n            z: positionZ,\r\n            style: {\r\n                skinColor: obj.skinColor || commonSkin,\r\n                skin: obj.skin\r\n            }\r\n        }\r\n        var cube=this.createCube(cubeobj);\r\n        return cube;\r\n    }\r\n    //创建盒子体\r\n    createCube(obj){\r\n        var width = obj.width || 1000;  //x轴\r\n        var height = obj.height || 10;  //y轴\r\n        var depth=obj.depth || width;  //z轴\r\n        var x = obj.x || 0, y = obj.y || 0, z = obj.z || 0;\r\n        var skinColor = obj.style.hasOwnProperty('skinColor')?obj.style.skinColor : \"\";\r\n        //width：是x方向上的长度；height：是y方向上的长度；depth：是z方向上的长度；\r\n        var cubeGeometry = new THREE.CubeGeometry(width, height, depth, 0, 0, 1);\r\n\r\n        //六面颜色\r\n        for (var i = 0; i < cubeGeometry.faces.length; i += 2) {\r\n            cubeGeometry.faces[i].color.setHex(skinColor);\r\n            cubeGeometry.faces[i + 1].color.setHex(skinColor);\r\n        }\r\n        //六面纹理\r\n        var skin_up_obj = {\r\n            vertexColors: THREE.FaceColors\r\n        }\r\n        var skin_down_obj = skin_up_obj,\r\n            skin_fore_obj = skin_up_obj,\r\n            skin_behind_obj = skin_up_obj,\r\n            skin_left_obj = skin_up_obj,\r\n            skin_right_obj = skin_up_obj;\r\n        var skin_opacity = 1;\r\n        if (obj.style != null && typeof (obj.style) != 'undefined'\r\n            && obj.style.skin != null && typeof (obj.style.skin) != 'undefined') {\r\n            //透明度\r\n            if (obj.style.skin.opacity != null && typeof (obj.style.skin.opacity) != 'undefined') {\r\n                skin_opacity = obj.style.skin.opacity;\r\n            }\r\n            let skin_right=obj.style.skin.hasOwnProperty(\"skin_right\")&&obj.style.skin.skin_right.hasOwnProperty('skinColor')?obj.style.skin.skin_right.skinColor:obj.style.skin.hasOwnProperty(\"skinColor\")?obj.style.skin.skinColor:\"\";\r\n            let skin_left=obj.style.skin.hasOwnProperty(\"skin_left\")&&obj.style.skin.skin_left.hasOwnProperty('skinColor')?obj.style.skin.skin_left.skinColor:obj.style.skin.hasOwnProperty(\"skinColor\")?obj.style.skin.skinColor:\"\";\r\n            let skin_up=obj.style.skin.hasOwnProperty(\"skin_up\")&&obj.style.skin.skin_up.hasOwnProperty('skinColor')?obj.style.skin.skin_up.skinColor:obj.style.skin.hasOwnProperty(\"skinColor\")?obj.style.skin.skinColor:\"\";\r\n            let skin_down=obj.style.skin.hasOwnProperty(\"skin_down\")&&obj.style.skin.skin_down.hasOwnProperty('skinColor')?obj.style.skin.skin_down.skinColor:obj.style.skin.hasOwnProperty(\"skinColor\")?obj.style.skin.skinColor:\"\";\r\n            let skin_fore=obj.style.skin.hasOwnProperty(\"skin_fore\")&&obj.style.skin.skin_fore.hasOwnProperty('skinColor')?obj.style.skin.skin_fore.skinColor:obj.style.skin.hasOwnProperty(\"skinColor\")?obj.style.skin.skinColor:\"\";\r\n            let skin_behind=obj.style.skin.hasOwnProperty(\"skin_behind\")&&obj.style.skin.skin_behind.hasOwnProperty('skinColor')?obj.style.skin.skin_behind.skinColor:obj.style.skin.hasOwnProperty(\"skinColor\")?obj.style.skin.skinColor:\"\";\r\n\r\n            //右\r\n            skin_right_obj = this.createSkinOption(depth, height, obj.style.skin.skin_right, cubeGeometry,skin_right, 0);\r\n            //左\r\n            skin_left_obj = this.createSkinOption(depth, height, obj.style.skin.skin_left, cubeGeometry,skin_left, 2);\r\n            //上\r\n            skin_up_obj = this.createSkinOption(width, depth, obj.style.skin.skin_up, cubeGeometry,skin_up, 4);\r\n            //下\r\n            skin_down_obj = this.createSkinOption(width, depth, obj.style.skin.skin_down, cubeGeometry,skin_down, 6);\r\n            //前\r\n            skin_fore_obj = this.createSkinOption(width, height, obj.style.skin.skin_fore, cubeGeometry,skin_fore, 8);\r\n            //后\r\n            skin_behind_obj = this.createSkinOption(width, height, obj.style.skin.skin_behind, cubeGeometry,skin_behind, 10);\r\n        }\r\n        var cubeMaterialArray = [];//右，左，上，下，前，后\r\n        //右：134、364；左：570、720；上：451、501；下：762、632；前：021、231；后：465、675；\r\n        //正面：上左上右下左下右(0123)；后面正对看：上左上右下左下右(4567)\r\n        cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_right_obj));\r\n        cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_left_obj));\r\n        cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_up_obj));\r\n        cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_down_obj));\r\n        cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_fore_obj));\r\n        cubeMaterialArray.push(new THREE.MeshLambertMaterial(skin_behind_obj));\r\n\r\n        var cube = new THREE.Mesh(cubeGeometry, cubeMaterialArray);\r\n        cube.castShadow = true;\r\n        cube.receiveShadow = true;\r\n        cube.uuid = obj.uuid;\r\n        cube.name = obj.name;\r\n        cube.position.set(x, y, z);\r\n        if (obj.rotation != null && typeof (obj.rotation) != 'undefined' && obj.rotation.length > 0) {\r\n            obj.rotation.forEach(function(rotation_obj, index){\r\n                // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\r\n                switch (rotation_obj.direction) {\r\n                    case 'x':\r\n                        cube.rotateX(rotation_obj.degree);\r\n                        break;\r\n                    case 'y':\r\n                        cube.rotateY(rotation_obj.degree);\r\n                        break;\r\n                    case 'z':\r\n                        cube.rotateZ(rotation_obj.degree);\r\n                        break;\r\n                    case 'arb':  //{ direction: 'arb', degree: [x,y,z,angle] }  x,y,z是向量0,1,0 表示y轴旋转\r\n                        cube.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\r\n                        break;\r\n                }\r\n            });\r\n        }\r\n        return cube;\r\n    }\r\n    // 创建桌子\r\n    CreateTable (obj) {\r\n        //初始以下为基点(中心点以机柜的中心为中心点)\r\n        var Cabinet,floorHeight=10,uuid=obj.uuid||this.commonFunc.guid();\r\n\r\n        //上\r\n        var upobj= {\r\n            show: true,\r\n            uuid: \"\",\r\n            name: \"cubetop\",\r\n            objType: 'cube',\r\n            width: obj.size.width,\r\n            height: obj.size.thick,\r\n            depth: obj.size.depth,\r\n            x: 0,\r\n            y: obj.size.height-obj.size.thick,\r\n            z: 0,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var upcube = this.createCube(upobj);\r\n\r\n        //左\r\n        var leftobj= {\r\n            show: true,\r\n            uuid: \"\",\r\n            name: \"cubeleft\",\r\n            objType: 'cube',\r\n            width: obj.size.thick ,\r\n            height: obj.size.height-2*obj.size.thick,\r\n            depth: obj.size.depth,\r\n            x: -(obj.size.width/2+obj.size.thick/2) * 0.9,\r\n            y: -obj.size.height/2+obj.size.thick/2,\r\n            z: 0,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var leftcube = this.createCube(leftobj);\r\n        Cabinet = this.mergeModel('+', upcube, leftcube);\r\n\r\n        //右\r\n        var rightobj= {\r\n            show: true,\r\n            uuid: \"\",\r\n            name: \"cuberight\",\r\n            objType: 'cube',\r\n            width: obj.size.thick ,\r\n            height: obj.size.height-2*obj.size.thick,\r\n            depth: obj.size.depth,\r\n            x: (obj.size.width/2-obj.size.thick/2) * 0.9,\r\n            y: -obj.size.height/2+obj.size.thick/2,\r\n            z: 0,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var rightcube = this.createCube(rightobj);\r\n        Cabinet = this.mergeModel('+', Cabinet, rightcube);\r\n\r\n        this.addObject(Cabinet,\"object\");  //这里也得给添加到对象，不然hour的时候设备的提示信息有问题，没拉出设备放机柜顶上也提示了\r\n\r\n        var tempobj = new THREE.Object3D();\r\n        tempobj.add(Cabinet);\r\n        tempobj.name = obj.name;\r\n        tempobj.uuid = uuid;\r\n        tempobj.data= obj.data||{name:obj.name,alarmInfo:[]};\r\n        tempobj.position.set(obj.x||0,(obj.y||0)+floorHeight,obj.z||0);\r\n        this.addObject(tempobj,\"object\");\r\n\r\n        if (obj.rotation != null && typeof (obj.rotation) != 'undefined' && obj.rotation.length > 0) {\r\n            obj.rotation.forEach(function(rotation_obj, index){\r\n                // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\r\n                switch (rotation_obj.direction) {\r\n                    case 'x':\r\n                        tempobj.rotateX(rotation_obj.degree);\r\n                        break;\r\n                    case 'y':\r\n                        tempobj.rotateY(rotation_obj.degree);\r\n                        break;\r\n                    case 'z':\r\n                        tempobj.rotateZ(rotation_obj.degree);\r\n                        break;\r\n                    case 'arb':  //{ direction: 'arb', degree: [x,y,z,angle] }\r\n                        tempobj.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\r\n                        break;\r\n                }\r\n            });\r\n        }\r\n        return tempobj;\r\n\r\n    }\r\n    //创建柜子\r\n    createEmptyCabinet(obj){\r\n        //初始以下为基点(中心点以机柜的中心为中心点)\r\n        var Cabinet,floorHeight=10,_this=this,uuid=obj.uuid||this.commonFunc.guid();\r\n        //下\r\n        var downobj= {\r\n            show: true,\r\n            name: \"cubedown\",\r\n            uuid:\"\",\r\n            objType: 'cube',\r\n            width: obj.size.width,\r\n            height: obj.size.thick,\r\n            depth: obj.size.depth,\r\n            x: 0,\r\n            y: -obj.size.height/2+obj.size.thick/2,\r\n            z: 0,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var downcube = this.createCube(downobj);\r\n\r\n        //上\r\n        var upobj= {\r\n            show: true,\r\n            uuid: \"\",\r\n            name: \"cubetop\",\r\n            objType: 'cube',\r\n            width: obj.size.width,\r\n            height: obj.size.thick,\r\n            depth: obj.size.depth,\r\n            x: 0,\r\n            y: obj.size.height-obj.size.thick,\r\n            z: 0,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var upcube = this.createCube(upobj);\r\n\r\n        Cabinet = this.mergeModel('+',downcube,upcube);\r\n\r\n        //左\r\n        var leftobj= {\r\n            show: true,\r\n            uuid: \"\",\r\n            name: \"cubeleft\",\r\n            objType: 'cube',\r\n            width: obj.size.thick ,\r\n            height: obj.size.height-2*obj.size.thick,\r\n            depth: obj.size.depth,\r\n            x: -obj.size.width/2+obj.size.thick/2,\r\n            y: obj.size.height/2-obj.size.thick/2,\r\n            z: 0,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var leftcube = this.createCube(leftobj);\r\n        Cabinet = this.mergeModel('+', Cabinet, leftcube);\r\n\r\n        //右\r\n        var rightobj= {\r\n            show: true,\r\n            uuid: \"\",\r\n            name: \"cuberight\",\r\n            objType: 'cube',\r\n            width: obj.size.thick ,\r\n            height: obj.size.height-2*obj.size.thick,\r\n            depth: obj.size.depth,\r\n            x: obj.size.width/2-obj.size.thick/2,\r\n            y: obj.size.height/2-obj.size.thick/2,\r\n            z: 0,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var rightcube = this.createCube(rightobj);\r\n        Cabinet = this.mergeModel('+', Cabinet, rightcube);\r\n\r\n        //后\r\n        var behindobj= {\r\n            show: true,\r\n            uuid: \"\",\r\n            name: '',\r\n            objType: 'cube',\r\n            width: obj.size.width ,\r\n            height: obj.size.height-2*obj.size.thick,\r\n            depth: obj.size.thick,\r\n            x: 0,\r\n            y: obj.size.height/2-obj.size.thick/2,\r\n            z: -obj.size.depth/2+obj.size.thick/2,\r\n            style: {\r\n                skinColor: obj.style.skinColor,\r\n                skin: obj.style.skin\r\n            }\r\n        }\r\n        var behindcube = this.createCube(behindobj);\r\n        Cabinet = this.mergeModel('+', Cabinet, behindcube);\r\n        this.addObject(Cabinet,\"object\");  //这里也得给添加到对象，不然hour的时候设备的提示信息有问题，没拉出设备放机柜顶上也提示了\r\n\r\n        var tempobj = new THREE.Object3D();\r\n        tempobj.add(Cabinet);\r\n        tempobj.name = obj.name;\r\n        tempobj.uuid = uuid;\r\n        tempobj.data= obj.data||{name:obj.name,alarmInfo:[]};\r\n        tempobj.position.set(obj.x||0,(obj.y||0)+floorHeight,obj.z||0);\r\n        this.addObject(tempobj,\"object\");\r\n        this.cabinet.push(tempobj);\r\n        //门\r\n        if(obj.doors!=null&&typeof (obj.doors) != 'undefined'){\r\n            if(obj.doors.skins.length==1&&obj.doors.doorname.length==1){\r\n                var doorobj = {\r\n                    show: true,\r\n                    uuid:\"\",\r\n                    name: obj.doors.doorname[0],\r\n                    objType: 'cube',\r\n                    depth: obj.size.thick,\r\n                    width: obj.size.width,\r\n                    height: obj.size.height-2*obj.size.thick,\r\n                    x: 0,\r\n                    y: 0,\r\n                    z: obj.size.depth/2-obj.size.thick/2+1,\r\n                    rotation:obj.doors.rotation||null,\r\n                    style: {\r\n                        skinColor: obj.doors.skins[0].skinColor,\r\n                        skin: obj.doors.skins[0]\r\n                    }\r\n                }\r\n                var doorcube = this.createCube(doorobj);\r\n                if(obj.doors.rotation){\r\n                    doorcube.position.set(obj.size.width/2,0,obj.size.depth/2-obj.size.thick/2+1+obj.size.width/2);\r\n                }\r\n                doorcube.tipInfo = obj.doors.tipInfo\r\n                tempobj.add(doorcube);\r\n                this.addObject(doorcube,\"object\")\r\n            }else if(obj.doors.skins.length==2&&obj.doors.doorname.length==2){\r\n                for(let i=0;i<obj.doors.skins.length;i++){\r\n                    let x=i===0?-obj.size.width/4:obj.size.width/4;\r\n                    var doorobj = {\r\n                        show: true,\r\n                        uuid:\"\",\r\n                        name: obj.doors.doorname[i],\r\n                        objType: 'cube',\r\n                        depth: obj.size.thick,\r\n                        width: obj.size.width/2,\r\n                        height: obj.size.height,\r\n                        x: x,\r\n                        y: 0,\r\n                        z: obj.size.depth/2-obj.size.thick/2+1,\r\n                        style: {\r\n                            skinColor: obj.doors.skins[i].skinColor,\r\n                            skin: obj.doors.skins[i]\r\n                        },\r\n                    }\r\n                    var doorcube = this.createCube(doorobj);\r\n                    tempobj.add(doorcube);\r\n                    this.addObject(doorcube,\"object\")\r\n                }\r\n            }\r\n        }\r\n        //机柜告警信息\r\n        if(this.commonFunc.hasObj(obj.data)){\r\n            //文本信息\r\n            var width=obj.size.width||70;\r\n            var height=obj.size.height||70;\r\n            var canvas = document.createElement('canvas');\r\n            canvas['width']=width;\r\n            canvas['height']=height;\r\n            var context = canvas.getContext('2d');\r\n            context.beginPath();\r\n            context.rect(0, 0, width, height);\r\n            context.fillStyle = 'rgba(255, 255, 255, 0)';  //canvas设置为透明\r\n            context.fill();\r\n\r\n            var marker=function(context, x, y,text){\r\n                var color='#ffffff';\r\n                context.font = 12+'px \"Microsoft Yahei\" ';\r\n                context.fillStyle = color;\r\n                context.textAlign = 'center';\r\n                context.textBaseline = 'middle';\r\n                context.strokeStyle=color;\r\n                context.fillText(text, x, y);\r\n            }\r\n            marker(context, width/2, height/2, obj.data.name);\r\n            var alarmobj={\r\n                width:width,\r\n                height:height,\r\n                imgurl:canvas,\r\n                y:obj.size.height/2+1,\r\n                transparent:true,\r\n                opacity:0.8,\r\n                rotation: [{ direction: 'x', degree: -0.5*Math.PI }],\r\n            }\r\n            var text=this.createPlaneGeometry(alarmobj);\r\n            tempobj.add(text);\r\n            //告警信息\r\n\r\n\r\n        }\r\n        if (this.commonFunc.hasObj(obj.childrens) && obj.childrens.length > 0) {\r\n            let equipmentUUID=[];\r\n            obj.childrens.forEach(function(service, index){\r\n                let serviceuuid=service.uuid||_this.commonFunc.guid();\r\n                service.x=obj.x;\r\n                service.z=obj.z;\r\n                service.y=service.y+floorHeight+(obj.y-(obj.size.height-2*obj.size.thick)/2);\r\n                service.rotation=obj.rotation||null;\r\n                var newobj = _this.createCube(service);\r\n                newobj.data=service.data;\r\n                newobj.data[\"cabinetUUID\"]=uuid;\r\n                newobj.uuid=serviceuuid;\r\n                equipmentUUID.push(serviceuuid);\r\n                _this.addObject(newobj);\r\n                _this.equipment.push(newobj);\r\n            })\r\n            tempobj.data[\"equipmentUUID\"]=equipmentUUID\r\n        }\r\n        if (obj.rotation != null && typeof (obj.rotation) != 'undefined' && obj.rotation.length > 0) {\r\n            obj.rotation.forEach(function(rotation_obj, index){\r\n                // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\r\n                switch (rotation_obj.direction) {\r\n                    case 'x':\r\n                        tempobj.rotateX(rotation_obj.degree);\r\n                        break;\r\n                    case 'y':\r\n                        tempobj.rotateY(rotation_obj.degree);\r\n                        break;\r\n                    case 'z':\r\n                        tempobj.rotateZ(rotation_obj.degree);\r\n                        break;\r\n                    case 'arb':  //{ direction: 'arb', degree: [x,y,z,angle] }\r\n                        tempobj.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\r\n                        break;\r\n                }\r\n            });\r\n        }\r\n        return tempobj;\r\n\r\n    }\r\n    //创建圆柱体\r\n    createCylinderPlant(obj){\r\n        var _this=this;\r\n        var radiusTop = obj.radiusTop || 20;  //顶面的半径\r\n        var radiusBottom = obj.radiusBottom || 20;  //底面的半径\r\n        var height=obj.height || 100;  //高度\r\n        var radiusSegments=obj.radiusSegments||8;\r\n        var heightSegments=obj.heightSegments||1;\r\n        var openEnded= obj.openEnded || false;\r\n        var x = obj.x || 0, y = obj.y || 0, z = obj.z || 0;\r\n        var skinColor = obj.style.skinColor || 0x98750f;\r\n        //创建圆柱体\r\n        var cylinderGeo = new THREE.CylinderGeometry(radiusTop, radiusBottom ,height ,radiusSegments,heightSegments,openEnded);\r\n        // console.log(cylinderGeo)\r\n        var cylinderMat = new THREE.MeshLambertMaterial({//创建材料\r\n            color:skinColor,\r\n            wireframe:false,\r\n        });\r\n        //创建圆柱体网格模型\r\n        var cylinder = new THREE.Mesh(cylinderGeo, cylinderMat);\r\n        cylinder.position.set(x, y, z);//设置圆柱坐标\r\n        if (this.commonFunc.hasObj(obj.childrens) && obj.childrens.length > 0) {\r\n            obj.childrens.forEach(function(childobj, index){\r\n                var newobj;\r\n                if(childobj.objType==\"plane\"){\r\n                    newobj = _this.createPlaneGeometry(childobj);\r\n                }else{\r\n                    newobj = _this.createCylinderPlant(childobj);\r\n                }\r\n                _this.addObject(newobj,\"scene\")\r\n                // cylinder = _this.mergeModel('+', cylinder, newobj,skinColor);\r\n            })\r\n        }\r\n        return cylinder\r\n    }\r\n    //创建平面\r\n    createPlaneGeometry (obj) {\r\n        var texture;\r\n        var transparent=obj.transparent;\r\n        if(obj.transparent!==false){\r\n            transparent=true;\r\n        }\r\n        if (typeof obj.imgurl == \"string\") {//传入的材质是图片路径，使用 textureloader加载图片作为材质\r\n            var loader = new THREE.TextureLoader();\r\n            // loader.setCrossOrigin(this.crossOrigin);\r\n            var imgurl=obj.imgurl;\r\n            if(obj.imgurl.indexOf(\"data:image/\")==-1){\r\n                imgurl=this.commonFunc.getPath(obj.imgurl);\r\n            }\r\n            texture = loader.load(imgurl, function () { }, undefined, function () { });\r\n        } else {\r\n            texture = new THREE.CanvasTexture(obj.imgurl)\r\n        }\r\n        var MaterParam = {//材质的参数\r\n            map: texture,\r\n            side: obj.side||THREE.DoubleSide,\r\n            // side:THREE.FrontSide,\r\n            transparent: transparent,\r\n            opacity: obj.opacity||1\r\n        }\r\n        if (obj.blending) {\r\n            MaterParam.blending = THREE.AdditiveBlending//使用饱和度叠加渲染\r\n        }\r\n        var plane = new THREE.Mesh(\r\n            new THREE.PlaneGeometry(obj.width, obj.height, 1, 1),\r\n            new THREE.MeshBasicMaterial(MaterParam)\r\n        );\r\n        plane.position.x = obj.x||0;\r\n        plane.position.y = obj.y||0;\r\n        plane.position.z = obj.z||0;\r\n        if (obj.rotation != null && typeof (obj.rotation) != 'undefined' && obj.rotation.length > 0) {\r\n            obj.rotation.forEach(function(rotation_obj, index){\r\n                // rotation: [{ direction: 'x', degree: 0.5*Math.PI }],\r\n                switch (rotation_obj.direction) {\r\n                    case 'x':\r\n                        plane.rotateX(rotation_obj.degree);\r\n                        break;\r\n                    case 'y':\r\n                        plane.rotateY(rotation_obj.degree);\r\n                        break;\r\n                    case 'z':\r\n                        plane.rotateZ(rotation_obj.degree);\r\n                        break;\r\n                    case 'arb':  //{ direction: 'arb', degree: [x,y,z,angle] }  x,y,z是向量0,1,0 表示y轴旋转\r\n                        plane.rotateOnAxis(new THREE.Vector3(rotation_obj.degree[0], rotation_obj.degree[1], rotation_obj.degree[2]), rotation_obj.degree[3]);\r\n                        break;\r\n                }\r\n            });\r\n        }\r\n        return plane;\r\n    }\r\n    //模型植物加载\r\n    createObjPlant(obj){\r\n        let _this=this;\r\n        var mtlLoader = new MTLLoader();\r\n        mtlLoader.load(_this.commonFunc.getPath('plant/plant.mtl'), function(materials) {\r\n            materials.preload();\r\n            var objLoader = new OBJLoader();\r\n            console.log(materials)\r\n            objLoader.setMaterials(materials);\r\n            objLoader.load(_this.commonFunc.getPath('plant/plant.obj'), function(object) {\r\n                obj.childrens.forEach(function(childobj){\r\n                    var newobj = object.clone();\r\n                    if(!newobj.objHandle){\r\n                        if(childobj.objHandle){\r\n                            newobj.objHandle=childobj.objHandle;\r\n                        }else if(obj.objHandle){\r\n                            newobj.objHandle=obj.objHandle;\r\n                        }\r\n                    }\r\n                    newobj=_this.handleObj(newobj);\r\n                    newobj.position.set(childobj.x||0, childobj.y||0, childobj.z||0);\r\n                    _this.scene.add( newobj );\r\n                });\r\n                _this.progressSuccess+=1;\r\n            }, _this.onProgress, _this.onError);\r\n        });\r\n    }\r\n    // 创建椅子\r\n    createObjChair (obj) {\r\n        let _this=this;\r\n        var mtlLoader = new MTLLoader();\r\n        mtlLoader.load(_this.commonFunc.getPath('chair/chair.mtl'), function(materials) {\r\n            materials.preload();\r\n            var objLoader = new OBJLoader();\r\n            objLoader.setMaterials(materials);\r\n            objLoader.load(_this.commonFunc.getPath('chair/chair.obj'), function(object) {\r\n\r\n                obj.childrens.forEach(function(childobj){\r\n                    var newobj = object.clone();\r\n                    if(!newobj.objHandle){\r\n                        if(childobj.objHandle){\r\n                            newobj.objHandle=childobj.objHandle;\r\n                        }else if(obj.objHandle){\r\n                            newobj.objHandle=obj.objHandle;\r\n                        }\r\n                    }\r\n                    newobj=_this.handleObj(newobj);\r\n                    newobj.position.set(childobj.x||0, childobj.y||0, childobj.z||0);\r\n                    _this.scene.add( newobj );\r\n                });\r\n                _this.progressSuccess+=1;\r\n            }, _this.onProgress, _this.onError);\r\n        });\r\n    }\r\n    // 创建桌子\r\n    createObjDesk (obj) {\r\n        let _this=this;\r\n        var mtlLoader = new MTLLoader();\r\n        mtlLoader.load(_this.commonFunc.getPath('desk/desk.mtl'), function(materials) {\r\n            // materials['materialsInfo']['Bamboo_Wood']['map_kd'] = _this.BASE_PATH + 'desk/bamboo-wood-semigloss-albedo.png'\r\n            // materials['materialsInfo']['Bamboo_Wood']['map_ns'] = _this.BASE_PATH + 'bamboo-wood-semigloss-roughness.png'\r\n            // materials['materialsInfo']['Bamboo_Wood']['refl'] = _this.BASE_PATH + 'bamboo-wood-semigloss-metal.png'\r\n            materials.preload();\r\n            var objLoader = new OBJLoader();\r\n\r\n            objLoader.setMaterials(materials);\r\n\r\n            objLoader.load(_this.commonFunc.getPath('desk/desk.obj'), function(object) {\r\n\r\n                obj.childrens.forEach(function(childobj){\r\n                    var newobj = object.clone();\r\n                    if(!newobj.objHandle){\r\n                        if(childobj.objHandle){\r\n                            newobj.objHandle=childobj.objHandle;\r\n                        }else if(obj.objHandle){\r\n                            newobj.objHandle=obj.objHandle;\r\n                        }\r\n                    }\r\n                    newobj=_this.handleObj(newobj);\r\n                    newobj.position.set(childobj.x||0, childobj.y||0, childobj.z||0);\r\n                    _this.scene.add( newobj );\r\n                });\r\n                _this.progressSuccess+=1;\r\n            }, _this.onProgress, _this.onError);\r\n        });\r\n    }\r\n    //模型灭火器\r\n    createObjAnnihilator(obj){\r\n        let _this=this;\r\n        var mtlLoader = new MTLLoader();\r\n        mtlLoader.load(_this.commonFunc.getPath('annihilator/annihilator.mtl'), function(materials) {\r\n            materials.preload();\r\n            var objLoader = new OBJLoader();\r\n            objLoader.setMaterials(materials);\r\n            objLoader.load(_this.commonFunc.getPath('annihilator/annihilator.obj'), function(object) {\r\n                obj.childrens.forEach(function(childobj){\r\n                    var newobj = object.clone();\r\n                    if(!newobj.objHandle){\r\n                        if(childobj.objHandle){\r\n                            newobj.objHandle=childobj.objHandle;\r\n                        }else if(obj.objHandle){\r\n                            newobj.objHandle=obj.objHandle;\r\n                        }\r\n                    }\r\n                    newobj=_this.handleObj(newobj);\r\n                    newobj.position.set(childobj.x||0, childobj.y||0, childobj.z||0);\r\n                    _this.scene.add( newobj );\r\n                });\r\n                _this.progressSuccess+=1;\r\n            }, _this.onProgress, _this.onError);\r\n        });\r\n    }\r\n    //摄像头\r\n    createObjCamera(obj){\r\n        var _this=this;\r\n        var mtlLoader = new MTLLoader();\r\n        mtlLoader.load(_this.commonFunc.getPath('camera/camera.mtl'), function(materials) {\r\n            materials.preload();\r\n            var objLoader = new OBJLoader();\r\n            objLoader.setMaterials(materials);\r\n            objLoader.load(_this.commonFunc.getPath('camera/camera.obj'), function(object) {\r\n                obj.childrens.forEach(function(childobj){\r\n                    var newobj = object.clone();\r\n                    if(!newobj.objHandle){\r\n                        if(childobj.objHandle){\r\n                            newobj.objHandle=childobj.objHandle;\r\n                        }else if(obj.objHandle){\r\n                            newobj.objHandle=obj.objHandle;\r\n                        }\r\n                    }\r\n                    newobj=_this.handleObj(newobj);\r\n                    newobj.position.set(childobj.x||0, childobj.y||0, childobj.z||0);\r\n                    _this.scene.add( newobj );\r\n                });\r\n                _this.progressSuccess+=1;\r\n            }, _this.onProgress, _this.onError);\r\n        });\r\n    }\r\n    handleObj(obj){\r\n        if (obj.objHandle != null && typeof (obj.objHandle) != 'undefined' && obj.objHandle.length > 0) {\r\n            obj.objHandle.forEach(function(childobj){\r\n                // objHandle: [{ direction: 'x', ratio: 0.5 ,degree:0.5*Math.PI}],\r\n                switch (childobj.direction) {\r\n                    case 'x':\r\n                        if(childobj.ratio){\r\n                            obj.scale.x=childobj.ratio;\r\n                        }\r\n                        if(childobj.degree){\r\n                            obj.rotateX(childobj.degree);\r\n                        }\r\n                        break;\r\n                    case 'y':\r\n                        if(childobj.ratio){\r\n                            obj.scale.y=childobj.ratio;\r\n                        }\r\n                        if(childobj.degree){\r\n                            obj.rotateY(childobj.degree);\r\n                        }\r\n                        break;\r\n                    case 'z':\r\n                        if(childobj.ratio){\r\n                            obj.scale.z=childobj.ratio;\r\n                        }\r\n                        if(childobj.degree){\r\n                            obj.rotateZ(childobj.degree);\r\n                        }\r\n                        break;\r\n                    case 'arb':  //{ direction: 'arb', handleScale: [0.01,0.01,0.01], handleRotale: [0,1,0,0.5*Math.PI]}\r\n                        if(childobj.handleScale&&childobj.handleScale.length==3){\r\n                            obj.scale.set(childobj.handleScale[0],childobj.handleScale[1],childobj.handleScale[2]);\r\n                        }\r\n                        if(childobj.handleRotale&&childobj.handleRotale.length==4){\r\n                            obj.rotateOnAxis(new THREE.Vector3(childobj.handleRotale[0],childobj.handleRotale[1],childobj.handleRotale[2]), childobj.handleRotale[3]);\r\n                        }\r\n                        break;\r\n                }\r\n            });\r\n        }\r\n        return obj;\r\n    }\r\n    //进度通知\r\n    onProgress = function ( xhr) {\r\n        if ( xhr.lengthComputable ) {\r\n            var percentComplete = xhr.loaded / xhr.total * 100;\r\n            // console.log( Math.round( percentComplete, 2 ) + '% downloaded' );\r\n        }\r\n    };\r\n    //报错通知\r\n    onError = function ( xhr ) { };\r\n    //设置旋转中心\r\n    changePivot(obj,x,y,z){\r\n        let tempobj = new THREE.Object3D();\r\n        tempobj.position.set(obj.position.x + x , obj.position.y+y, obj.position.z+z);\r\n        obj.position.set(-x, -y, -z);\r\n        tempobj.add(obj);\r\n        return tempobj;\r\n    }\r\n    //添加对象\r\n    addObject (obj,info) {\r\n        if(info){\r\n            if(info==\"object\"){\r\n                this.objects.push(obj);\r\n            }\r\n            if(info==\"scene\"){\r\n                this.scene.add(obj);\r\n            }\r\n        }else{\r\n            this.objects.push(obj);\r\n            this.scene.add(obj);\r\n        }\r\n    }\r\n    //创建皮肤材质操作\r\n    createSkinOption (width,height, obj, cube,cubeColor, cubefacenub) {\r\n        if (this.commonFunc.hasObj(obj)) {\r\n            if (this.commonFunc.hasObj(obj.imgUrl)) {\r\n                var MaterParam={\r\n                    color:cubeColor,\r\n                    map: this.createSkin(width, height, obj),\r\n                    opacity: obj.opacity||1,\r\n                }\r\n                if(obj.transparent){\r\n                    MaterParam.transparent=obj.transparent;\r\n                }\r\n                if (obj.blending) {\r\n                    MaterParam.blending = THREE.AdditiveBlending//使用饱和度叠加渲染\r\n                }\r\n                return MaterParam;\r\n            } else {\r\n                if (this.commonFunc.hasObj(obj.skinColor)) {\r\n                    cube.faces[cubefacenub].color.setHex(obj.skinColor);\r\n                    cube.faces[cubefacenub + 1].color.setHex(obj.skinColor);\r\n                }\r\n                return {\r\n                    vertexColors: THREE.FaceColors\r\n                }\r\n            }\r\n        } else {\r\n            return {\r\n                vertexColors: THREE.FaceColors\r\n            }\r\n        }\r\n    }\r\n    //使用材质图片\r\n    createSkin (width,height,obj) {\r\n        var imgwidth = 128,imgheight=128;\r\n        if (obj.width != null&& typeof (obj.width) != 'undefined') {\r\n            imgwidth = obj.width;\r\n        }\r\n        if (obj.height != null && typeof (obj.height) != 'undefined') {\r\n            imgheight = obj.height;\r\n        }\r\n        var texture = new THREE.TextureLoader().load(this.commonFunc.getPath(obj.imgUrl));\r\n        var repeat = false;\r\n        if (obj.repeatx != null && typeof (obj.repeatx) != 'undefined' && obj.repeatx==true) {\r\n            texture.wrapS = THREE.RepeatWrapping;\r\n            repeat = true;\r\n        }\r\n        if (obj.repeaty != null && typeof (obj.repeaty) != 'undefined' && obj.repeaty == true) {\r\n            texture.wrapT = THREE.RepeatWrapping;\r\n            repeat = true;\r\n        }\r\n        if (repeat) {\r\n            texture.repeat.set(width / imgwidth, height / imgheight);\r\n        }\r\n        return texture;\r\n    }\r\n    //创建文字\r\n    createText(floorWidth,floorHeight){\r\n        var canvas = document.createElement('canvas');\r\n\t\tcanvas['width']=1024;\r\n\t\tcanvas['height']=1024;\r\n\t\tvar context = canvas.getContext('2d');\r\n\t\tcontext.beginPath();\r\n        context.rect(0, 0, 1024, 1024);\r\n        context.fillStyle = 'rgba(255, 255, 255, 0)';  //canvas设置为透明\r\n\t\tcontext.fill();\r\n\r\n\t\tvar marker=function(context, text, text2, x, y){\r\n\t\t\tvar color='#0B2F3A';//'#0B2F3A';//'#FE642E';\r\n\t\t\tcontext.font = 30+'px \"Microsoft Yahei\" ';\r\n\t\t\tcontext.fillStyle = color;\r\n\t\t\tcontext.textAlign = 'center';\r\n\t\t\tcontext.textBaseline = 'middle';\r\n\t\t\t//context.shadowBlur = 30;\r\n\t\t\tcontext.strokeStyle=color;\r\n\t\t\tcontext.lineWidth=3;\r\n            context.strokeText(text, x, y);\r\n\r\n\t\t\tif(!text2) return;\r\n\t\t\ty+=30;\r\n\t\t\tcolor='#FE642E';\r\n\t\t\tcontext.font = 16+'px \"Microsoft Yahei\" ';\r\n\t\t\tcontext.fillStyle = color;\r\n\t\t\tcontext.textAlign = 'center';\r\n\t\t\tcontext.textBaseline = 'middle';\r\n\t\t\tcontext.fillText(text2, x, y);\r\n\t\t}\r\n\t\tmarker(context, '阿里巴巴', 'ip待分配', 500, 380);\r\n\t\tmarker(context, '腾讯', '192.168.1.150', 500, 495);\r\n\t\tmarker(context, '依米康·龙控', '192.168.1.100', 500, 610);\r\n        var obj={\r\n            width:floorHeight,\r\n            height:floorWidth,\r\n            imgurl:canvas,\r\n            y:6,\r\n            transparent:true,\r\n            opacity:0.8,\r\n            rotation: [{ direction: 'x', degree: -0.5*Math.PI },{ direction: 'z', degree: 0.5*Math.PI }],\r\n        }\r\n        var text=this.createPlaneGeometry(obj);\r\n        this.scene.add(text);\r\n    }\r\n    //更新告警状态\r\n    updateAlarmStatus(arr){\r\n        for(let i=0;i<this.equipment.length;i++){\r\n            for(let j=0;j<arr.length;j++){\r\n                if(arr[j].devid==this.equipment[i].data.devid&&arr[j].pointid==this.equipment[i].data.pointid){\r\n                    for(let m=0;m<this.sprite.length;m++){\r\n                        if(this.sprite[m].data.cabinetUUID==this.equipment[i].data.cabinetUUID){\r\n                            this.changeCabinetAlarmObj(arr[j],m,i);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    //更新机柜的告警对象\r\n    changeCabinetAlarmObj(obj,spriteIndex,equipmentIndex){\r\n        let arr=this.sprite[spriteIndex].data.alarmInfo;\r\n\r\n        this.sprite[spriteIndex].material.map\r\n        if(obj.isalarm){\r\n            if(Number(this.sprite[spriteIndex].data.level)<Number(obj.level)){\r\n                this.sprite[spriteIndex].data.level=obj.level;\r\n                this.sprite[spriteIndex].material.color.set(this.alarmColor[\"level\"+obj.level]);\r\n            }\r\n            let flag=true; //默认是新的告警\r\n            for(let i=0;i<arr.length;i++){\r\n                if(arr[i].devid==obj.devid&&arr[i].pointid==obj.pointid){ //已经存在的告警再次告警\r\n                    arr.splice(i,1,obj);\r\n                    flag=false;\r\n                }\r\n            }\r\n            if(flag){\r\n                arr.push(obj);\r\n            }\r\n            if(this.equipment[equipmentIndex].material.length>0){\r\n                for(let i=0;i<this.equipment[equipmentIndex].material.length;i++){\r\n                    this.equipment[equipmentIndex].material[i].color.set(this.alarmColor[\"level\"+obj.level]);\r\n                }\r\n            }\r\n            this.equipment[equipmentIndex].data.isalarm=true;\r\n            this.sprite[spriteIndex].visible=obj.isalarm;\r\n            let info=obj.name+obj.alarmInfo;\r\n            this.alarmPlay(info);\r\n        }else{\r\n            if(arr.length>0){\r\n                for(let i=0;i<arr.length;i++){\r\n                    if(arr[i].devid==obj.devid&&arr[i].pointid==obj.pointid){\r\n                        arr.splice(i,1);\r\n                    }\r\n                }\r\n                if(arr.length>0){\r\n                    let levelArr=[];\r\n                    for(let i=0;i<arr.length;i++){\r\n                        levelArr.push(arr[i].level);\r\n                    }\r\n                    let max=Math.max(...levelArr);\r\n                    this.sprite[spriteIndex].data.level=max;\r\n                    this.sprite[spriteIndex].material.color.set(this.alarmColor[\"level\"+max]);\r\n                }else{\r\n                    this.sprite[spriteIndex].data.level=\"1\";\r\n                    this.sprite[spriteIndex].visible=false;\r\n                }\r\n            }\r\n            if(this.equipment[equipmentIndex].material.length>0){\r\n                for(let i=0;i<this.equipment[equipmentIndex].material.length;i++){\r\n                    this.equipment[equipmentIndex].material[i].color.set(\"#ffffff\");\r\n                }\r\n            }\r\n        }\r\n    }\r\n    //告警播放\r\n    alarmPlay(info){\r\n        let utterThis = new window.SpeechSynthesisUtterance();\r\n        utterThis.text=info;\r\n        utterThis.lang=\"zh-CN\";  //使用语言\r\n        utterThis.pitch=2; //表示说话的音高，数值，范围从0（最小）到2（最大）。默认值为1\r\n        utterThis.rate=1;  // 语速，数值，默认值是1，范围是0.1到10，表示语速的倍数，例如2表示正常语速的两倍\r\n        utterThis.volume=1;  //声音的音量，区间范围是0到1，默认是1\r\n        window.speechSynthesis.speak(utterThis);\r\n    }\r\n    commonFunc={\r\n        _this:this,\r\n        //判断对象\r\n        hasObj: function (obj) {\r\n            if (obj != null && typeof (obj) != 'undefined') {\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n        },\r\n        //查找对象\r\n        findObject: function (objname) {\r\n            var findedobj = null;\r\n            this.objects.forEach(function(obj, index){\r\n                if (obj.name != null && obj.name != '' && obj.name == objname) {\r\n                    findedobj = obj;\r\n                    return findedobj;\r\n                }\r\n            });\r\n            return findedobj;\r\n        },\r\n        //获取路径\r\n        getPath: function(file){\r\n            return this._this.BASE_PATH+file;\r\n        },\r\n        //生成GUID\r\n        guid:function(){\r\n            return (this.guidRandom()+this.guidRandom()+\"-\"+this.guidRandom()+\"-\"+this.guidRandom()+\"-\"+this.guidRandom()+\"-\"+this.guidRandom()+this.guidRandom()+this.guidRandom());\r\n        },\r\n        guidRandom() {\r\n            return (((1+Math.random())*0x10000)|0).toString(16).substring(1);\r\n        }\r\n    }\r\n\r\n\r\n    /*\r\n    *事件部分\r\n    */\r\n\r\n    //鼠标按下事件\r\n    onDocumentMouseDown (event) {\r\n        this.dbclick++;\r\n        var _this = this;\r\n        setTimeout(function () { _this.dbclick =0}, 500);\r\n        event.preventDefault();\r\n        if (this.dbclick >= 2) {\r\n            // 将鼠标位置归一化为设备坐标。x 和 y 方向的取值范围是 (-1 to +1)\r\n            this.mouseClick.x = (event.offsetX / this.dom.offsetWidth) * 2 - 1;\r\n            this.mouseClick.y = -(event.offsetY / this.dom.offsetHeight) * 2 + 1;\r\n            this.raycaster.setFromCamera(this.mouseClick, this.camera);\r\n            var intersects = this.raycaster.intersectObjects(this.objects);\r\n            if (intersects.length > 0) {\r\n                this.controls.enabled=false;\r\n                let SELECTED = intersects[0].object;\r\n                // console.log(SELECTED)\r\n                if(this.eventList != null && this.eventList.dbclick != null && this.eventList.dbclick.length > 0){\r\n                    this.eventList.dbclick.forEach(function(_obj, index){\r\n                        if (\"string\" == typeof (_obj.obj_name)) {\r\n                            if (_obj.obj_name == SELECTED.name) {\r\n                                _obj.obj_event(SELECTED,_this);\r\n                            }\r\n                        }else if (_obj.findObject!=null||'function' == typeof (_obj.findObject)) {\r\n                            if (_obj.findObject(SELECTED.name)) {\r\n                                _obj.obj_event(SELECTED,_this);\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n                this.controls.enabled = true;\r\n            }\r\n        }\r\n    }\r\n    openCloseDoor(obj,x,y,z,info){\r\n        console.log(obj)\r\n        var doorstate = \"close\";\r\n        var tempobj = null;\r\n        if (obj.doorState != null && typeof (obj.doorState) != 'undefined') {\r\n            doorstate = obj.doorState;\r\n            tempobj = obj.parent;\r\n        } else {\r\n            console.log(\"add parent\");\r\n            var objparent = obj.parent;\r\n            tempobj = new THREE.Object3D();\r\n            tempobj.position.set(obj.position.x + x , obj.position.y+y, obj.position.z+z);\r\n            obj.position.set(-x, -y, -z);\r\n            tempobj.add(obj);\r\n            objparent.add(tempobj);\r\n        }\r\n        obj.doorState = (doorstate == \"close\" ? \"open\" : \"close\");\r\n        if(info==\"left\"||info==\"right\"){\r\n            let sign=info==\"left\"?1:-1;\r\n            if(obj.doorState==\"close\"){\r\n                tempobj.rotateOnAxis(new THREE.Vector3(0, 1, 0), 0.5*sign*Math.PI);\r\n            }else{\r\n                tempobj.rotateOnAxis(new THREE.Vector3(0, 1, 0), -0.5*sign*Math.PI);\r\n            }\r\n        }else if(info==\"outin\"){\r\n            //沿点击的法向量移动\r\n            // var intersects = this.raycaster.intersectObjects([obj]);\r\n            // if (intersects.length > 0) {\r\n            //     // 射线位置赋值给移动网格模型\r\n            //     tempobj.position.copy(intersects[0].point);\r\n            //     // 沿着法线方向平移移动的网格模型\r\n            //     var normal = intersects[0].face.normal;// 当前位置曲面法线\r\n            //     tempobj.translateOnAxis(normal,50); //平移50\r\n            // }\r\n\r\n            var targetPos = new THREE.Vector3(1,0,0);\r\n            // var euler = new THREE.Euler( 1, 0,0);\r\n            // var matrix = new THREE.Matrix4();  //创建一个4维矩阵\r\n            // matrix.lookAt(obj.position.clone() , obj.position.clone() , targetPos) //设置朝向\r\n            // matrix.multiply(new THREE.Matrix4().makeRotationFromEuler(euler))\r\n            // var toRot = new THREE.Quaternion().setFromRotationMatrix(matrix)\r\n            // tempobj.translateOnAxis(toRot,50);\r\n            if(obj.doorState==\"close\"){\r\n                tempobj.translateOnAxis(targetPos,-obj.geometry.parameters.depth+20);\r\n            }else{\r\n                tempobj.translateOnAxis(targetPos,obj.geometry.parameters.depth-20);\r\n            }\r\n\r\n            //使用四元素朝某个角度移动\r\n            // var targetPos = new THREE.Vector3(0,0,1)   //目标位置点\r\n            // var offsetAngle = Math.PI/2  //目标移动时的朝向偏移\r\n            // // var obj =  你的三维模型(或者其他物体对象，object3D ,group ,或者mesh对象)\r\n            // //以下代码在多段路径时可重复执行\r\n            // var matrix = new THREE.Matrix4()  //创建一个4维矩阵\r\n            // matrix.lookAt(obj.position.clone() , obj.position.clone() ,targetPos) //设置朝向\r\n            // matrix.multiply(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(0 , offsetAngle , 0 )))\r\n            // var toRot = new THREE.Quaternion().setFromRotationMatrix(matrix)  //计算出需要进行旋转的四元数值\r\n            // tempobj.translateOnAxis(toRot,50);\r\n\r\n\r\n\r\n\r\n            // if(obj.doorState==\"close\"){\r\n            //     tempobj.translateOnAxis(new THREE.Vector3(0, 0, 1),-obj.geometry.parameters.depth);\r\n            // }else{\r\n            //     tempobj.translateOnAxis(new THREE.Vector3(0, 0, 1),obj.geometry.parameters.depth);\r\n            // }\r\n        }\r\n\r\n    }\r\n    //开关左门\r\n    openLeftDoor(_obj,func) {\r\n        this.openCloseDoor(_obj,-_obj.geometry.parameters.width/2,0,0,\"left\");\r\n    }\r\n    //开关右门\r\n    openRightDoor(_obj,func) {\r\n        this.openCloseDoor(_obj,_obj.geometry.parameters.width/2,0,0,\"right\");\r\n    }\r\n    //开关机柜门\r\n    openCabinetDoor(_obj,func) {\r\n        this.openCloseDoor(_obj,_obj.geometry.parameters.width/2,0,_obj.geometry.parameters.depth/2,\"right\");\r\n    }\r\n    //拉出放回设备\r\n    openEquipmentDoor(_obj,func){\r\n        this.openCloseDoor(_obj,0,0,_obj.geometry.parameters.depth/2,\"outin\");\r\n    }\r\n    //鼠标移动\r\n    onDocumentMouseMove(event){\r\n        let _this=this;\r\n        var currentElement = null;\r\n        this.mouseClick.x = (event.offsetX / this.dom.offsetWidth) * 2 - 1;\r\n        this.mouseClick.y = -(event.offsetY / this.dom.offsetHeight) * 2 + 1;\r\n        this.raycaster.setFromCamera(this.mouseClick, this.camera);\r\n        var intersects = this.raycaster.intersectObjects(this.objects);\r\n        if(intersects.length>0){\r\n            let SELECTED = intersects[0].object;\r\n            // console.log(SELECTED)\r\n            if(SELECTED.name.toString().indexOf(\"equipment\")!=-1\r\n                ||SELECTED.name.toString().indexOf(\"spriteAlarm\")!=-1\r\n            ){\r\n                currentElement = SELECTED;\r\n            }\r\n        }\r\n        if (this.lastElement != currentElement ) {\r\n            clearTimeout(this.tipTimer);\r\n            if(currentElement){\r\n                this.tipTimer = setTimeout(function(){\r\n                    // console.log(currentElement)\r\n                    let tipInfo=\"\";\r\n                    if(currentElement.name.toString().indexOf(\"equipment\")!=-1){\r\n                        tipInfo=currentElement.data.tipInfo;\r\n                        _this.tooltip.style.background = _this.tooltipBG;\r\n                        _this.tooltip.querySelector(\"span\").style.borderTop=\"10px solid \"+_this.tooltipBG;\r\n                    }\r\n                    if(currentElement.name.toString().indexOf(\"spriteAlarm\")!=-1){\r\n                        // console.log(currentElement)\r\n                        tipInfo=currentElement.data.tipInfo;\r\n                        _this.tooltip.style.background = _this.tooltipBG;\r\n                        _this.tooltip.querySelector(\"span\").style.borderTop=\"10px solid \"+_this.tooltipBG;\r\n\r\n                    }\r\n                    let tiplen=tipInfo.length;\r\n                    _this.tooltip.querySelector(\"#tipdiv\").innerHTML=tipInfo\r\n                    _this.tooltip.style.width=tiplen*15+\"px\";\r\n                    _this.tooltip.style.display = 'block';\r\n                    _this.tooltip.style.left = (_this.lastEvent.pageX - _this.tooltip.clientWidth/2) + 'px';\r\n                    _this.tooltip.style.top = (_this.lastEvent.pageY - _this.tooltip.clientHeight - 15) + 'px';\r\n                },1000);\r\n            }\r\n        }\r\n        //设置上一次的网元为当前网元\r\n        this.lastElement = currentElement;\r\n        //如果当前鼠标下没有网元，隐藏tooltip\r\n        if(currentElement == null){\r\n            _this.tooltip.style.display = 'none';\r\n        }\r\n        //设置每次移动时鼠标的事件对象\r\n        this.lastEvent = event;\r\n    }\r\n    //测试\r\n    add(){\r\n        var _this=this;\r\n        //测试生成obj带材质\r\n        // this.createObjContainMtl()\r\n\r\n        //3,测点管道\r\n        // var points = [];\r\n        // points.push(new THREE.Vector3(0, 0, -10));\r\n        // points.push(new THREE.Vector3(0, 0, 10));\r\n        // var curvePath = new THREE.CatmullRomCurve3(points);\r\n        // var geometry = new THREE.TubeGeometry( curvePath, 20, 2, 8, false );\r\n        // var material = new THREE.MeshBasicMaterial( { color: 0xff0000 ,side:THREE.DoubleSide } );\r\n        // var mesh = new THREE.Mesh( geometry, material );\r\n        // this.scene.add( mesh );\r\n        ////自定义管道\r\n        // var cylinderGeo = new THREE.CylinderGeometry(4, 4 ,20 ,48,48);\r\n        // var cylinderMat = new THREE.MeshLambertMaterial({\r\n        //     color:0xffffff,\r\n        //     side:THREE.DoubleSide,\r\n        //     // map: this.createSkin(64,64,{imgurl:\"./images/rack_inside.png\"})\r\n        // });\r\n        // var cylinderMat2 = new THREE.MeshLambertMaterial({\r\n        //     color:0xffffff,\r\n        //     side:THREE.DoubleSide,\r\n        //     // map: this.createSkin(64,64,{imgurl:\"./images/test/camera.png\"})\r\n        // });\r\n        // var cylinder = new THREE.Mesh(cylinderGeo, cylinderMat);\r\n        // var cubeGeometry = new THREE.CubeGeometry(6.5, 20, 6.5, 0, 0, 1);\r\n        // var cube = new THREE.Mesh(cubeGeometry, cylinderMat);\r\n        // var pipe = this.mergeModel('+',cylinder,cube);\r\n        // var cylinderGeo1 = new THREE.CylinderGeometry(3.5, 3.5 ,20 ,48,48);\r\n        // var cylinder1 = new THREE.Mesh(cylinderGeo1, cylinderMat);\r\n        // pipe=this.mergeModel(\"-\",pipe,cylinder1);\r\n        // var cylinderGeo2 = new THREE.CylinderGeometry(2.5, 2.5 ,20 ,48,48);\r\n        // var cylinder2 = new THREE.Mesh(cylinderGeo2, cylinderMat2);\r\n        // pipe=this.mergeModel(\"+\",pipe,cylinder2);\r\n        // pipe.rotateX(0.5*Math.PI);\r\n        // this.scene.add(pipe);//网格模型添加到场景中\r\n\r\n        //4.测试加载模型\r\n        // var texture = new THREE.TextureLoader().load( './images/test/metal.png' );\r\n        // var texture1 = new THREE.TextureLoader().load( './images/test/camera_light.png' );\r\n        // var texture2 = new THREE.TextureLoader().load( './images/test/camera_dot.png' );\r\n        // var loader =new OBJLoader();\r\n        // loader.load( './images/test/camera.obj', function ( group ) {\r\n        //     console.log(group)\r\n        //     group.traverse( function ( child ) {\r\n        //         console.log(child)\r\n        //         if ( child instanceof THREE.Mesh) {\r\n        //             if(child.name==\"archmodels95_044_001\"){\r\n        //                 child.material.map = texture;\r\n        //             }else if(child.name==\"archmodels95_044_003\"){\r\n        //                 child.material.map = texture1;\r\n        //             }else{\r\n        //                 child.material.map = texture2;\r\n        //             }\r\n\r\n        //         }\r\n        //     });\r\n        //     _this.scene.add( group );\r\n        // })\r\n\r\n        //测试加载材质模型\r\n        // var mtlLoader = new MTLLoader();\r\n        // mtlLoader.load('./images/test/plant.mtl', function(materials) {\r\n        //     materials.preload();\r\n        //     console.log(materials)-\r\n        //     var objLoader = new OBJLoader();\r\n        //     objLoader.setMaterials(materials);\r\n        //     objLoader.load('./images/test/plant.obj', function(object) {\r\n        //         console.log(object)\r\n        //         _this.scene.add(object);\r\n        //     }, onProgress, onError);\r\n        // });\r\n        // var onProgress = function(xhr) {\r\n        //     if (xhr.lengthComputable) {\r\n        //         var percentComplete = xhr.loaded / xhr.total * 100;\r\n        //         console.log(Math.round(percentComplete, 2) + '% 已经加载')\r\n        //     }\r\n        // }\r\n        // var onError =function(){}\r\n\r\n        //1、测试ThreeBSP用的\r\n        //几何体对象\r\n        // let cylinder = new THREE.CylinderGeometry(50,50,5,40);//圆柱\r\n        // let box = new THREE.BoxGeometry(40,5,40);//立方体\r\n        // //材质对象\r\n        // let material=new THREE.MeshPhongMaterial({color:0x0000ff});\r\n        // //网格模型对象\r\n        // let cylinderMesh=new THREE.Mesh(cylinder,material);//圆柱\r\n        // let boxMesh=new THREE.Mesh(box,material);//立方体\r\n        // //包装成ThreeBSP对象\r\n        // let cylinderBSP = new ThreeBSP(cylinderMesh);\r\n        // let boxBSP = new ThreeBSP(boxMesh);\r\n        // let result = cylinderBSP.subtract(boxBSP);\r\n        // //ThreeBSP对象转化为网格模型对象\r\n        // let mesh = result.toMesh();\r\n        // this.scene.add(mesh);//网格模型添加到场景中\r\n\r\n        // //2、试圆柱体贴图\r\n        // //创建圆柱体\r\n        // var cylinderGeo = new THREE.CylinderGeometry(28, 30 ,200 ,48,48);\r\n        // cylinderGeo.computeBoundingBox();\r\n        // var max = cylinderGeo.boundingBox.max,\r\n        //         min = cylinderGeo.boundingBox.min;\r\n        //         console.log(cylinderGeo)\r\n        //         console.log(max)\r\n        //         console.log(min)\r\n        // var offset = new THREE.Vector2(0 - min.x, 0 - min.y);\r\n        // var range = new THREE.Vector2(max.x - min.x, max.y - min.y);\r\n        // var faces = cylinderGeo.faces;\r\n        // cylinderGeo.faceVertexUvs[0] = [];\r\n        // for (var i = 0; i < faces.length ; i++) {\r\n        //     var v1 = cylinderGeo.vertices[faces[i].a],\r\n        //             v2 = cylinderGeo.vertices[faces[i].b],\r\n        //             v3 = cylinderGeo.vertices[faces[i].c];\r\n        //     cylinderGeo.faceVertexUvs[0].push([\r\n        //         new THREE.Vector2((v1.x + offset.x) / range.x, (v1.y + offset.y) / range.y),\r\n        //         new THREE.Vector2((v2.x + offset.x) / range.x, (v2.y + offset.y) / range.y),\r\n        //         new THREE.Vector2((v3.x + offset.x) / range.x, (v3.y + offset.y) / range.y)\r\n        //     ]);\r\n        // }\r\n        // cylinderGeo.uvsNeedUpdate = true;\r\n\r\n\r\n        // console.log(cylinderGeo)\r\n        // var cylinderMat = new THREE.MeshLambertMaterial({//创建材料\r\n        //     color:0xffffff,\r\n        //     wireframe:false,\r\n        //     opacity: 0.1,\r\n        //     map: this.createSkin(60,200,{imgurl:\"./images/aircondition.png\"})\r\n        // });\r\n        // //创建圆柱体网格模型\r\n        // var cylinder = new THREE.Mesh(cylinderGeo, cylinderMat);\r\n        // this.scene.add(cylinder);//网格模型添加到场景中\r\n\r\n    }\r\n    //测试自己生成obj文件带mtl材质的\r\n    createObjContainMtl(){\r\n        //如果obj文件没有包含材质关联的时候，自己生成带材质的关联obj文件\r\n        let _this=this;\r\n        var leaftexture = new THREE.TextureLoader().load( './images/plant/Archmodels66_leaf_33.jpg' );\r\n        var soiltexture = new THREE.TextureLoader().load( './images/plant/Archmodels66_dirt_1.jpg' );\r\n        var barktexture = new THREE.TextureLoader().load( './images/plant/Archmodels66_bark_1.jpg' );\r\n        var jardinieretexture = new THREE.TextureLoader().load( './images/plant/Archmodels66_jardiniere.jpg' );\r\n        var objLoader=new OBJLoader();\r\n        objLoader.load(\"./images/plant/plant.obj\",function(object ){\r\n            object.traverse( function ( child ) {\r\n                if ( child instanceof THREE.Mesh) {\r\n                    child.material=new THREE.MeshBasicMaterial({color: 0xffffff});\r\n                    if(child.name==\"3DXY_geometry_769\"||child.name==\"3DXY_geometry_773\"){\r\n                        child.material.name=\"wire_153228214\"\r\n                        child.material.map = leaftexture;\r\n                    }else if(child.name==\"3DXY_geometry_772\"||child.name==\"3DXY_geometry_776\"||child.name==\"3DXY_geometry_777\"||child.name==\"3DXY_geometry_778\"){\r\n                        child.material.name=\"wire_108008136\"\r\n                        child.material.map = barktexture;\r\n                    }else if(child.name==\"3DXY_geometry_774\"||child.name==\"3DXY_geometry_775\"){\r\n                        child.material.name=\"wire_177148027\"\r\n                        child.material.map = soiltexture;\r\n                    }else if(child.name==\"3DXY_geometry_770\"){\r\n                        child.material.name=\"wire_198225087\"\r\n                        child.material.map = jardinieretexture;\r\n                    }\r\n                }\r\n            });\r\n            // _this.scene.add(object)\r\n            let objExporter = new OBJExporter();\r\n            var output = objExporter.parse(object);\r\n            var link = document.createElement( 'a' );\r\n            link.style.display = 'none';\r\n            document.body.appendChild( link );\r\n            link.href = URL.createObjectURL( new Blob( [ output ], { type: 'text/plain' } ) );\r\n            link.download = \"object.obj\" ;\r\n            link.click();\r\n            //然后自己制作mtl文件就可以了\r\n        }, this.onProgress, this.onError)\r\n    }\r\n    //测试GLTF文件\r\n    exportGLTF(){\r\n        let box = new THREE.BoxGeometry(40,5,40);\r\n        let material=new THREE.MeshPhongMaterial({color:0x0000ff});\r\n        let obj=new THREE.Mesh(box,material);//立方体\r\n        // 单个模型数据 GLTF导出\r\n        let gltfExporter = new GLTFExporter();\r\n        gltfExporter.parse(obj, function (result) {\r\n            console.log(result);\r\n            var output = JSON.stringify( result, null, 2 );\r\n            var link = document.createElement( 'a' );\r\n            link.style.display = 'none';\r\n            document.body.appendChild( link );\r\n            link.href = URL.createObjectURL( new Blob( [ output ], { type: 'text/plain' } ) );\r\n            link.download = \"object.gltf\" ;\r\n            link.click();\r\n        });\r\n        //加载GLTF\r\n        var _this=this;\r\n        var loader = new GLTFLoader();\r\n        loader.load( './images/test/object.gltf', function ( gltf ) {\r\n            console.log('控制台查看加载gltf文件返回的对象结构',gltf)\r\n            console.log('gltf对象场景属性',gltf.scene)\r\n            console.log('gltf对象相机属性',gltf.cameras)\r\n            _this.scene.add( gltf.scene );\r\n        })\r\n    }\r\n    //测试OBJ文件\r\n    exportOBJ(){\r\n        let box = new THREE.BoxGeometry(40,5,40);\r\n        let material=new THREE.MeshPhongMaterial({color:0x0000ff});\r\n        let obj=new THREE.Mesh(box,material);//立方体\r\n        // 单个模型数据 OBJ导出\r\n        let objExporter = new OBJExporter();\r\n        var output = objExporter.parse(obj);\r\n        var link = document.createElement( 'a' );\r\n        link.style.display = 'none';\r\n        document.body.appendChild( link );\r\n        link.href = URL.createObjectURL( new Blob( [ output ], { type: 'text/plain' } ) );\r\n        link.download = \"object.obj\" ;\r\n        link.click();\r\n        //加载OBJ\r\n        var _this=this;\r\n        var loader = new OBJLoader();\r\n        var loader2=new OBJLoader2();\r\n        loader.load( './images/test/object.obj', function ( obj ) {\r\n            console.log(obj)\r\n            _this.scene.add( obj );\r\n        })\r\n        // loader2.load( './images/test/object.obj', function ( obj ) {\r\n        //     _this.scene.add( obj );\r\n        // })\r\n    }\r\n\r\n    /* 创建字体精灵 */\r\n    makeTextSprite(message, parameters) {\r\n\r\n        if ( parameters === undefined ) parameters = {};\r\n\r\n        var fontface = parameters.hasOwnProperty(\"fontface\") ?\r\n            parameters[\"fontface\"] : \"Arial\";\r\n\r\n        /* 字体大小 */\r\n        var fontsize = parameters.hasOwnProperty(\"fontsize\") ?\r\n            parameters[\"fontsize\"] : 20;\r\n\r\n        /* 边框厚度 */\r\n        var borderThickness = parameters.hasOwnProperty(\"borderThickness\") ?\r\n            parameters[\"borderThickness\"] : 4;\r\n\r\n        /* 边框颜色 */\r\n        var borderColor = parameters.hasOwnProperty(\"borderColor\") ?\r\n            parameters[\"borderColor\"] : { r:0, g:0, b:0, a:1.0 };\r\n\r\n        /* 背景颜色 */\r\n        var backgroundColor = parameters.hasOwnProperty(\"backgroundColor\") ?\r\n            parameters[\"backgroundColor\"] : { r:255, g:255, b:255, a:1.0 };\r\n\r\n        /* 创建画布 */\r\n        var canvas = document.createElement('canvas');\r\n        var context = canvas.getContext('2d');\r\n\r\n        /* 字体加粗 */\r\n        context.font = fontsize + \"px \" + fontface;\r\n\r\n        /* 获取文字的大小数据，高度取决于文字的大小 */\r\n        var metrics = context.measureText( message );\r\n        var textWidth = metrics.width;\r\n\r\n        /* 背景颜色 */\r\n        context.fillStyle   = \"rgba(\" + backgroundColor.r + \",\" + backgroundColor.g + \",\"\r\n            + backgroundColor.b + \",\" + backgroundColor.a + \")\";\r\n\r\n        /* 边框的颜色 */\r\n        context.strokeStyle = \"rgba(\" + borderColor.r + \",\" + borderColor.g + \",\"\r\n            + borderColor.b + \",\" + borderColor.a + \")\";\r\n        context.lineWidth = borderThickness;\r\n\r\n        /* 绘制圆角矩形 */\r\n        this.roundRect(context, borderThickness/2, borderThickness/2, textWidth + borderThickness, fontsize * 1.4 + borderThickness, 6);\r\n\r\n        /* 字体颜色 */\r\n        context.fillStyle = \"rgba(0, 0, 0, 1.0)\";\r\n        context.fillText( message, borderThickness, fontsize + borderThickness);\r\n\r\n        /* 画布内容用于纹理贴图 */\r\n        var texture = new THREE.Texture(canvas);\r\n        texture.needsUpdate = true;\r\n\r\n        var spriteMaterial = new THREE.SpriteMaterial({ map: texture } );\r\n        var sprite = new THREE.Sprite( spriteMaterial );\r\n\r\n        /* 缩放比例 */\r\n        sprite.scale.set(10,5,0);\r\n\r\n        return sprite;\r\n    }\r\n\r\n    createSprite(obj) {\r\n        let sprite = this.makeTextSprite(' 温度：' + 12 + '℃ 湿度：' + 12% + ' ')\r\n        sprite.position.set(obj.x + 50,obj.y+24,obj.z-20);\r\n        sprite.scale.set(300, 100,1); // 控制精灵大小，比如可视化中精灵大小表征数据大小 只需要设置x、y两个分量就可以\r\n        sprite.data=obj.data; //告警等级默认给1，给最低告警\r\n        sprite.name=\"spriteAlarm\";\r\n        sprite.visible=true;\r\n        console.log(sprite)\r\n        this.addObject(sprite);\r\n        this.sprite.push(sprite);\r\n    }\r\n\r\n    /* 绘制圆角矩形 */\r\n    roundRect(ctx, x, y, w, h, r) {\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(x+r, y);\r\n        ctx.lineTo(x+w-r, y);\r\n        ctx.quadraticCurveTo(x+w, y, x+w, y+r);\r\n        ctx.lineTo(x+w, y+h-r);\r\n        ctx.quadraticCurveTo(x+w, y+h, x+w-r, y+h);\r\n        ctx.lineTo(x+r, y+h);\r\n        ctx.quadraticCurveTo(x, y+h, x, y+h-r);\r\n        ctx.lineTo(x, y+r);\r\n        ctx.quadraticCurveTo(x, y, x+r, y);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.stroke();\r\n\r\n    }\r\n\r\n}\r\n"]}]}